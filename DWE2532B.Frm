VERSION 5.00
Object = "{FD2FB1F1-D4FC-11CE-A335-A8D5ECAE5B02}#2.0#0"; "btn32a20.ocx"
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Object = "{648A5603-2C6E-101B-82B6-000000000014}#1.1#0"; "MSCOMM32.OCX"
Object = "{3ED2D85D-59DA-11D1-8168-006097C8673E}#1.1#0"; "NEdbox.ocx"
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.2#0"; "MSCOMCTL.OCX"
Object = "{248DD890-BB45-11CF-9ABC-0080C7E7B78D}#1.0#0"; "MSWINSCK.OCX"
Object = "{86CF1D34-0C5F-11D2-A9FC-0000F8754DA1}#2.0#0"; "mscomct2.ocx"
Begin VB.Form DWE2532B 
   BorderStyle     =   3  'Å©±â °íÁ¤ ´ëÈ­ »óÀÚ
   Caption         =   "BARCODE LABEL Ãâ·Â(PEAK)"
   ClientHeight    =   7350
   ClientLeft      =   11055
   ClientTop       =   4215
   ClientWidth     =   9240
   BeginProperty Font 
      Name            =   "±¼¸²"
      Size            =   9.75
      Charset         =   129
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H00C0C0C0&
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   7350
   ScaleWidth      =   9240
   ShowInTaskbar   =   0   'False
   Begin VB.TextBox D_PROD_KB 
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Left            =   9855
      TabIndex        =   63
      Top             =   3600
      Visible         =   0   'False
      Width           =   990
   End
   Begin Threed.SSPanel Title 
      Height          =   555
      Left            =   555
      TabIndex        =   24
      Top             =   15
      Width           =   8040
      _Version        =   65536
      _ExtentX        =   14182
      _ExtentY        =   979
      _StockProps     =   15
      Caption         =   "BARCODE LABEL Ãâ·Â (PEAK)"
      ForeColor       =   12648447
      BackColor       =   8388608
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   15
         Charset         =   129
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSPanel Key_Panel 
      Height          =   5715
      Left            =   0
      TabIndex        =   25
      Top             =   600
      Width           =   9165
      _Version        =   65536
      _ExtentX        =   16166
      _ExtentY        =   10081
      _StockProps     =   15
      ForeColor       =   8421504
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "±¼¸²"
         Size            =   9.75
         Charset         =   129
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      BorderWidth     =   1
      BevelOuter      =   1
      Begin VB.TextBox D_NATION_CD 
         Appearance      =   0  'Æò¸é
         BackColor       =   &H00C0FFFF&
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   330
         Left            =   1680
         Locked          =   -1  'True
         TabIndex        =   79
         Text            =   "D_NATION_CD"
         Top             =   5400
         Visible         =   0   'False
         Width           =   1635
      End
      Begin VB.TextBox D_COO_LAB 
         Appearance      =   0  'Æò¸é
         BackColor       =   &H00E0E0E0&
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   360
         Left            =   1365
         Locked          =   -1  'True
         TabIndex        =   78
         Text            =   "D_COO_LAB"
         Top             =   4400
         Width           =   3255
      End
      Begin VB.TextBox D_SWWCUST_CD 
         Appearance      =   0  'Æò¸é
         BackColor       =   &H00C0FFFF&
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   330
         Left            =   0
         Locked          =   -1  'True
         TabIndex        =   72
         Text            =   "D_SWWCUST_CD"
         Top             =   5400
         Visible         =   0   'False
         Width           =   1635
      End
      Begin VB.TextBox D_SCUSTOM_CD 
         Appearance      =   0  'Æò¸é
         BackColor       =   &H00C0FFFF&
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   330
         Left            =   0
         Locked          =   -1  'True
         TabIndex        =   71
         Text            =   "D_SCUSTOM_CD"
         Top             =   5040
         Visible         =   0   'False
         Width           =   1635
      End
      Begin VB.TextBox D_ENDLABEL_KB 
         Appearance      =   0  'Æò¸é
         BackColor       =   &H00C0FFFF&
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   330
         Left            =   0
         Locked          =   -1  'True
         TabIndex        =   70
         Text            =   "D_ENDLABEL_KB"
         Top             =   4680
         Visible         =   0   'False
         Width           =   1635
      End
      Begin VB.Timer Timer1 
         Left            =   8640
         Top             =   120
      End
      Begin VB.TextBox D_CUSTOM_NM 
         Appearance      =   0  'Æò¸é
         BackColor       =   &H00E0E0E0&
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   360
         Left            =   5640
         Locked          =   -1  'True
         TabIndex        =   68
         Top             =   50
         Width           =   3400
      End
      Begin VB.Frame FrameForm 
         Caption         =   "Ãâ·Â¾ç½Ä"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C00000&
         Height          =   660
         Left            =   4780
         TabIndex        =   58
         Top             =   3480
         Width           =   4280
         Begin VB.OptionButton PRT_FORM 
            Caption         =   "C/T Box"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   240
            Index           =   0
            Left            =   120
            TabIndex        =   60
            Top             =   260
            Value           =   -1  'True
            Width           =   1155
         End
         Begin VB.OptionButton PRT_FORM 
            Caption         =   "Inner Label"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   240
            Index           =   1
            Left            =   1320
            TabIndex        =   59
            Top             =   260
            Width           =   1335
         End
         Begin NEdBox.NumEdBox3D I_BUNDLE_QT 
            Height          =   315
            Left            =   3800
            TabIndex        =   61
            Top             =   200
            Visible         =   0   'False
            Width           =   405
            _ExtentX        =   714
            _ExtentY        =   556
            Text            =   ""
            FormatS         =   ""
            MaxLength       =   0
            BackColor       =   12648447
            ForeColor       =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
         End
         Begin VB.Label Label1 
            AutoSize        =   -1  'True
            Caption         =   "Bundle Qty :"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000040C0&
            Height          =   240
            Index           =   24
            Left            =   2670
            TabIndex        =   62
            Top             =   260
            Visible         =   0   'False
            Width           =   1095
         End
      End
      Begin Threed.SSPanel ProgPnl 
         Height          =   735
         Left            =   2880
         TabIndex        =   56
         Top             =   1080
         Visible         =   0   'False
         Width           =   3975
         _Version        =   65536
         _ExtentX        =   7011
         _ExtentY        =   1296
         _StockProps     =   15
         Caption         =   "Data Gathering"
         ForeColor       =   16711680
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BorderWidth     =   4
         BevelInner      =   1
         Alignment       =   6
         Begin MSComctlLib.ProgressBar ProgressBar1 
            Height          =   300
            Left            =   135
            TabIndex        =   57
            Top             =   315
            Width           =   3705
            _ExtentX        =   6535
            _ExtentY        =   529
            _Version        =   393216
            Appearance      =   1
         End
      End
      Begin VB.ComboBox C_LOT_ID 
         Height          =   315
         ItemData        =   "DWE2532B.frx":0000
         Left            =   6120
         List            =   "DWE2532B.frx":0002
         Style           =   2  'µå·Ó´Ù¿î ¸ñ·Ï
         TabIndex        =   54
         Top             =   1680
         Width           =   2895
      End
      Begin VB.ComboBox C_ITEM_NO 
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   300
         Left            =   1365
         TabIndex        =   11
         Top             =   2805
         Width           =   3270
      End
      Begin VB.ComboBox C_LOT_NO 
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Left            =   1380
         TabIndex        =   4
         Tag             =   "Y"
         Text            =   "C_LOT_NO"
         Top             =   1580
         Width           =   3255
      End
      Begin VB.CheckBox CT_PRINT_CHK 
         Alignment       =   1  '¿À¸¥ÂÊ ¸ÂÃã
         Caption         =   "C/T # Print"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   360
         Left            =   7560
         TabIndex        =   2
         Top             =   4080
         Value           =   1  'È®ÀÎ
         Width           =   1455
      End
      Begin VB.ComboBox C_INV_NO 
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   300
         Left            =   6120
         TabIndex        =   6
         Text            =   "C_INV_NO"
         Top             =   2040
         Width           =   2895
      End
      Begin VB.ComboBox C_PO_NO 
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   300
         Left            =   1380
         TabIndex        =   5
         Text            =   "C_PO_NO"
         Top             =   2040
         Width           =   3255
      End
      Begin VB.PictureBox Picture1 
         Height          =   495
         Left            =   1320
         Picture         =   "DWE2532B.frx":0004
         ScaleHeight     =   435
         ScaleWidth      =   3075
         TabIndex        =   39
         Top             =   4875
         Width           =   3135
      End
      Begin VB.Frame FramePRT 
         Caption         =   "Ãâ·Â±¸ºÐ"
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C00000&
         Height          =   660
         Left            =   4780
         TabIndex        =   38
         Top             =   2805
         Width           =   4215
         Begin VB.CheckBox CHK_INSMP 
            Caption         =   "SMP"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   -1  'True
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000000C0&
            Height          =   270
            Left            =   2070
            TabIndex        =   53
            Top             =   255
            Width           =   750
         End
         Begin NEdBox.NumEdBox3D I_SET_QT 
            Height          =   330
            Left            =   3615
            TabIndex        =   52
            Top             =   210
            Width           =   480
            _ExtentX        =   847
            _ExtentY        =   582
            Text            =   ""
            FormatS         =   ""
            MaxLength       =   0
            BackColor       =   -2147483643
            ForeColor       =   -2147483640
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "±¼¸²"
               Size            =   9
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
         End
         Begin VB.OptionButton PRT_OP 
            Caption         =   "±¹¿Ü"
            BeginProperty Font 
               Name            =   "±¼¸²"
               Size            =   9
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   195
            Index           =   1
            Left            =   1050
            TabIndex        =   1
            Top             =   285
            Width           =   885
         End
         Begin VB.OptionButton PRT_OP 
            Caption         =   "±¹³»"
            BeginProperty Font 
               Name            =   "±¼¸²"
               Size            =   9
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   195
            Index           =   0
            Left            =   90
            TabIndex        =   0
            Top             =   270
            Value           =   -1  'True
            Width           =   960
         End
         Begin VB.Label Label1 
            AutoSize        =   -1  'True
            Caption         =   "Set Qty:"
            BeginProperty Font 
               Name            =   "Arial Narrow"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   240
            Index           =   19
            Left            =   2955
            TabIndex        =   51
            Top             =   250
            Width           =   555
         End
      End
      Begin VB.TextBox I_COLOR_NM 
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   360
         Left            =   7980
         TabIndex        =   10
         Top             =   2430
         Width           =   990
      End
      Begin VB.ComboBox C_CUSTOM_CD 
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   300
         Left            =   1380
         Style           =   2  'µå·Ó´Ù¿î ¸ñ·Ï
         TabIndex        =   3
         Tag             =   "Y"
         Top             =   1215
         Width           =   7620
      End
      Begin NEdBox.NumEdBox3D I_TOTAL_CT_NO 
         Height          =   315
         Left            =   3960
         TabIndex        =   15
         Top             =   3615
         Width           =   735
         _ExtentX        =   1296
         _ExtentY        =   556
         Text            =   ""
         FormatS         =   "###"
         MaxLength       =   3
         BackColor       =   -2147483643
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.TextBox I_REV_NO 
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   4095
         MaxLength       =   3
         TabIndex        =   8
         Top             =   2430
         Width           =   525
      End
      Begin Threed.SSPanel D_BARCODE_TX 
         Height          =   150
         Left            =   1320
         TabIndex        =   41
         Top             =   5400
         Width           =   3105
         _Version        =   65536
         _ExtentX        =   5477
         _ExtentY        =   265
         _StockProps     =   15
         ForeColor       =   0
         BackColor       =   -2147483637
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   0
      End
      Begin VB.TextBox I_METERIAL_NM 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   360
         Left            =   6135
         TabIndex        =   9
         Top             =   2430
         Width           =   915
      End
      Begin NEdBox.NumEdBox3D I_BOXUNIT_NB 
         Height          =   315
         Left            =   3960
         TabIndex        =   13
         Top             =   3225
         Width           =   720
         _ExtentX        =   1270
         _ExtentY        =   556
         Text            =   "50"
         FormatS         =   "######"
         MaxLength       =   6
         BackColor       =   -2147483643
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.TextBox I_PART_NO 
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   1380
         MaxLength       =   20
         TabIndex        =   7
         Top             =   2400
         Width           =   1980
      End
      Begin VB.TextBox I_DESC_NM 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   675
         Left            =   1380
         MultiLine       =   -1  'True
         TabIndex        =   20
         Top             =   435
         Width           =   7590
      End
      Begin NEdBox.NumEdBox3D I_START_CT_NO 
         Height          =   315
         Left            =   1365
         TabIndex        =   14
         Top             =   3615
         Width           =   690
         _ExtentX        =   1217
         _ExtentY        =   556
         Text            =   "1"
         FormatS         =   "###"
         MaxLength       =   3
         BackColor       =   -2147483643
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin fpBtnAtlLibCtl.fpBtn CMD_SAVE 
         Height          =   495
         Left            =   7245
         TabIndex        =   19
         Top             =   5040
         Width           =   1860
         _Version        =   131072
         _ExtentX        =   3281
         _ExtentY        =   873
         Enabled         =   -1  'True
         MousePointer    =   0
         Object.TabStop         =   -1  'True
         GrayAreaColor   =   12632256
         BorderShowDefault=   -1  'True
         ButtonType      =   0
         NoPointerFocus  =   0   'False
         Value           =   0   'False
         GroupID         =   0
         GroupSelect     =   0
         DrawFocusRect   =   2
         DrawFocusRectCell=   -1
         GrayAreaPictureStyle=   0
         Static          =   0   'False
         BackStyle       =   1
         AutoSize        =   0
         AutoSizeOffsetTop=   0
         AutoSizeOffsetBottom=   0
         AutoSizeOffsetLeft=   0
         AutoSizeOffsetRight=   0
         DropShadowOffsetX=   3
         DropShadowOffsetY=   3
         DropShadowType  =   0
         DropShadowColor =   0
         Redraw          =   -1  'True
         ButtonDesigner  =   "DWE2532B.frx":4B5A
      End
      Begin Threed.SSPanel D_TOT_LABEL_CNT 
         Height          =   330
         Left            =   5880
         TabIndex        =   44
         Top             =   5205
         Width           =   945
         _Version        =   65536
         _ExtentX        =   1667
         _ExtentY        =   582
         _StockProps     =   15
         ForeColor       =   0
         BackColor       =   14737632
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial Narrow"
            Size            =   15
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
      End
      Begin NEdBox.NumEdBox3D I_END_CT_NO 
         Height          =   315
         Left            =   2490
         TabIndex        =   16
         Top             =   3615
         Width           =   705
         _ExtentX        =   1244
         _ExtentY        =   556
         Text            =   ""
         FormatS         =   "###"
         MaxLength       =   3
         BackColor       =   -2147483643
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin NEdBox.NumEdBox3D I_TOTAL_QT 
         Height          =   315
         Left            =   1365
         TabIndex        =   12
         Top             =   3210
         Width           =   705
         _ExtentX        =   1244
         _ExtentY        =   556
         Text            =   ""
         FormatS         =   "######"
         MaxLength       =   6
         BackColor       =   -2147483643
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin NEdBox.NumEdBox3D I_TOTAL_WEIGHT 
         Height          =   315
         Left            =   1365
         TabIndex        =   17
         Top             =   4005
         Width           =   705
         _ExtentX        =   1244
         _ExtentY        =   556
         Text            =   ""
         FormatS         =   "######.##"
         MaxLength       =   9
         BackColor       =   -2147483643
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin NEdBox.NumEdBox3D I_PCNT_NO 
         Height          =   315
         Left            =   3960
         TabIndex        =   18
         Top             =   4005
         Width           =   735
         _ExtentX        =   1296
         _ExtentY        =   556
         Text            =   ""
         FormatS         =   "###"
         MaxLength       =   3
         BackColor       =   -2147483643
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin MSComCtl2.DTPicker SHIP_DATE 
         Height          =   345
         Left            =   1400
         TabIndex        =   65
         Top             =   50
         Width           =   1740
         _ExtentX        =   3069
         _ExtentY        =   609
         _Version        =   393216
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Format          =   159907841
         CurrentDate     =   41600
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "COO :"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   25
         Left            =   720
         TabIndex        =   77
         Top             =   4320
         Width           =   555
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "Ship To:"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   300
         Index           =   20
         Left            =   4800
         TabIndex        =   69
         Top             =   45
         Width           =   765
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "Ship Date :"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   270
         Index           =   21
         Left            =   120
         TabIndex        =   64
         Top             =   80
         Width           =   1155
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "LOT ID:"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   22
         Left            =   4800
         TabIndex        =   55
         Top             =   1695
         Width           =   570
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "EA"
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9.75
            Charset         =   129
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   195
         Index           =   18
         Left            =   6840
         TabIndex        =   50
         Top             =   5280
         Width           =   270
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "Package Count :"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   16
         Left            =   2715
         TabIndex        =   49
         Top             =   4065
         Width           =   1170
      End
      Begin VB.Label Label1 
         Alignment       =   1  '¿À¸¥ÂÊ ¸ÂÃã
         AutoSize        =   -1  'True
         Caption         =   "Total Weight :"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   15
         Left            =   315
         TabIndex        =   48
         Top             =   4080
         Width           =   945
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "Total Q'TY:"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   10
         Left            =   435
         TabIndex        =   47
         Top             =   3270
         Width           =   795
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "Invoice NO :"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   4
         Left            =   4800
         TabIndex        =   46
         Top             =   2100
         Visible         =   0   'False
         Width           =   885
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "Color:"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   300
         Index           =   8
         Left            =   7380
         TabIndex        =   35
         Top             =   2400
         Width           =   540
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "CUSTOMER :"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   1
         Left            =   240
         TabIndex        =   29
         Top             =   1200
         Width           =   1020
      End
      Begin VB.Label Label1 
         Caption         =   "~"
         Height          =   180
         Index           =   13
         Left            =   2190
         TabIndex        =   45
         Top             =   3660
         Width           =   270
      End
      Begin VB.Label Label1 
         Caption         =   "LABEL QTY :"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   270
         Index           =   17
         Left            =   4650
         TabIndex        =   40
         Top             =   5175
         Width           =   1320
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "REV :"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   6
         Left            =   3540
         TabIndex        =   33
         Top             =   2490
         Width           =   420
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "C/T:"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   12
         Left            =   945
         TabIndex        =   43
         Top             =   3660
         Width           =   315
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "of"
         Height          =   195
         Index           =   14
         Left            =   3480
         TabIndex        =   42
         Top             =   3660
         Width           =   210
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "Material:"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   300
         Index           =   7
         Left            =   5205
         TabIndex        =   34
         Top             =   2400
         Width           =   750
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "Box Unit Q'ty:"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   11
         Left            =   2880
         TabIndex        =   37
         Top             =   3285
         Width           =   960
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "LOT# :"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Index           =   2
         Left            =   330
         TabIndex        =   30
         Top             =   1635
         Width           =   945
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "PO# :"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   3
         Left            =   870
         TabIndex        =   31
         Top             =   2085
         Width           =   420
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "PART# :"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   5
         Left            =   645
         TabIndex        =   32
         Top             =   2490
         Width           =   630
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "ITEM# :"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   9
         Left            =   660
         TabIndex        =   36
         Top             =   2880
         Width           =   585
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "ITEM :"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Index           =   0
         Left            =   330
         TabIndex        =   28
         Top             =   495
         Width           =   900
      End
   End
   Begin fpBtnAtlLibCtl.fpBtn CMD_EXIT 
      Height          =   555
      Left            =   8625
      TabIndex        =   22
      Top             =   0
      Width           =   555
      _Version        =   131072
      _ExtentX        =   979
      _ExtentY        =   979
      Enabled         =   -1  'True
      MousePointer    =   0
      Object.TabStop         =   -1  'True
      GrayAreaColor   =   12632256
      BorderShowDefault=   -1  'True
      ButtonType      =   0
      NoPointerFocus  =   0   'False
      Value           =   0   'False
      GroupID         =   0
      GroupSelect     =   0
      DrawFocusRect   =   2
      DrawFocusRectCell=   -1
      GrayAreaPictureStyle=   0
      Static          =   0   'False
      BackStyle       =   1
      AutoSize        =   0
      AutoSizeOffsetTop=   0
      AutoSizeOffsetBottom=   0
      AutoSizeOffsetLeft=   0
      AutoSizeOffsetRight=   0
      DropShadowOffsetX=   3
      DropShadowOffsetY=   3
      DropShadowType  =   0
      DropShadowColor =   0
      Redraw          =   -1  'True
      ButtonDesigner  =   "DWE2532B.frx":4D40
   End
   Begin fpBtnAtlLibCtl.fpBtn CMD_HELP 
      Height          =   555
      Left            =   0
      TabIndex        =   23
      Top             =   0
      Width           =   555
      _Version        =   131072
      _ExtentX        =   979
      _ExtentY        =   979
      Enabled         =   -1  'True
      MousePointer    =   0
      Object.TabStop         =   -1  'True
      GrayAreaColor   =   12632256
      BorderShowDefault=   -1  'True
      ButtonType      =   0
      NoPointerFocus  =   0   'False
      Value           =   0   'False
      GroupID         =   0
      GroupSelect     =   0
      DrawFocusRect   =   2
      DrawFocusRectCell=   -1
      GrayAreaPictureStyle=   0
      Static          =   0   'False
      BackStyle       =   1
      AutoSize        =   0
      AutoSizeOffsetTop=   0
      AutoSizeOffsetBottom=   0
      AutoSizeOffsetLeft=   0
      AutoSizeOffsetRight=   0
      DropShadowOffsetX=   3
      DropShadowOffsetY=   3
      DropShadowType  =   0
      DropShadowColor =   0
      Redraw          =   -1  'True
      ButtonDesigner  =   "DWE2532B.frx":70F5
   End
   Begin Threed.SSPanel Msg 
      Height          =   345
      Left            =   0
      TabIndex        =   26
      Top             =   6960
      Width           =   9180
      _Version        =   65536
      _ExtentX        =   16192
      _ExtentY        =   609
      _StockProps     =   15
      ForeColor       =   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "±¼¸²"
         Size            =   9.75
         Charset         =   129
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      BevelOuter      =   1
      FloodColor      =   255
      FloodShowPct    =   0   'False
      Alignment       =   1
   End
   Begin Threed.SSPanel SSPanel1 
      Height          =   585
      Left            =   -15
      TabIndex        =   27
      Top             =   6360
      Width           =   9180
      _Version        =   65536
      _ExtentX        =   16192
      _ExtentY        =   1032
      _StockProps     =   15
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "±¼¸²"
         Size            =   9.75
         Charset         =   129
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CheckBox ChkLANPRT 
         Caption         =   "LAN (ITC)"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   400
         Left            =   5760
         TabIndex        =   73
         Top             =   120
         Width           =   720
      End
      Begin VB.Frame Frm_Port 
         Caption         =   "Printer Type"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C00000&
         Height          =   550
         Left            =   2160
         TabIndex        =   66
         Top             =   0
         Width           =   3600
         Begin VB.OptionButton PRT_SET 
            Caption         =   "MAIN(COM1)"
            BeginProperty Font 
               Name            =   "Arial Narrow"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   240
            Index           =   1
            Left            =   120
            TabIndex        =   76
            Top             =   240
            Value           =   -1  'True
            Width           =   1300
         End
         Begin VB.OptionButton PRT_SET 
            Caption         =   "SUB(COM3)"
            BeginProperty Font 
               Name            =   "Arial Narrow"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00C00000&
            Height          =   240
            Index           =   2
            Left            =   1455
            TabIndex        =   75
            Top             =   240
            Width           =   1250
         End
         Begin VB.OptionButton PRT_SET 
            Caption         =   "LPT"
            BeginProperty Font 
               Name            =   "¸¼Àº °íµñ"
               Size            =   11.25
               Charset         =   129
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   300
            Index           =   0
            Left            =   2745
            TabIndex        =   67
            Top             =   210
            Width           =   795
         End
      End
      Begin fpBtnAtlLibCtl.fpBtn CMD_CLEAR 
         Height          =   495
         Left            =   840
         TabIndex        =   21
         Top             =   45
         Width           =   1245
         _Version        =   131072
         _ExtentX        =   2196
         _ExtentY        =   873
         Enabled         =   -1  'True
         MousePointer    =   0
         Object.TabStop         =   -1  'True
         GrayAreaColor   =   12632256
         BorderShowDefault=   -1  'True
         ButtonType      =   0
         NoPointerFocus  =   0   'False
         Value           =   0   'False
         GroupID         =   0
         GroupSelect     =   0
         DrawFocusRect   =   2
         DrawFocusRectCell=   -1
         GrayAreaPictureStyle=   0
         Static          =   0   'False
         BackStyle       =   1
         AutoSize        =   0
         AutoSizeOffsetTop=   0
         AutoSizeOffsetBottom=   0
         AutoSizeOffsetLeft=   0
         AutoSizeOffsetRight=   0
         DropShadowOffsetX=   3
         DropShadowOffsetY=   3
         DropShadowType  =   0
         DropShadowColor =   0
         Redraw          =   -1  'True
         ButtonDesigner  =   "DWE2532B.frx":83B9
      End
      Begin MSCommLib.MSComm MSComm1 
         Left            =   -15
         Top             =   0
         _ExtentX        =   1005
         _ExtentY        =   1005
         _Version        =   393216
         CommPort        =   2
         DTREnable       =   -1  'True
      End
      Begin MSWinsockLib.Winsock Lantype_Sck 
         Left            =   600
         Top             =   120
         _ExtentX        =   741
         _ExtentY        =   741
         _Version        =   393216
      End
      Begin fpBtnAtlLibCtl.fpBtn CMD_PRINT 
         Height          =   495
         Left            =   6500
         TabIndex        =   74
         Top             =   30
         Width           =   2610
         _Version        =   131072
         _ExtentX        =   4604
         _ExtentY        =   873
         Enabled         =   -1  'True
         MousePointer    =   0
         Object.TabStop         =   -1  'True
         GrayAreaColor   =   12632256
         BorderShowDefault=   -1  'True
         ButtonType      =   0
         NoPointerFocus  =   0   'False
         Value           =   0   'False
         GroupID         =   0
         GroupSelect     =   0
         DrawFocusRect   =   2
         DrawFocusRectCell=   -1
         GrayAreaPictureStyle=   0
         Static          =   0   'False
         BackStyle       =   1
         AutoSize        =   0
         AutoSizeOffsetTop=   0
         AutoSizeOffsetBottom=   0
         AutoSizeOffsetLeft=   0
         AutoSizeOffsetRight=   0
         DropShadowOffsetX=   3
         DropShadowOffsetY=   3
         DropShadowType  =   0
         DropShadowColor =   0
         Redraw          =   -1  'True
         ButtonDesigner  =   "DWE2532B.frx":9687
      End
   End
End
Attribute VB_Name = "DWE2532B"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'===========================================================
' Module Name : Print Barcode Lable
' Module ID   : DWE2532B
' Creater     :
' Create Date :
' Contents    : Print Barcode Lable
'               BAR Code Type : Bar code A(Code3of9)
'               This bar code consists of upper-case alphanumeric characters.
'               Columns are variable in length
'               Start/stop codes "*" are given automatically by printer.
'               BAR Code Printer Model : T-4 manufactured ITOCHU ELECTRONICS CORP.
'------------------------------------------------------------
' Modify Date :
' Modifier    :
' Contents    :
'============================================================

'====================================================================================================================================
' ¾÷Ã¼º°·Î Barcode¿¡ DisplayµÇ´Â ³»¿ëÀ» ´Ù¸£°Ô ¿äÃ»ÇÏ¹Ç·Î
' Barcode¿¡ »Ñ·ÁÁö´Â ³»¿ëÀ» ¼öÁ¤
'
'====================================================================================================================================
Option Explicit

Dim Label_Cnt           As Long
Dim Label_Data()        As String

Dim Field_Check_SW      As Integer
Dim Column_Cancel       As Integer
Dim Field_Name()        As String
Dim Field_Check()       As Integer
Dim Field_Object()      As Control

Dim New_index           As Integer
Dim New_Focus           As Control

Dim sFormatTx           As String
Dim SSDATA              As New ADODB.Recordset
Dim SSCODE              As New ADODB.Recordset

Dim varWWCustomCD       As String
Dim varBranchCD             As String
Dim varEndwwc_CD          As String
Dim isAgentPeak           As Boolean
Dim strLotNo            As String
Dim Result_QT           As Long
Dim Box_QT              As Long
Dim varMoldNo           As String

Private Sub Form_Control_Search()
    Dim i As Integer
    Dim j As Integer

    ReDim Field_Name(Me.Count)
    ReDim Field_Check(Me.Count)
    ReDim Field_Object(Me.Count)

    For i = 0 To Me.Count - 1
        If UCase(Mid(Me.Controls(i).Name, 1, 2)) = "I_" Or _
           UCase(Mid(Me.Controls(i).Name, 1, 2)) = "D_" Or _
           UCase(Me.Controls(i).Name) = "CMD_SAVE" Then
                j = Me.Controls(i).TabIndex
                Field_Name(j) = Me.Controls(i).Name
                Set Field_Object(j) = Me.Controls(i)
        End If
    Next

End Sub

Private Sub FIELD_VERIFY(Optional GOT_FOCUS As Control)
    Dim I_idx           As Integer
    
    Dim sql             As String
    Dim strMsg          As String
    
    Set New_Focus = Screen.ActiveForm.ActiveControl

    New_index = New_Focus.TabIndex
    Field_Check(New_index) = False
    
    I_idx = 0
    If New_Focus.TabIndex = I_idx Then Exit Sub
    
    Field_Check_SW = True
    Do Until I_idx > New_Focus.TabIndex Or Field_Check_SW = False
        If Field_Name(I_idx) > "" And Field_Check(I_idx) = False Then
            Select Case UCase(Field_Name(I_idx))
                Case "I_PART_NO"
                    GoSub I_PART_NO_RTN
                Case "I_REV_NO"
                    GoSub I_REV_NO_RTN
                Case "I_DESC_NM"
                    GoSub I_DESC_NM_RTN
                Case "C_ITEM_NO"
                    GoSub C_ITEM_NO_RTN
                Case "I_METERIAL_NM"
                    GoSub I_METERIAL_NM_RTN
                Case "C_PO_NO"
                    GoSub C_PO_NO_RTN
                Case "C_LOT_NO"
                    GoSub C_LOT_NO_RTN
                Case "I_BOXUNIT_NB"
                    GoSub I_BOXUNIT_NB_RTN
                Case "I_END_CT_NO"
                    GoSub I_END_CT_NO_RTN
                Case "I_TOTAL_CT_NO"
                    GoSub I_TOTAL_CT_NO_RTN
            End Select
            
            If Field_Check_SW = False Then
                Beep
                Field_Check(I_idx) = False
                Set New_Focus = Field_Object(I_idx)
                'New_Focus.SetFocus
                Exit Sub
            Else
                Field_Check(I_idx) = True
            End If
        End If
        I_idx = I_idx + 1
    Loop
    Exit Sub

I_PART_NO_RTN:
    Msg = ""
    
    sql$ = "select * from PRD_MAST_1_VIEW "
    sql$ = sql$ + " where iPART_NO = '" + I_PART_NO + "' "
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User

    If SSDATA.RecordCount = 0 Then
        SSDATA.Close
        Msg = GLO_MSGLINE(6)
        Field_Check_SW = False
        Return
    End If

    SSDATA.Close

    Return
                
I_REV_NO_RTN:
    PnlMsg = ""
    
    'Check input Lot Production Info & Part#, Rev
    sql$ = " select distinct a.prod_cd, a.pmatr_kb, a.iPART_NO, a.prev_no, a.prod_gubun, a.pdesc_nm, a.lowheigh_kb, " & vbCrLf
    sql$ = sql$ & " nvl((select f.mcode_nm from SYS_CODPD_06 f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and  f.mcode_cd = a.bake_kb and mcode_class = a.prod_gubun), ' ') bake, " & vbCrLf
        
    If C_PO_NO = "" Then
        ' °¢ Á¦Ç°º° ±âº» Box Packing ¼ö·®À» SYS_CODPD_22 ¿¡¼­ ÀÐ¾î ¿Â´Ù
        ' TR : Tray lowheigh_kb ÀÌ¿ë
        ' TE : EndCap psize_nm ÀÌ¿ë
        ' ³ª¸ÓÁö Á¦Ç°Àº prod_gubun ÀÌ¿ë
        sql$ = sql$ & " decode(a.prod_gubun, 'TR', (select distinct ref02 from SYS_CODPD_22  f, PRD_MAST_2 g where g.comp_cd = f.comp_cd and g.bsns_cd = f.bsns_cd and g.ipart_no = a.ipart_no and   f.mcode_cc = g.lowheigh_kb), " & vbCrLf
        sql$ = sql$ & "                      'TE', (select distinct ref02 from SYS_CODPD_22  f, PRD_MAST_2 g where g.comp_cd = f.comp_cd and g.bsns_cd = f.bsns_cd and g.ipart_no = a.ipart_no and   f.mcode_nm = trim(g.psize_nm)), " & vbCrLf
        sql$ = sql$ & "                           (select distinct ref02 from SYS_CODPD_22  f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and mcode_cc = a.prod_gubun)) box_unit_qt, " & vbCrLf
    Else
        'PO°¡ ÀÖÀ» °æ¿ì MKT_CUST_2ÀÇ Box Pack ¼ö·®À» ÀÐ¾î¿Â´Ù.
        If CHK_INSMP.Value = 1 Then
            sql$ = sql$ & " nvl((select distinct max(f.box_pack_qt) from MKT_CUST_2 f, MKT_ORD_1 g " & vbCrLf
            sql$ = sql$ & "      where f.custom_cd = '" & Right(C_CUSTOM_CD, 5) & "' "
            sql$ = sql$ & "      and   f.prod_cd = a.prod_cd  " & vbCrLf
            sql$ = sql$ & "      and   g.comp_cd = f.comp_cd and g.bsns_cd = f.bsns_cd and f.custom_cd = g.insmp_custom_cd  " & vbCrLf
            sql$ = sql$ & "      and   g.insmp_po_no = '" & C_PO_NO & "' " & vbCrLf
            sql$ = sql$ & "      and   rownum = 1),1) box_unit_qt," & vbCrLf
            
            sql$ = sql$ & " nvl((select distinct f.cdesc_tx4 from MKT_CUST_2 f, MKT_ORD_1 g " & vbCrLf
            sql$ = sql$ & "      where f.custom_cd = '" & Right(C_CUSTOM_CD, 5) & "' "
            sql$ = sql$ & "      and   f.prod_cd = a.prod_cd  " & vbCrLf
            sql$ = sql$ & "      and   g.comp_cd = f.comp_cd and g.bsns_cd = f.bsns_cd and f.custom_cd = g.insmp_custom_cd  " & vbCrLf
            sql$ = sql$ & "      and   g.insmp_po_no = '" & C_PO_NO & "' " & vbCrLf
            sql$ = sql$ & "      and   rownum = 1),' ') cdesc_tx4," & vbCrLf
        Else
            sql$ = sql$ & " nvl((select distinct max(f.box_pack_qt) from MKT_CUST_2 f, MKT_ORD_1 g " & vbCrLf
            sql$ = sql$ & "      where f.custom_cd = '" & Right(C_CUSTOM_CD, 5) & "' "
            sql$ = sql$ & "      and   f.prod_cd = a.prod_cd  " & vbCrLf
            sql$ = sql$ & "      and   g.comp_cd = f.comp_cd and g.bsns_cd = f.bsns_cd and f.custom_cd = g.custom_cd  " & vbCrLf
            sql$ = sql$ & "      and   g.po_no = '" & C_PO_NO & "' " & vbCrLf
            sql$ = sql$ & "      and   rownum = 1),1) box_unit_qt," & vbCrLf
            
            sql$ = sql$ & " nvl((select distinct f.cdesc_tx4 from MKT_CUST_2 f, MKT_ORD_1 g " & vbCrLf
            sql$ = sql$ & "      where f.custom_cd = '" & Right(C_CUSTOM_CD, 5) & "' "
            sql$ = sql$ & "      and   f.prod_cd = a.prod_cd  " & vbCrLf
            sql$ = sql$ & "      and   g.comp_cd = f.comp_cd and g.bsns_cd = f.bsns_cd and f.custom_cd = g.custom_cd  " & vbCrLf
            sql$ = sql$ & "      and   g.po_no = '" & C_PO_NO & "' " & vbCrLf
            sql$ = sql$ & "      and   rownum = 1),' ') cdesc_tx4," & vbCrLf
        End If
    End If
    
    'Check SID # from MKT_ORD_11
    sql$ = sql$ + " nvl((select distinct sid_no from MKT_ORD_11  " & vbCrLf
    sql$ = sql$ + " where order_no in (select order_no from MKT_ORD_1 " & vbCrLf
    sql$ = sql$ + "                    where custom_cd = '" & Trim(Right(C_CUSTOM_CD, 5)) & "' " & vbCrLf
    sql$ = sql$ + "                    and   deli_kb <> '2'" & vbCrLf
    sql$ = sql$ + "                    and   comp_cd = '" & GLO_COMP_CD & "' and bsns_cd = '" & GLO_BSNS_CD & "' and po_no = '" & C_PO_NO & "' )" & vbCrLf
    sql$ = sql$ + " and  comp_cd = a.comp_cd and bsns_cd = a.bsns_cd and prod_cd = a.prod_cd and rownum = 1),'0') item_no," & vbCrLf
    sql$ = sql$ & " nvl((select distinct f.smp_mater_nm from PRD_SMP_1 f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and f.prod_cd = a.prod_cd and f.mold_no = a.mold_no and f.rev_no = a.prev_no ),' ') smp_mater_nm, " & vbCrLf
    sql$ = sql$ & " nvl((select b.mcode_yn from SYS_CODPD_16 b where b.comp_cd = a.comp_cd and b.bsns_cd = a.bsns_cd and b.mcode_cd = trim(a.pmatr_kb) and b.mcode_class = a.prod_gubun), ' ') mater_nm, " & vbCrLf
    sql$ = sql$ & " nvl((select b.ref01 from SYS_CODPD_16 b where b.comp_cd = a.comp_cd and b.bsns_cd = a.bsns_cd and b.mcode_cd = trim(a.pmatr_kb) and b.mcode_class = a.prod_gubun), ' ') color_nm, " & vbCrLf
    
    'Tray - Check Mold No on Lot#
    sql$ = sql$ & " decode(a.prod_gubun, 'TR', (select count(*) from PRD_WORK_1 f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and f.prod_cd = a.prod_cd and f.lot_no like '" & cDll.Gf_UnFormat("M", C_LOT_NO) & "%'), " & vbCrLf
    sql$ = sql$ & "                           1) lot_count " & vbCrLf
    
    sql$ = sql$ & " from PRD_MAST_1_VIEW a " & vbCrLf
    sql$ = sql$ & " where a.iPART_NO = '" + I_PART_NO + "' " & vbCrLf
    sql$ = sql$ & " and   a.prev_no = '" + I_REV_NO + "' " & vbCrLf
    sql$ = sql$ & " and a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User

    If SSDATA.RecordCount = 0 Then
        SSDATA.Close
        PnlMsg = GLO_MSGLINE(6)
        Field_Check_SW = False
        Return
    End If
    
    If Trim(SSDATA!lot_count) = 0 Then
        strMsg = IIf(GLO_KOR_VISIBLE, "ÀÔ·ÂÇÑ Lot#´Â ERP»ó¿¡ »ý»êµÈ ±Ù°Å°¡ ¾ø½À´Ï´Ù.", "There are no Production Information for the Lot No")    ' Define message.
        strMsg = strMsg & vbCrLf & IIf(GLO_KOR_VISIBLE, "°è¼Ó ÁøÇàÇÏ½Ã°Ú½À´Ï±î?", "Do you want to keep going?")
        If MsgBox(strMsg, vbYesNo, "Data Check") = vbNo Then
            Field_Check_SW = False
            Return
        End If
    End If
    D_PROD_KB = Trim(SSDATA!prod_gubun)
    If I_DESC_NM = "" Then I_DESC_NM = Trim(SSDATA!cdesc_tx4)
    If I_DESC_NM = "" Then I_DESC_NM = Trim(SSDATA!pdesc_nm) + vbCrLf + Trim(SSDATA!bake)  ' Manually input
    I_BOXUNIT_NB = Trim(SSDATA!box_unit_qt)
    If SSDATA!prod_gubun = "TR" Then Call SET_TRAY_BOXUNIT(Trim(SSDATA!ipart_no), Trim(SSDATA!Prev_No))  ' TrayÀÎ °æ¿ì NTK¿¡ ´ëÇÑ Box Unit
    
    If Trim(SSDATA!mater_nm) = "" Then
        MsgBox IIf(GLO_KOR_VISIBLE, "¾÷¹«Ç¥ÁØÈ­ÄÚµå¿¡¼­ ¿ø·á¿¡ °üÇÑ Á¤º¸°¡ ¾ø½À´Ï´Ù." & vbCrLf & "¾÷¹«Ç¥ÁØÈ­ Á¤º¸¸¦ È®ÀÎÇÏ½Ê½Ã¿ä", _
                                    "There are no data on Code Table." & vbCrLf & "Check Code Table")
    Else
        I_METERIAL_NM = IIf(isAgentPeak = True And Trim(SSDATA!smp_mater_nm) <> "", Trim(SSDATA!smp_mater_nm), Trim(SSDATA!mater_nm))
        I_COLOR_NM = Trim(SSDATA!color_nm)
    End If

    Call ComboLoad_ITEM_NO(SSDATA!prod_cd, Right(C_CUSTOM_CD, 5))
    Call GS_ComboSelect(C_ITEM_NO, SSDATA!item_no)
    If C_ITEM_NO.ListIndex = -1 Then C_ITEM_NO.ListIndex = 0
    SSDATA.Close
    
    Return

I_DESC_NM_RTN:
    PnlMsg = ""

    If I_DESC_NM = "" Then
        PnlMsg = GLO_MSGLINE(21)
        Field_Check_SW = False
        Return
    End If

    If cDll.Gf_InstrCount(I_DESC_NM, vbCrLf) > 1 Then
        PnlMsg = IIf(GLO_KOR_VISIBLE, "µÎÁÙ ±îÁö¸¸ Çã¿ë µË´Ï´Ù.", "Only 2 lines are allowed")
        Field_Check_SW = False
        Return
    End If
    Return

C_ITEM_NO_RTN:
    If C_ITEM_NO.ListCount = 0 Then
        MsgBox ("Customer Á¤º¸¿¡ Item # Á¤º¸°¡ ¾ø½À´Ï´Ù. °Å·¡Ã³Á¤º¸¸¦ È®ÀÎÇÏ½Ê½Ã¿À")
    ElseIf C_ITEM_NO.ListCount > 1 Then
        If C_ITEM_NO.ListIndex = -1 Then MsgBox (C_ITEM_NO.ListCount & "°³ÀÇ Item #¸¦ °¡Áö°í ÀÖ½À´Ï´Ù." & vbCrLf & "Item#¸¦ ¼±ÅÃÇÏ¼¼¿ä")               ' Item No°¡ ÇÏ³ª ÀÌ»óÀÎ °æ¿ì
    End If
    
    Return
                
I_METERIAL_NM_RTN:
    PnlMsg = ""
    
    If I_METERIAL_NM = "" Then
        PnlMsg = GLO_MSGLINE(21)
        Field_Check_SW = False
        Return
    End If
    
    
    Return
                
C_PO_NO_RTN:
    PnlMsg = ""

    If C_PO_NO = "" Then
        PnlMsg = GLO_MSGLINE(21)
        Field_Check_SW = False
        Return
    End If

    Return
                
C_LOT_NO_RTN:
    PnlMsg = ""

    If C_LOT_NO = "" Then
        PnlMsg = GLO_MSGLINE(21)
        Field_Check_SW = False
        Return
    End If

    Return
                
I_BOXUNIT_NB_RTN:
    PnlMsg = ""

    If Val(I_BOXUNIT_NB) = 0 Then
        PnlMsg = IIf(GLO_KOR_VISIBLE, "'0'Àº ¾ÈµË´Ï´Ù.", "'0' is not allowed.")
        Field_Check_SW = False
        Return
    End If

    Return
                
I_END_CT_NO_RTN:
    PnlMsg = ""

    If Val(I_START_CT_NO) = 0 Or _
       Val(I_START_CT_NO) > Val(I_END_CT_NO) Or _
       Val(I_END_CT_NO) > Val(I_TOTAL_CT_NO) Then
        PnlMsg = IIf(GLO_KOR_VISIBLE, "¹øÈ£ ¿À·ùÀÔ´Ï´Ù.", "Number Fail")
        Field_Check_SW = False
        Return
    End If

I_TOTAL_CT_NO_RTN:
    PnlMsg = ""

    If Val(I_TOTAL_CT_NO) = 0 Then
        PnlMsg = IIf(GLO_KOR_VISIBLE, "'0'Àº ¾ÈµË´Ï´Ù.", "'0' is not allowed.")
        Field_Check_SW = False
        Return
    End If

    If Val(I_TOTAL_CT_NO) < Val(I_END_CT_NO) Or Val(I_TOTAL_CT_NO) < Val(I_START_CT_NO) Then
        PnlMsg = IIf(GLO_KOR_VISIBLE, "¹øÈ£ ¿À·ùÀÔ´Ï´Ù.", "Number Fail")
        Field_Check_SW = False
        Return
    End If

    Return

End Sub
Private Sub C_CUSTOM_CD_Click()
    Call C_CUSTOM_CD_LostFocus
End Sub

Private Sub C_CUSTOM_CD_GotFocus()
    FIELD_VERIFY
End Sub

Private Sub C_CUSTOM_CD_LostFocus()
    Dim strTemp     As String
    Dim sql         As String
       
    ' Display Shipping Date for the C_LOT_NO for Delivery Order for the Lot No
    sql$ = "select distinct a.outlot_no, nvl(a.custom_line_cd,' ') as custom_line_cd, a.outorder_no "
    sql$ = sql$ & " from MKT_OUT_11 a " & vbCrLf
    sql$ = sql$ & " where a.outorder_no in " & vbCrLf
    sql$ = sql$ & "                         (select b.outorder_no from MKT_OUT_1 b, MKT_ORD_1 c " & vbCrLf 'Oem Pro
    sql$ = sql$ & "                          where  c.comp_cd = '" & GLO_COMP_CD & "' and c.bsns_cd = '" & GLO_BSNS_CD & "' "
    If CHK_INSMP.Value = 1 Then
        sql$ = sql$ & "                      and    c.insmp_kb = '1'" & vbCrLf
        sql$ = sql$ & "                      and    c.insmp_custom_cd = '" & Trim(Right(C_CUSTOM_CD, 10)) & "' " & vbCrLf
    Else
        sql$ = sql$ & "                      and    c.insmp_kb = '0'" & vbCrLf
        sql$ = sql$ & "                      and    c.custom_cd = '" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    End If
    sql$ = sql$ & "                          and    b.order_no = c.order_no " & vbCrLf
    sql$ = sql$ & "                          and    b.output_dt = '" & Format(SHIP_DATE, "yyyymmdd") & "') " & vbCrLf
    sql$ = sql$ & " and   a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and   a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    sql$ = sql$ & " order by a.outlot_no "
    
    Set SSCODE = Nothing
    SSCODE.Open sql$, DB_User
    
    C_LOT_NO.Clear
    C_LOT_ID.Clear
    If SSCODE.RecordCount > 0 Then
        Do Until SSCODE.EOF
            strTemp = Gf_LotNo_Format("TR", SSCODE!outlot_no)
            C_LOT_NO.AddItem strTemp
            If Trim(Right(C_CUSTOM_CD, 10)) = "20289" Or Trim(Right(C_CUSTOM_CD, 10)) = "21311" Then 'SPIL
                C_LOT_ID.AddItem SSCODE!outorder_no
            Else 'SCK µî
                C_LOT_ID.AddItem SSCODE!custom_line_cd
            End If
            SSCODE.MoveNext
        Loop
        C_LOT_NO.ListIndex = 0
        C_LOT_ID.ListIndex = 0
    End If
    SSCODE.Close

    ' Check WWCustomerCD, and arrange data
    sql$ = "select wwcustom_cd from MKT_CUST_1 "
    sql$ = sql$ & " where custom_cd = '" & Trim(Right(C_CUSTOM_CD, 10)) & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    
    Set SSCODE = Nothing
    SSCODE.Open sql$, DB_User
    
    If SSCODE.RecordCount = 0 Then
        varWWCustomCD = ""
    Else
        varWWCustomCD = Trim(SSCODE!wwcustom_cd)
    End If
    SSCODE.Close
    
    Label1(4).Visible = False
    C_INV_NO.Visible = False
        
    Label1(15).Visible = False
    Label1(16).Visible = False
    I_TOTAL_WEIGHT.Visible = False
    I_PCNT_NO.Visible = False
    
    If Trim(Right(C_CUSTOM_CD, 10)) = "20015" Or Trim(Right(C_CUSTOM_CD, 10)) = "20163" Then '20006: ASEK ÀÏ °æ¿ì RT No¸¦ °¡Á®¿Â´Ù. 2013-12-23 by S+G kimsi
        Label1(22).Visible = True
        Label1(22).Caption = "RT#:"
        C_LOT_ID.Visible = True
    ElseIf GLO_COMP_CD = "FU" And (Trim(Right(C_CUSTOM_CD, 10)) = "21347" Or Trim(Right(C_CUSTOM_CD, 10)) = "20888" Or Trim(Right(C_CUSTOM_CD, 10)) = "22134") Then
        Label1(22).Visible = True
        Label1(22).Caption = "RT#:"
        C_LOT_ID.Visible = True
    ElseIf Trim(Right(C_CUSTOM_CD, 10)) = "10426" Or Trim(Right(C_CUSTOM_CD, 5)) = "10005" Then 'SCK LOT ID Ç¥½Ã
        Label1(22).Visible = True
        Label1(22).Caption = "LOT ID:"
        C_LOT_ID.Visible = True
    ElseIf Trim(Right(C_CUSTOM_CD, 10)) = "21022" Then 'TOMOE °í°´ÀÇ °æ¿ì KYOCERA KST PO# Ç×¸ñ Ç¥½Ã
        Label1(22).Visible = True
        Label1(22).Caption = "KST PO#:"
        C_LOT_ID.Visible = True
    Else
        Label1(22).Visible = False
        C_LOT_ID.Visible = False
    End If
    '===================================
    ' Invoice NO Field º¸ÀÌ±â
    '===================================
    If ((Trim(Right(C_CUSTOM_CD, 10)) = "20180" Or Trim(Right(C_CUSTOM_CD, 10)) = "21844" Or Trim(Right(C_CUSTOM_CD, 10)) = "10507" Or Trim(Right(C_CUSTOM_CD, 10)) = "21832") And GLO_COMP_CD = "FU") Or Trim(Right(C_CUSTOM_CD, 10)) = "20910" Then     'TSMC by FRC Liam 2019.01.11 '20211124 MICRON(S) by hilee
        Label1(4).Visible = True
        C_INV_NO.Visible = True
    End If
    '-------------------------------------------------------------------
    
    Select Case True
        Case PRT_OP(0)
            I_SET_QT.Enabled = True
            I_SET_QT = 1
        Case PRT_OP(1)
            I_SET_QT.Enabled = True
            I_SET_QT = 1
    End Select

End Sub

Private Sub C_INV_NO_LostFocus()

    Dim sql         As String
    
    sql$ = "select a.shipto_cd, a.outorder_no, a.order_no, "
    sql$ = sql$ & "  nvl((select distinct(c.wwcustom_cd) from MKT_ORD_1 b, MKT_CUST_2 c "
    sql$ = sql$ & "        where b.order_no  = a.order_no"
    sql$ = sql$ & "        and   b.comp_cd = a.comp_cd and b.bsns_cd = a.bsns_cd "
    If CHK_INSMP.Value = 1 Then
        sql$ = sql$ & "        and  b.insmp_custom_cd = c.custom_cd), ' ') wwcustom_cd"
    Else
        sql$ = sql$ & "        and  b.custom_cd = c.custom_cd), ' ') wwcustom_cd"
    End If
    sql$ = sql$ & " from MKT_OUT_1 a "
    sql$ = sql$ & " where a.po_no = '" & C_PO_NO & "' "
    sql$ = sql$ & " and   a.invoice_no = '" & C_INV_NO & "' "
    sql$ = sql$ & " and   a.outorder_no in (select b.outorder_no from MKT_OUT_11 b "
    sql$ = sql$ & "                         where b.comp_cd = a.comp_cd and b.bsns_cd = a.bsns_cd and b.outlot_no = '" & strLotNo & "')"
    sql$ = sql$ & " and a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    
    Set SSCODE = Nothing
    SSCODE.Open sql$, DB_User
    
    If SSCODE.RecordCount > 0 Then
        
    End If
    SSCODE.Close
End Sub

Private Sub C_PO_NO_GotFocus()
    Call FIELD_VERIFY
End Sub

Private Sub SET_TRAY_BOXUNIT(varPartNo As String, varRevNo As String)
    ' Customer °¡ NTK(20094)ÀÌ¸ç, Thickness°¡ HighÀÏ °æ¿ì 30ÀÌ ¾Æ´Ñ 60À» »ç¿ë
    ' NTK ÀÏ °æ¿ì 11D-1919-226/B, 11M-5334-N2F/BÀÎ °æ¿ì¿¡¸¸ À§¿¡¼­ Á¤ÀÇÇÑ °Í°ú °°ÀÌ ¼ö·®À» 60À¸·Î ÇÏ°í,
    ' ³ª¸ÓÁö´Â High ÀÏ °æ¿ì 30°³, LowÀÏ °æ¿ì 50°³·Î ÇÑ´Ù. -> Box Unit ¼ö·®À» µû¸¥´Ù.
    '- 2004. 12. 21 by hklee requested by hslee
    If Right(C_CUSTOM_CD, 5) <> "21120" Then Exit Sub
    If (varPartNo = "11D-1919-226" And varRevNo = "B") _
    Or (varPartNo = "11M-5334-N2F" And varRevNo = "B") Then
        I_BOXUNIT_NB = 60
    End If
End Sub

Private Sub C_PO_NO_LostFocus()
    ' Check Data with PO NO
    Dim sql                 As String
    Dim sCustomer           As String  'Ship to
    Dim varMKTOUT1          As String
    Dim varMKTOUT11         As String
    Dim varMKTORD1          As String
    
    'ÃÊ±âÈ­
    varMKTOUT1 = "MKT_OUT_1"
    varMKTOUT11 = "MKT_OUT_11"
    varMKTORD1 = "MKT_ORD_1"
    
    If C_PO_NO.ListCount > 1 Then
        MsgBox "¼±ÅÃÇÏ½Å Á¦Ç°À¸·Î ÃâÇÏÁö½ÃµÈ PO°¡ 2°Ç ÀÌ»ó Á¸ÀçÇÕ´Ï´Ù. PO¸¦ ¹Ýµå½Ã È®ÀÎÇÏ½Ã±â ¹Ù¶ø´Ï´Ù."
    End If
    
    'Check Ship To Customer Data
    sql = " select distinct b.shipto_cd from MKT_ORD_1 a, MKT_OUT_1 b"
    If CHK_INSMP.Value = 1 Then
        sql = sql & " where a.insmp_po_no = '" & C_PO_NO & "'"
        sql = sql & " and   a.insmp_custom_cd = '" & Trim(Right(C_CUSTOM_CD, 5)) & "' " 'from
    Else
        sql = sql & " where a.po_no = '" & C_PO_NO & "'"
        sql = sql & " and   a.custom_cd = '" & Trim(Right(C_CUSTOM_CD, 5)) & "' " 'from
    End If
    sql = sql & " and   a.order_no = b.order_no"
    sql = sql & " and   b.output_dt ='" & Format(SHIP_DATE, "yyyymmdd") & "'"
    sql = sql & " and   a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql = sql & " and   a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    sql = sql & " and   a.comp_cd = b.comp_cd and a.bsns_cd = b.bsns_cd " & vbCrLf

    Set SSCODE = Nothing
    SSCODE.Open sql, DB_User
    
    If SSCODE.RecordCount > 0 Then
        sCustomer = SSCODE!shipto_cd
    End If
    SSCODE.Close
   
    '========================================================
    ' Check Delivery Data for selected Customer, input Lot #, Selected PO #
    ' and fill Part #/Rev/Material/Color/Item#
    '========================================================
    sql$ = "select distinct a.prod_cd, NVL(a.outdirect_qt, 0) outdirect_qt, b.iPART_NO, b.prev_no, b.prod_gubun, b.mater_nm, b.pdesc_nm, b.lowheigh_kb, a.sid_no item_no, " & vbCrLf
    sql$ = sql$ & " (select f.mcode_yn from SYS_CODPD_16 f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and f.mcode_cd = trim(b.pmatr_kb) and f.mcode_class = b.prod_gubun) material, " & vbCrLf
    sql$ = sql$ & " (select f.ref01 from SYS_CODPD_16 f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and f.mcode_cd = trim(b.pmatr_kb) and f.mcode_class = b.prod_gubun) color, " & vbCrLf
    sql$ = sql$ & " nvl((select distinct f.branch_cd from MKT_ORD_1 f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and " & IIf(CHK_INSMP.Value = 1, " f.insmp_custom_cd ", " f.custom_cd") & " = '" & Right(C_CUSTOM_CD, 5) & "' and f.po_no = '" & C_PO_NO & "' " & vbCrLf
    sql$ = sql$ & "                                                 and f.order_no in (select d.order_no from MKT_OUT_1 d  where d.comp_cd = a.comp_cd and d.bsns_cd = a.bsns_cd and d.outorder_no = a.outorder_no)), ' ') branch_cd, " & vbCrLf
    sql$ = sql$ & " nvl((select max(d.item_no) from MKT_CUST_2 d " & vbCrLf
    sql$ = sql$ & "      where d.custom_cd = '" & Trim(Right(C_CUSTOM_CD, 5)) & "' " & vbCrLf
    sql$ = sql$ & "      and   d.comp_cd = a.comp_cd and d.bsns_cd = a.bsns_cd and d.prod_cd = b.prod_cd), ' ') max_item_no, " & vbCrLf
    sql$ = sql$ & " (select count(d.item_no) from MKT_CUST_2 d " & vbCrLf
    sql$ = sql$ & "  where d.custom_cd = '" & Trim(Right(C_CUSTOM_CD, 5)) & "' " & vbCrLf
    sql$ = sql$ & "  and d.comp_cd = a.comp_cd and d.bsns_cd = a.bsns_cd and   d.prod_cd = b.prod_cd) item_no_count, " & vbCrLf
    sql$ = sql$ & " nvl((select e.mcode_nm from SYS_CODPD_06 e where e.comp_cd = a.comp_cd and e.bsns_cd = a.bsns_cd and e.mcode_cd = b.bake_kb and e.mcode_class = b.prod_gubun), ' ') bake, " & vbCrLf
  ' PO¿¡ ´ëÇÑ °¢ Á¦Ç°º° ±âº» Box Pack ¼ö·®Àº MKT_CUST_2¿¡¼­ ÀÐ¾î ¿Â´Ù
    sql$ = sql$ & " nvl((select max(f.box_pack_qt) from MKT_CUST_2 f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and f.custom_cd = '" & Trim(Right(C_CUSTOM_CD, 5)) & "' and  f.prod_cd = b.prod_cd),1) box_unit_qt " & vbCrLf
    sql$ = sql$ & " from MKT_OUT_11 a, PRD_MAST_1_VIEW b " & vbCrLf
    sql$ = sql$ & " where a.outlot_no = '" & strLotNo & "' " & vbCrLf
    sql$ = sql$ & " and   a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and   a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    sql$ = sql$ & " and   a.comp_cd = b.comp_cd and a.bsns_cd = b.bsns_cd " & vbCrLf
    sql$ = sql$ & " and   a.outorder_no in (select distinct d.outorder_no from MKT_ORD_1 c, MKT_OUT_1 d " & vbCrLf
    If CHK_INSMP.Value = 1 Then
        sql$ = sql$ & "                         where c.insmp_po_no = '" & C_PO_NO & "' " & vbCrLf
        sql$ = sql$ & "                         and   c.insmp_custom_cd = '" & Trim(Right(C_CUSTOM_CD, 5)) & "' " & vbCrLf
    Else
        sql$ = sql$ & "                         where c.po_no = '" & C_PO_NO & "' " & vbCrLf
        sql$ = sql$ & "                         and   c.custom_cd = '" & Trim(Right(C_CUSTOM_CD, 5)) & "' " & vbCrLf
    End If
    sql$ = sql$ & "                         and   c.comp_cd = a.comp_cd and c.bsns_cd = a.bsns_cd " & vbCrLf
    sql$ = sql$ & "                         and   d.order_no = c.order_no) " & vbCrLf
    sql$ = sql$ & " and    a.prod_cd = b.prod_cd "

    Set SSCODE = Nothing
    SSCODE.Open sql$, DB_User
    
    If SSCODE.RecordCount > 0 Then
        I_PART_NO = Trim(SSCODE!ipart_no)
        I_REV_NO = Trim(SSCODE!Prev_No)
        I_METERIAL_NM = Trim(SSCODE!material)
        
        varBranchCD = Trim(SSCODE!BRANCH_CD)
        isAgentPeak = IIf(varBranchCD = "15", True, False)  'AGENT PEAK
        Call ComboLoad_ITEM_NO(SSCODE!prod_cd, Trim(Right(C_CUSTOM_CD, 5)))
        Call GS_ComboSelect(C_ITEM_NO, SSCODE!item_no)
        If C_ITEM_NO.ListIndex = -1 Then C_ITEM_NO.ListIndex = 0
        
        I_COLOR_NM = Trim(SSCODE!Color)
        I_TOTAL_QT = Trim(SSCODE!outdirect_qt)
        I_BOXUNIT_NB = Trim(SSCODE!box_unit_qt)
        If SSCODE!prod_gubun = "TR" Then Call SET_TRAY_BOXUNIT(Trim(SSCODE!ipart_no), Trim(SSCODE!Prev_No))  ' TrayÀÎ °æ¿ì NTK¿¡ ´ëÇÑ Box Unit
        
        I_PART_NO.Enabled = True
        I_REV_NO.Enabled = True
        I_METERIAL_NM.Enabled = True
        I_COLOR_NM.Enabled = True
    Else
        I_PART_NO = ""
        I_REV_NO = ""
        I_METERIAL_NM = ""
        
        C_ITEM_NO.Clear
        I_COLOR_NM = ""
        I_DESC_NM = ""
    End If
    SSCODE.Close
    
    '=====================================================
    ' Invoice NO Field°¡ º¸ÀÌ´Â °æ¿ì Invoice Data Check
    '
    ' ¼±ÅÃµÈ Customer, ÀÔ·ÂµÈ Lot #, ¼±ÅÃµÇ¾îÁø PO #°¡
    ' ÃâÇÏÁö½Ã ³»·ÁÁø °ÍÀÎÁö È®ÀÎÇÏ¿© Invoice #°¡ ÇÊ¿äÇÑ °æ¿ì Ã¤¿î´Ù.
    '
    ' WWCUSTOMCode = 21155 CYPRESS          AMD 23395
    ' WWCustomCD = GF_getCode("WWC_SPIL") Then 'WWCUSTOM SPIL
    ' CUstomCode   = 20015 ASE(T) KHH Ãß°¡ 2005.09.14 sjsung
    '                20888 ASE SH,  TI (T) 20562
    '                ASE ADVANCED SHA °Å·¡¼±(22134)
    '                20006, 20916 CARSEM(M)-S, CARSEM(M)-S 2010-06-29 jwkim
    '                20110 ASE(M) Ãß°¡ 2010-12-14 jwkim
    '=====================================================
    '2010-07 Sample ÁøÇàÁß
    If C_INV_NO.Visible = True Or varWWCustomCD = GF_GetCode("WWC_CYPRESS") Or varWWCustomCD = GF_GetCode("WWC_AMD") Or varWWCustomCD = GF_GetCode("WWC_SPIL") Or Trim(Right(C_CUSTOM_CD, 10)) = "20015" Or _
        Trim(Right(C_CUSTOM_CD, 10)) = "20888" Or Trim(Right(C_CUSTOM_CD, 10)) = "22134" Or Trim(Right(C_CUSTOM_CD, 5)) = "20562" Or Trim(Right(C_CUSTOM_CD, 10)) = "20163" Or Trim(Right(C_CUSTOM_CD, 10)) = "20001" Or Trim(Right(C_CUSTOM_CD, 10)) = "20002" Or Trim(Right(C_CUSTOM_CD, 10)) = "20574" Or _
         ((Trim(Right(C_CUSTOM_CD, 10)) = "20180" Or Trim(Right(C_CUSTOM_CD, 10)) = "21844" Or Trim(Right(C_CUSTOM_CD, 10)) = "10507" Or Trim(Right(C_CUSTOM_CD, 10)) = "21832") And GLO_COMP_CD = "FU") Then    'FRC TSMC  2019.01.11 by Liam
                   
'        If CHK_INSMP.Value = 1 Then
'            If Trim(Right(C_FROMSMP_NM, 10)) = GF_GetCode("SITE_TECREACH") Then 'TRERP Invocie Á¶È¸
'                varMKTOUT1 = "TRERP.MKT_OUT_1"
'                varMKTOUT11 = "TRERP.MKT_OUT_11"
'                varMKTORD1 = "TRERP.MKT_ORD_1"
'            End If
'        End If
        sql$ = "select a.invoice_no from " & varMKTOUT1 & " a " & vbCrLf
        sql$ = sql$ & " where a.order_no in (select b.order_no from " & varMKTORD1 & " b " & vbCrLf
        sql$ = sql$ & "                      where a.comp_cd = b.comp_cd and a.bsns_cd = b.bsns_cd " & vbCrLf
        If CHK_INSMP.Value = 1 Then
            sql$ = sql$ & "                      and b.insmp_custom_cd = '" & Right(C_CUSTOM_CD, 5) & "' " & vbCrLf
            sql$ = sql$ & "                      and b.insmp_po_no = '" & C_PO_NO & "' ) " & vbCrLf
        Else
            sql$ = sql$ & "                      and b.custom_cd = '" & Right(C_CUSTOM_CD, 5) & "' " & vbCrLf
            sql$ = sql$ & "                      and b.po_no = '" & C_PO_NO & "' ) " & vbCrLf
        End If
        sql$ = sql$ & " and   a.outorder_no in (select b.outorder_no from " & varMKTOUT11 & " b  where b.comp_cd = a.comp_cd and b.bsns_cd = a.bsns_cd and b.outlot_no = '" & strLotNo & "') " & vbCrLf
        sql$ = sql$ & " and  a.output_dt ='" & Format(SHIP_DATE, "yyyymmdd") & "'" & vbCrLf
        'sql$ = sql$ & " and a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
        sql$ = sql$ & " and a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
        Set SSCODE = Nothing
        SSCODE.Open sql$, DB_User
        
        C_INV_NO.Clear
        If SSCODE.RecordCount > 0 Then
            Do Until SSCODE.EOF
                ' ÀÐ¾î¿Â InvoiceN o°¡ Null¶Ç´Â ºó¹®ÀÚ¿­ÀÏ °æ¿ì Invoice Combo¿¡ ÀÔ·ÂÇÏÁö ¾Ê´Â´Ù.
                If Trim(SSCODE!invoice_no) <> "" Then
                    C_INV_NO.AddItem Mid(Trim(SSCODE!invoice_no), 1, Len(Trim(SSCODE!invoice_no)) - 2) & "-" & Right(Trim(SSCODE!invoice_no), 2)
                End If
                SSCODE.MoveNext
            Loop
        End If
        'Invoice°¡ ¾øÀ» °æ¿ì ÀÚµ¿ »ý¼º¾ÈÇÔ (Order Á¤º¸¸¦ ¾Ë ¼ö ¾øÀ½)
        C_INV_NO.ListIndex = -1
        If C_INV_NO.ListCount > 0 Then C_INV_NO.ListIndex = 0
        
        SSCODE.Close
    End If
    '---------------------------------------------------------------------------------------------------------
    '-------------------------------------------------------------------
    ' 2020.03.13 CPL jenny & JHKIM ¿äÃ»¿¡ µû¶ó End Cust Á¦Ç°ÀÇ °æ¿ì Ship To¸¦ ±âÁØÀ¸·Î ¶óº§ Ãâ·ÂÀ» ÁøÇà ÇÑ´Ù.
    D_CUSTOM_NM = Trim(Left(C_CUSTOM_CD, 30))
    D_SCUSTOM_CD = Trim(Right(C_CUSTOM_CD, 10))  'Ship To
    D_SWWCUST_CD = varWWCustomCD
    
    'EndCustomer Á¤º¸ È®ÀÎ
    sql$ = "select distinct endlabel_kb, scustom_cd, endwwc_cd, fnc_wwc_nm(" & IIf(GLO_KOR_VISIBLE, "'KOR'", "'ENG'") & ", 'Y', a.endwwc_cd) endwwc_nm, " & vbCrLf
    sql$ = sql$ & " (select distinct f.wwcustom_cd from MKT_CUST_1 f where f.custom_cd = a.scustom_cd and f.comp_cd = a.comp_cd and f.bsns_cd =a.bsns_cd ) shipwwc_cd"
    sql$ = sql$ & " from MKT_ORD_1 a " & vbCrLf
    sql$ = sql$ & " where jit_kb = '0'" & vbCrLf 'Jit
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    If CHK_INSMP.Value = 1 Then
        sql$ = sql$ & "  and  a.insmp_po_no = '" & C_PO_NO & "' " & vbCrLf
        sql$ = sql$ & "  and  a.insmp_custom_cd = '" & Trim(Right(C_CUSTOM_CD, 10)) & "' " & vbCrLf
    Else
        sql$ = sql$ & "  and  a.po_no = '" & C_PO_NO & "' " & vbCrLf
        sql$ = sql$ & "  and  a.custom_cd = '" & Trim(Right(C_CUSTOM_CD, 10)) & "' " & vbCrLf
    End If
    sql$ = sql$ & " order by endlabel_kb desc "
    
    Set SSCODE = Nothing
    SSCODE.Open sql$, DB_User
    
    If SSCODE.RecordCount > 0 Then
        D_ENDLABEL_KB = SSCODE!endlabel_kb
        varEndwwc_CD = SSCODE!endwwc_cd
        If SSCODE!endlabel_kb = "1" Then
            D_CUSTOM_NM = SSCODE!endwwc_nm
            D_SCUSTOM_CD = SSCODE!scustom_cd
            D_SWWCUST_CD = SSCODE!shipwwc_cd
        End If
    End If
    SSCODE.Close
    '-------------------------------------------------------------------
    
    Exit Sub

ERR_MSG_RTN:

End Sub

Private Sub ComboLoad_ITEM_NO(varProdCD As String, varCustomCd As String)
    Dim sql         As String
    Dim ssTemp      As New ADODB.Recordset
    
    sql$ = " select item_no from MKT_CUST_2 "
    sql$ = sql$ & " where custom_cd = '" & varCustomCd & "'"
    sql$ = sql$ & " and  prod_cd = '" & varProdCD & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set ssTemp = Nothing
    ssTemp.Open sql$, DB_User
    
    With C_ITEM_NO
        .Clear
    
        If ssTemp.RecordCount = 0 Then
            ssTemp.Close
            .AddItem ""
        Else
            If ssTemp.RecordCount >= 2 Then
                MsgBox IIf(GLO_KOR_VISIBLE, "°Å·¡Ã³º° ITEM Á¤º¸¿¡ µî·ÏµÈ ³»¿ªÀÌ µÎ°³ ÀÌ»óÀÔ´Ï´Ù." & vbCrLf & "°í°´ SID#(ItemNo)¸¦ CPLÆÀ¿¡ È®ÀÎ ÈÄ ¼±ÅÃ ¹Ù¶ø´Ï´Ù.", _
                    "Two or more SID#(Item no) registered in customer list," & vbCrLf & "Please check the SID#(Item no) with CPL team."), _
                    vbExclamation, "Check Data - SID#"
            End If
            Do Until ssTemp.EOF
                .AddItem ssTemp!item_no
                ssTemp.MoveNext
            Loop
            ssTemp.Close
        End If
        .ListIndex = 0
    End With
End Sub

Private Sub I_BOXUNIT_NB_LostFocus()
    Dim LngTotProdQT        As Long
    Dim LngBoxUnit          As Long
    
    I_BOXUNIT_NB = Trim(I_BOXUNIT_NB)
    If I_BOXUNIT_NB = "" Then Exit Sub
    If I_BOXUNIT_NB = "0" Then Exit Sub
    
    If I_TOTAL_QT = "" Then Exit Sub
        
    LngTotProdQT = Val(I_TOTAL_QT)
    LngBoxUnit = Val(I_BOXUNIT_NB)
    
    I_END_CT_NO = IIf(LngTotProdQT Mod LngBoxUnit > 0, LngTotProdQT \ LngBoxUnit + 1, LngTotProdQT \ LngBoxUnit) + Val(I_START_CT_NO) - 1
    I_TOTAL_CT_NO = I_END_CT_NO
End Sub

Private Sub I_BUNDLE_QT_Change()
    I_SET_QT = Val(I_BUNDLE_QT)
    If Val(I_BUNDLE_QT) = 0 Or Trim(I_BUNDLE_QT) = "" Then I_SET_QT = 1
End Sub

Private Sub I_COLOR_NM_LostFocus()
    I_COLOR_NM = Trim(I_COLOR_NM)
End Sub

Private Sub I_DESC_NM_GotFocus()
    Call FIELD_VERIFY
End Sub

Private Sub I_DESC_NM_LostFocus()
    I_DESC_NM = Trim(I_DESC_NM)
End Sub

Private Sub I_END_CT_NO_GotFocus()
    FIELD_VERIFY
End Sub

Private Sub I_END_CT_NO_LostFocus()
    I_END_CT_NO = Trim(I_END_CT_NO)
End Sub

Private Sub C_ITEM_NO_GotFocus()
    Call FIELD_VERIFY
End Sub

Private Sub C_ITEM_NO_LostFocus()
Dim sql         As String
    
    C_ITEM_NO = Trim(C_ITEM_NO)
    
    D_NATION_CD = ""
    D_COO_LAB = GLO_COMP_CO
    'If GLO_COMP_CD = "FU" Or GLO_COMP_CD = "TR" Then   'SMP Ã³¸®¸¦ À§ÇØ ¸ðµç ERP¿¡¼­ ±â´ÉÈ°¼ºÈ­,  Cust Lot Prefix, COO_LAB ¿¡ ´ëÇØ È®ÀÎÇÑ´Ù.
    If CHK_INSMP.Value = 1 Then
        sql$ = "select distinct nvl((select distinct e.CP_LABPREFIX from SYS_COMPANY_1 e where e.cp_code = f.LOT_PREFIX),' ') LOT_PREFIX, " & vbCr
        sql$ = sql$ & "     nvl((select distinct e.cp_nation2_kb from SYS_COMPANY_1 e where  e.comp_cd = g.comp_cd and e.bsns_cd = g.bsns_cd), ' ') cp_nation2, " & vbCr
        sql$ = sql$ & "     nvl((select distinct e.cp_nation2_kb from SYS_COMPANY_1 e where e.cp_nation_kb = f.coo_lab ), ' ') coo_nation2, " & vbCr
        sql$ = sql$ & "     nvl((select distinct e.CP_COO from SYS_COMPANY_1 e where e.cp_nation_kb = f.coo_lab ), ' ') COO_LAB " & vbCr
        sql$ = sql$ & "     from MKT_CUST_2 f, MKT_ORD_1 g " & vbCrLf
        sql$ = sql$ & "     where f.custom_cd = '" & Right(C_CUSTOM_CD, 5) & "' "
        sql$ = sql$ & "     and   f.ipart_no = '" + I_PART_NO + "' " & vbCrLf
        sql$ = sql$ & "     and   f.prev_no = '" + I_REV_NO + "' " & vbCrLf
        sql$ = sql$ & "     and   f.item_no = '" + IIf(C_ITEM_NO = "", " ", C_ITEM_NO) + "' "
        sql$ = sql$ & "     and   g.comp_cd = f.comp_cd and g.bsns_cd = f.bsns_cd and f.custom_cd = g.insmp_custom_cd  " & vbCrLf
        sql$ = sql$ & "     and   g.insmp_po_no = '" & C_PO_NO & "' " & vbCrLf
    Else
        sql$ = "select distinct nvl((select distinct e.CP_LABPREFIX from SYS_COMPANY_1 e where e.cp_code = f.LOT_PREFIX),' ') LOT_PREFIX, " & vbCr
        sql$ = sql$ & "     nvl((select distinct e.cp_nation2_kb from SYS_COMPANY_1 e where  e.comp_cd = g.comp_cd and e.bsns_cd = g.bsns_cd), ' ') cp_nation2, " & vbCr
        sql$ = sql$ & "     nvl((select distinct e.cp_nation2_kb from SYS_COMPANY_1 e where e.cp_nation_kb = f.coo_lab ), ' ') coo_nation2, " & vbCr
        sql$ = sql$ & "     nvl((select distinct e.CP_COO from SYS_COMPANY_1 e where e.cp_nation_kb = f.coo_lab ), ' ') COO_LAB " & vbCr
        sql$ = sql$ & "     from MKT_CUST_2 f, MKT_ORD_1 g " & vbCrLf
        sql$ = sql$ & "      where f.custom_cd = '" & Right(C_CUSTOM_CD, 5) & "' "
        sql$ = sql$ & "      and   f.ipart_no = '" + I_PART_NO + "' " & vbCrLf
        sql$ = sql$ & "      and   f.prev_no = '" + I_REV_NO + "' " & vbCrLf
        sql$ = sql$ & "      and   f.item_no = '" + IIf(C_ITEM_NO = "", " ", C_ITEM_NO) + "' "
        sql$ = sql$ & "      and   g.comp_cd = f.comp_cd and g.bsns_cd = f.bsns_cd and f.custom_cd = g.custom_cd  " & vbCrLf
        sql$ = sql$ & "      and   g.po_no = '" & C_PO_NO & "' " & vbCrLf
    End If
    
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User

    If SSDATA.RecordCount = 0 Then
        SSDATA.Close
        PnlMsg = GLO_MSGLINE(6)
        Field_Check_SW = False
        Exit Sub
    End If
    
    D_COO_LAB = IIf(Trim(SSDATA!COO_LAB) <> "", Trim(SSDATA!COO_LAB), GLO_COMP_CO)  '¹Ìµî·Ï °ÇÀº ±âº»ÀûÀÎ COO·Î Ãâ·ÂÇÑ´Ù.
    D_NATION_CD = IIf(Trim(SSDATA!coo_nation2) <> "", Trim(SSDATA!coo_nation2), Trim(SSDATA!cp_nation2)) '¹Ìµî·Ï °ÇÀº ±âº»ÀûÀÎ COMP_CD ±âÁØÀÇ Nation À¸·Î Ãâ·ÂÇÑ´Ù.
    SSDATA.Close
    
End Sub

Private Sub I_METERIAL_NM_LostFocus()
    I_METERIAL_NM = Trim(I_METERIAL_NM)
End Sub

Private Sub I_PART_NO_KeyPress(KeyAscii As Integer)
    KeyAscii = Asc(UCase(Chr(KeyAscii)))
End Sub

Private Sub I_PCNT_NO_LostFocus()
    I_PCNT_NO = Trim(I_PCNT_NO)
End Sub

Private Sub I_REV_NO_LostFocus()
    I_REV_NO = Trim(I_REV_NO)
    If I_REV_NO = "" Then Exit Sub
    
    ' Check Lot#, Part# with Rev
    If CHECK_INPUT_DATA(I_PART_NO, I_REV_NO, C_LOT_NO) = False Then
        I_REV_NO = "1"
        MsgBox IIf(GLO_KOR_VISIBLE, "Lot#ÀÇ ÀÔ·ÂÀÌ Part No, Rev°ú ¸ÂÁö ¾Ê½À´Ï´Ù." & vbCrLf & "Lot#, Part No, RevÀ» È®ÀÎÇÏ½Ã±â ¹Ù¶ø´Ï´Ù.", _
                                    "Lot# is not correct with Part No&Rev." & vbCrLf & "Check Lot#, Part No, Rev.")
        Exit Sub
    End If
    
    Call FIELD_VERIFY
End Sub

Private Sub I_SET_QT_LostFocus()
    Dim strMsg      As String
    
    I_SET_QT = Trim(I_SET_QT)
    If I_SET_QT = "" Then Exit Sub
    
    If I_SET_QT = 0 Then
        MsgBox IIf(GLO_KOR_VISIBLE, "Set ¼ö·®Àº 1°³ ÀÌ»óÀÌ¾î¾ß ÇÕ´Ï´Ù.", "Set Qty should be more then 1")
        I_SET_QT = 1
        Exit Sub
    End If
    
    If I_SET_QT > 2 Or I_SET_QT < 1 Then
        strMsg = IIf(GLO_KOR_VISIBLE, " ÀÎ¼âÇÏ½Ã·Á´Â ¶óº§ Set ¼ö·®ÀÌ" & I_SET_QT & " °³°¡ ¸Â½À´Ï±î?", " Lable Qty for Print is " & I_SET_QT & ", is it right?")
        
        If MsgBox(strMsg, 292, "Print") = vbNo Then Exit Sub
        I_SET_QT = IIf(PRT_OP(0).Value = True, 1, 2)
        PnlMsg = ""
    End If
End Sub

Private Sub I_START_CT_NO_LostFocus()
    Dim LngTotProdQT        As Long
    Dim LngBoxUnit          As Long
    
    I_START_CT_NO = Trim(I_START_CT_NO)
    If I_START_CT_NO = "" Then Exit Sub
    
    If I_TOTAL_QT = "" Then Exit Sub
    If I_BOXUNIT_NB = "" Then Exit Sub
    If I_BOXUNIT_NB = "0" Then Exit Sub
    
    LngTotProdQT = Val(I_TOTAL_QT)
    LngBoxUnit = Val(I_BOXUNIT_NB)
    
    I_END_CT_NO = IIf(LngTotProdQT Mod LngBoxUnit > 0, LngTotProdQT \ LngBoxUnit + 1, LngTotProdQT \ LngBoxUnit) + Val(I_START_CT_NO) - 1
    I_TOTAL_CT_NO = I_END_CT_NO
End Sub

Private Sub I_TOTAL_CT_NO_LostFocus()
    I_TOTAL_CT_NO = Trim(I_TOTAL_CT_NO)
End Sub

Private Sub I_TOTAL_QT_LostFocus()
    Dim Result_QT   As Integer
    Dim Box_QT      As Integer
    
    I_TOTAL_QT = Trim(I_TOTAL_QT)
    If I_TOTAL_QT = "" Then Exit Sub
    
    If Val(I_TOTAL_QT) > 0 And Val(I_TOTAL_QT) < Val(I_BOXUNIT_NB) Then I_BOXUNIT_NB = I_TOTAL_QT
    
    Result_QT = 0
    Box_QT = 0
    If Val(I_TOTAL_QT) > 0 And Val(I_BOXUNIT_NB) > 0 Then
        Result_QT = Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB)
        Box_QT = Val(I_TOTAL_QT) \ Val(I_BOXUNIT_NB)
            
        If Result_QT = 0 Then
            I_TOTAL_CT_NO = Box_QT
        Else
            I_TOTAL_CT_NO = Box_QT + 1
        End If
        I_END_CT_NO = I_TOTAL_CT_NO
        I_START_CT_NO = 1
    End If
End Sub

Private Sub Field_Clear()
    Dim i       As Integer
    Dim strTemp As String
    
    On Error Resume Next
    
    For i = 0 To Me.Count - 1
        strTemp = UCase(Me.Controls(i).Name)
        If Len(strTemp) > 2 Then
            If Left(strTemp, 2) = "I_" Then
                Me.Controls(i).Text = ""
                Me.Controls(i).Caption = ""
                Me.Controls(i).Enabled = True
                Me.Controls(i).BackColor = &HFFFFFF
            ElseIf Left(strTemp, 2) = "D_" Then
                If UCase(Me.Controls(i).Container.Name) <> "KEY_PANEL" Then Me.Controls(i).Text = ""
                If UCase(Me.Controls(i).Container.Name) <> "KEY_PANEL" Then Me.Controls(i).Caption = ""
                If UCase(Me.Controls(i).Container.Name) <> "KEY_PANEL" Then Me.Controls(i).BackColor = &HE0E0E0
            ElseIf Left(strTemp, 2) = "C_" Then
                If Me.Controls(i).Tag <> "Y" Then Me.Controls(i).ListIndex = -1
                Me.Controls(i).Enabled = True
            ElseIf Left(strTemp, 4) = "CHK_" Then
                If UCase(Me.Controls(i).Container.Name) <> "KEY_FRAME" Then Me.Controls(i).Value = 0
                If UCase(Me.Controls(i).Container.Name) <> "KEY_FRAME" Then Me.Controls(i).Enabled = True
            ElseIf Left(strTemp, 4) = "OPT_" Then
                If UCase(Me.Controls(i).Container.Name) <> "KEY_FRAME" Then Me.Controls(i).Value = False
                Me.Controls(i).Enabled = True
            End If
        End If
    Next i
    
    PRT_FORM(0).Value = True    'C/T BOX ±âº»¼±ÅÃ
    
End Sub

Private Function PORT_OPEN(Optional iPrtPort As Integer)
    Dim sPortNO     As Integer
    Dim sSetting    As String
    
    On Error Resume Next
    
    sPortNO = IIf(iPrtPort <> 0, iPrtPort, Val(myINI.portcfg))
    sSetting = "9600,N,8,1"

    MSComm1.CommPort = sPortNO
    MSComm1.Settings = sSetting
    MSComm1.OutBufferSize = 1024

    MSComm1.PortOpen = True
End Function

Private Function SEND_DATA(sSTRING As String)
            
    On Error GoTo ErrorRTN
            
    MSComm1.Output = sSTRING
    
    Exit Function
ErrorRTN:
    MsgBox IIf(GLO_KOR_VISIBLE, "È¯°æ¼³Á¤À» ´Ù½Ã ÇÏ¼¼¿ä.", "Set Configuration again."), vbCritical, "Error"

End Function

Private Function PORT_CLOSE()
    On Error Resume Next
    MSComm1.PortOpen = False
End Function

Private Sub CMD_CLEAR_Click()

    Call Field_Clear
    
    C_PO_NO.Clear
    C_INV_NO.Clear
    CT_PRINT_CHK.Value = 1
    
    I_METERIAL_NM = "PES"
    I_BOXUNIT_NB = 50
    I_START_CT_NO = 1
    Label_Cnt = 0
    D_TOT_LABEL_CNT = 0
    
    I_SET_QT = IIf(PRT_OP(0).Value = True, 1, 2)
    
    ReDim Label_Data(3000)
End Sub

Private Sub CMD_EXIT_Click()
    Unload Me
End Sub

Private Sub CMD_PRINT_Click()

    Dim filehandle As Integer, tempNums As Integer

    Screen.MousePointer = 11
    CMD_SAVE.Enabled = False
    Key_Panel.Enabled = False
    
    ProgPnl.Caption = ""                    ' Dummy Coding
    ProgPnl.Visible = True
    ProgPnl.Caption = ""
     
    ProgressBar1.Min = 1
    ProgressBar1.Max = IIf(Val(D_TOT_LABEL_CNT) = 0, 2, Val(D_TOT_LABEL_CNT) + 1)
    
    Label_Cnt = 1
        
   'LAN PRINT(IT Center)¸¦ ¼±ÅÃÇÑ °æ¿ì¿¡¸¸ ¼ÒÄÏ ¿¬°áÀ» È®ÀÎÇÑ´Ù. FRC´Â LAN PRINT ¸¸À» Áö¿øÇÑ´Ù.
    If ChkLANPRT.Value = 1 Or GLO_COMP_CD = "FU" Then   'FU´Â LAN PRINT·Î Ãâ·ÂÇÑ´Ù.
        If GLO_COMP_CD = "DW" And GLO_DEPT_CD = "10011" Then '(ÇöÀç´Â IT Center¿¡¼­¸¸ ¶óº§ Ãâ·Â Å×½ºÆ® ¿ëµµ·Î »ç¿ëÁß)
            Call GF_SocketConnect(Lantype_Sck, "BC_PRT0048_IP") 'IT¼¾ÅÍ ¹ÙÄÚµå ÇÁ¸°ÅÍ (Å×½ºÆ®Àåºñ)
        ElseIf GLO_COMP_CD = "FU" And ChkLANPRT.Value <> 1 Then
            Call GF_SocketConnect(Lantype_Sck, "FRC_BCPRT_3F_2_IP")   'FRC Barcode Printer 3F IP For PEAK Label
        Else
            Call GF_SocketConnect(Lantype_Sck, "BC_PRT0048_IP")
        End If
        
        If Lantype_Sck.State = sckConnected Then  'Socket ¿¬°áÈ®ÀÎ
            'MsgBox "ÀÌ¹Ì ¿¬°áµÇ¾î ÀÖ½À´Ï´Ù."
        Else
            MsgBox "¿¬°áÀÌ ÇØÁ¦µÇ¾î ÀÖ½À´Ï´Ù." & vbCrLf & "LAN TYPE ¹ÙÄÚµå ÇÁ¸°ÅÍ ¿¬°á»óÅÂ¸¦ È®ÀÎ¹Ù¶ø´Ï´Ù."
            Screen.MousePointer = 0
            Exit Sub
        End If
        
        For Label_Cnt = 1 To Val(D_TOT_LABEL_CNT)
            Lantype_Sck.SendData (Label_Data(Label_Cnt))
        Next
    Else
        If PRT_SET(0).Value = True Then     'LPT¹æ½Ä
            '-----------------------------------------------------
            'LPT ÇÁ¸°Æ® (S+G ¹æ½Ä) '-------------------------
            filehandle = FreeFile
            Open "LPT1: " For Output As #filehandle
        
            For Label_Cnt = 1 To Val(D_TOT_LABEL_CNT)
                Print #filehandle, Label_Data(Label_Cnt)
            Next
            Close #filehandle
            '-----------------------------------------------------
        Else    'Daewon Ãâ·Â¹æ½Ä
            'Serial Port·Î Ãâ·ÂÅ×½ºÆ® (Datamax Print)
            For Label_Cnt = 1 To Val(D_TOT_LABEL_CNT)
                Call SEND_DATA(Label_Data(Label_Cnt))
            Next
        End If
    End If

    Screen.MousePointer = 0
    CMD_SAVE.Enabled = True
    CMD_PRINT.Enabled = False
    
    Key_Panel.Enabled = True
    
    Label_Cnt = 0
    D_TOT_LABEL_CNT = "0"
    I_END_CT_NO = "1"
    ReDim Label_Data(3000)
    
    '=============================================================
    ProgPnl.Caption = ""                    ' Dummy Coding
    ProgPnl.Visible = False
    ProgPnl.Caption = ""
    '=============================================================
End Sub
Private Function CHECK_OUTData() As String
    '¼±ÅÃÇÑ °í°´, Á¦Ç°, POÀÇ Á¤º¸¸¦ È®ÀÎÇÏ¿© PartNo, Rev, item_no, line_code, invoice Á¤º¸°¡ ÃâÇÏÁö½Ã Á¤º¸¿Í ÀÏÄ¡ÇÏ´ÂÁö Ã¼Å©
    Dim sql         As String
    Dim ssTemp      As New ADODB.Recordset
    Dim po_no       As String
    Dim lot_no      As String
    Dim item_no     As String
    Dim line_code   As String
    Dim part_no     As String
    Dim rev_no      As String
    Dim invoice_no  As String
    Dim custom_cd   As String
    Dim output_dt   As String
    Dim strMsg      As String
    Dim returnStr   As String
    Dim isError     As Boolean
                    
    On Error GoTo ERROR_RTN
        
    po_no = Trim(C_PO_NO)
    lot_no = Trim(C_LOT_NO)
    item_no = Trim(C_ITEM_NO)
    line_code = Trim(C_LOT_ID)
    part_no = Trim(I_PART_NO)
    rev_no = Trim(I_REV_NO)
    invoice_no = Replace(Trim(C_INV_NO), "-", "")
    custom_cd = Trim(Right(C_CUSTOM_CD, 10))
    output_dt = Format(SHIP_DATE, "yyyymmdd")
        
    sql = " select distinct order_no, nvl(invoice_no,' ' ) invoice_no , nvl(sid_no,' ' ) sid_no, nvl(custom_line_cd,' ') custom_line_cd, ipart_no, prev_no" & vbCrLf
    sql = sql & " from mkt_out_1 a , mkt_out_11 b" & vbCrLf
    sql = sql & " Where a.outorder_no = b.outorder_no" & vbCrLf
    sql = sql & " and a.po_no ='" & po_no & "'" & vbCrLf
    sql = sql & " and a.output_dt ='" & output_dt & "'" & vbCrLf
    sql = sql & " and b.outlot_no ='" & lot_no & "'" & vbCrLf
         
    ssTemp.Open sql, DB_User
    
    If ssTemp.RecordCount <= 0 Then
        ssTemp.Close
        CHECK_OUTData = "ÃâÇÏÁö½ÃµÈ Á¤º¸°¡ ¾ø½À´Ï´Ù."
        Exit Function
    End If
                
    isError = False
    
    If ssTemp.RecordCount = 1 Then
    
        If Trim(item_no) <> Trim(ssTemp!sid_no) Then
            strMsg = strMsg & "ITEM#°¡ ÀÏÄ¡ÇÏÁö ¾Ê½À´Ï´Ù. (ÃâÇÏÁö½Ã Á¤º¸:" & ssTemp!sid_no & ")" & vbCrLf
            isError = True
        End If
        
        If Trim(part_no) <> Trim(ssTemp!ipart_no) Then
            strMsg = strMsg & "PART#°¡ ÀÏÄ¡ÇÏÁö ¾Ê½À´Ï´Ù. (ÃâÇÏÁö½Ã Á¤º¸:" & ssTemp!ipart_no & ")" & vbCrLf
            isError = True
        End If
        
        If Trim(rev_no) <> Trim(ssTemp!Prev_No) Then
            strMsg = strMsg & "REV#°¡ ÀÏÄ¡ÇÏÁö ¾Ê½À´Ï´Ù. (ÃâÇÏÁö½Ã Á¤º¸:" & ssTemp!Prev_No & ")" & vbCrLf
            isError = True
        End If
        
        If Trim(line_code) <> "" And Trim(line_code) <> Trim(ssTemp!custom_line_cd) Then
            strMsg = strMsg & Label1(22).Caption & "°¡ ÀÏÄ¡ÇÏÁö ¾Ê½À´Ï´Ù. (ÃâÇÏÁö½Ã Á¤º¸:" & ssTemp!custom_line_cd & ")" & vbCrLf
            isError = True
        End If
                
        If Trim(invoice_no) <> "" And Trim(invoice_no) <> Trim(ssTemp!invoice_no) Then
            strMsg = strMsg & "Invoice°¡ ÀÏÄ¡ÇÏÁö ¾Ê½À´Ï´Ù. (ÃâÇÏÁö½Ã Á¤º¸:" & ssTemp!invoice_no & ")" & vbCrLf
            isError = True
        End If
    Else
        ssTemp.Close
        
        sql = " select distinct order_no, nvl(invoice_no,' ' ) invoice_no , nvl(sid_no,' ' ) sid_no, nvl(custom_line_cd,' ') custom_line_cd, ipart_no, prev_no" & vbCrLf
        sql = sql & " from mkt_out_1 a , mkt_out_11 b" & vbCrLf
        sql = sql & " Where a.outorder_no = b.outorder_no" & vbCrLf
        sql = sql & " and a.po_no ='" & po_no & "'" & vbCrLf
        sql = sql & " and a.output_dt ='" & output_dt & "'" & vbCrLf
        sql = sql & " and b.outlot_no ='" & lot_no & "'" & vbCrLf
        sql = sql & " and b.ipart_no ='" & part_no & "'" & vbCrLf
        sql = sql & " and b.prev_no ='" & rev_no & "'" & vbCrLf
        sql = sql & " and trim(b.sid_no) ='" & item_no & "'" & vbCrLf
        If Trim(line_code) <> "" Then sql = sql & " and trim(b.custom_line_cd) ='" & line_code & "'" & vbCrLf
        If Trim(invoice_no) <> "" Then sql = sql & " and trim(b.invoice_no) ='" & invoice_no & "'" & vbCrLf
                     
        ssTemp.Open sql, DB_User
        
        If ssTemp.RecordCount <= 0 Then
            ssTemp.Close
            CHECK_OUTData = "ÀÔ·ÂÇÑ Á¤º¸·Î ÃâÇÏÁö½ÃµÈ Á¤º¸°¡ ¾ø½À´Ï´Ù."
            Exit Function
        End If
    End If
    
    ssTemp.Close
    
    If isError = True Then
        returnStr = "ÀÔ·ÂÇÑ Á¤º¸¿Í ÃâÇÏÁö½Ã Á¤º¸°¡ ÀÏÄ¡ÇÏÁö ¾Ê½À´Ï´Ù." & vbCrLf
        returnStr = returnStr & "------------------------------------------------" & vbCrLf
        returnStr = returnStr & strMsg
        returnStr = returnStr & "------------------------------------------------" & vbCrLf
        CHECK_OUTData = returnStr
    Else
        CHECK_OUTData = ""
    End If
    
    Exit Function
    
ERROR_RTN:
    CHECK_OUTData = "ÃâÇÏÁö½Ã Á¤º¸ È®ÀÎÁß ¿À·ù°¡ ¹ß»ýÇß½À´Ï´Ù. IT¼¾ÅÍ¿¡ ¹®ÀÇÇÏ¼¼¿ä"
End Function
Private Sub CMD_SAVE_Click()
    Dim i               As Integer
    Dim j               As Integer
    
    Dim Style           As String
    Dim sql             As String
    Dim CheckMsg        As String
    
    If C_LOT_NO = "" Then
        MsgBox ("LOT NO not input")
        Exit Sub
    ElseIf C_PO_NO = "" Then
        MsgBox ("PO NO not input")
        Exit Sub
    ElseIf I_PART_NO = "" Then
        MsgBox ("Part NO not input")
        Exit Sub
    ElseIf I_REV_NO = "" Then
        MsgBox ("REV NO not input")
        Exit Sub
    ElseIf I_METERIAL_NM = "" Then
        MsgBox ("METERIAL_NM not input")
        Exit Sub
    ElseIf I_COLOR_NM = "" Then
        MsgBox ("COLOR not input")
        Exit Sub
    ElseIf C_ITEM_NO = "" Then
        Msg = "Item No not input,"                     ' Define message.
        Msg = Msg & vbCrLf & " Delete Data?"
        Style = vbYesNo + vbCritical + vbDefaultButton2     ' Define buttons.
        Title = "Delete Data"                               ' Define title.
     
        If MsgBox(Msg, Style, Title) = vbNo Then
            C_ITEM_NO.SetFocus
            Exit Sub
        End If
    ElseIf I_DESC_NM = "" Then
        MsgBox ("Description not input")
        Exit Sub
    ElseIf I_END_CT_NO = "" Or I_TOTAL_CT_NO = "" Then
        MsgBox ("Label Count not input")
        Exit Sub
    End If
    
    'Á¦Ç° ÃâÇÏÁö½Ã Á¤º¸ È®ÀÎ (ÃâÇÏÁö½Ã Á¤º¸¿Í ÀÏÄ¡ÇÏÁö ¾ÊÀ» °æ¿ì ¸Þ¼¼Áö Ç¥½Ã)
   ' CheckMsg = CHECK_OUTData
   ' If CheckMsg <> "" Then
   '     If MsgBox(CheckMsg & vbCrLf & "ÀúÀåÇÏ½Ã°Ú½À´Ï±î?", vbYesNo, "Info") = vbNo Then
   '         Exit Sub
   '     End If
   ' End If
    
    '=============================================================
    ' Default Type¿¡¼­
    ' Tray¿Í EndCap, Customer¿¡ µû¶ó D_Barcode¸¦ ´Þ¸® Pront ÇÑ´Ù.
    '=============================================================
    sql$ = " select distinct a.prod_cd, a.prod_gubun, "
    sql$ = sql$ + " DECODE(NVL((select distinct mold_no from prd_work_11 where comp_cd = '" & GLO_COMP_CD & "' and bsns_cd = '" & GLO_BSNS_CD & "' and  outlot_no ='" & strLotNo & "' and iPART_NO = '" & I_PART_NO & "' and prev_no ='" & I_REV_NO & "' and trim(mold_no) <> '' ), ' '), ' ',"
    sql$ = sql$ + "   (select distinct mold_no from CIM_MACHI_LOT_INFO where comp_cd = '" & GLO_COMP_CD & "' and bsns_cd = '" & GLO_BSNS_CD & "' and lot_no ='" & strLotNo & "' and iPART_NO = '" & I_PART_NO & "' and prev_no ='" & I_REV_NO & "'),"
    sql$ = sql$ + "   (select distinct mold_no from prd_work_11 where comp_cd = '" & GLO_COMP_CD & "' and bsns_cd = '" & GLO_BSNS_CD & "' and outlot_no ='" & strLotNo & "' and iPART_NO = '" & I_PART_NO & "' and prev_no ='" & I_REV_NO & "' and trim(mold_no) <> '' ) )  mold_no"
    sql$ = sql$ + " from PRD_MAST_1_VIEW a "
    sql$ = sql$ + " where a.iPART_NO = '" & I_PART_NO & "' "
    sql$ = sql$ + " and   a.prev_no = '" & I_REV_NO & "' "
    sql$ = sql$ & " and a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    
    Set SSCODE = Nothing
    SSCODE.Open sql$, DB_User
    
    If SSCODE.RecordCount > 0 Then
        varMoldNo = Trim(IIf(IsNull(SSCODE!mold_no) = True, "", SSCODE!mold_no)) 'Recycle ÀÔ°íÀÇ °æ¿ì Mold No¸¦ ¾Ë¼ö ¾øÀ½
        If varMoldNo <> "" Then
            varMoldNo = Gf_MoldDesc_Load(varMoldNo)     'Mold Desc
        End If
    Else
        varMoldNo = ""
    End If
    
    Select Case SSCODE!prod_gubun
        Case "TR"
            D_BARCODE_TX = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & I_REV_NO + I_PART_NO
        Case "TE"
            D_BARCODE_TX = "00" + I_REV_NO + I_PART_NO
        Case "TC"
        
    End Select
    SSCODE.Close
        
    'WW ¾÷Ã¼º° ¼±ÅÃ
    If varWWCustomCD = "20200" Then ' AMKOR  WWCUSTOM_CD :20200 2010-07-05 jwkim
        If Trim(Right(C_CUSTOM_CD, 10)) = "10001" Or Trim(Right(C_CUSTOM_CD, 10)) = "10011" Or Trim(Right(C_CUSTOM_CD, 10)) = "10003" Then 'ATK-1, ATK-3, ATK-4 °í°´¸¸ ÇØ´ç ¾ç½Ä »ç¿ë 2014.01.07 S+G kimsi
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call T4_ATK_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
        Else
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call T4_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
        End If
    ElseIf varWWCustomCD = "22960" Then ' NANYA  WWCUSTOM_CD :22960 2018-05-23
        If PRT_FORM(1).Value = True Then                               'InnerLabel ÇÁ¸°Æ®
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call TR_NANYA_InnerLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
        ElseIf PRT_FORM(0).Value = True Then                           'BoxLabel ÇÁ¸°Æ®
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call TR_NANYA_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
        End If
    ElseIf varWWCustomCD = "21665" Then     'SPIL  WWCUSTOM_CD :21665 WWC ÅëÇÕÀû¿ë 2020.05.27 by CPL_orim
        For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
            For j = 1 To Val(I_SET_QT)
                Call T4_SPIL_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                Label_Cnt = Label_Cnt + 1
                Label_Data(Label_Cnt) = sFormatTx
            Next j
        Next i
    Else
        'SITE º° ¼±ÅÃ
        Select Case Trim(Right(C_CUSTOM_CD, 10))
        
        Case "20180", "21844", "10507", "21832"  '2014-04-07 TSMC (TAIWAN SEMICONDUCTOR MANUFACTURING CO.,L) ¶óº§ by ICS_jwkim&IS_Junmo, 2018-11-06 add Sites TSMC FAB2, TSMC FAB30 by Jim Chen
             If C_INV_NO = "" And GLO_COMP_CD = "FU" Then   '20181008 jeenie & liam by FRCUNION
                MsgBox IIf(GLO_KOR_VISIBLE, "INVOICE NO¸¦ ÀÔ·ÂÇÏÁö ¾Ê¾Ò½À´Ï´Ù", "You have not entered INVOICE NO"), vbExclamation
                Exit Sub
            End If
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call TR_TSMC_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
        Case "20172", "21876" 'SCC, JSCC 2015.07.29 S+G Ella Kim(±è»õ·Ò) ½Å±Ô¾ç½Ä ¿äÃ» °Ç
            If PRT_FORM(0).Value = True Then                                    'BoxLabel ÇÁ¸°Æ®
                For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                    For j = 1 To Val(I_SET_QT)
                        Call T4_SCC_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                        Label_Cnt = Label_Cnt + 1
                        Label_Data(Label_Cnt) = sFormatTx
                    Next j
                Next i
            ElseIf PRT_FORM(1).Value = True Then                               'InnerLabel ÇÁ¸°Æ® ÇÑÀå¿¡ °°ÀÌ Ãâ·Â (1/2¾¿) °°Àº³»¿ë ¹Ýº¹
                For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                    For j = 1 To Val(I_SET_QT)
                        Call T4_SCC_InnerLabel_Print(i, Val(I_TOTAL_CT_NO))
                        Label_Cnt = Label_Cnt + 1
                        Label_Data(Label_Cnt) = sFormatTx
                    Next j
                Next i
            End If
            
        Case "20038" 'SCS 2017-03-08 S+G Ella Kim(±è»õ·Ò) ½Å±Ô¾ç½Ä ¿äÃ» °Ç
            If PRT_FORM(0).Value = True Then                                    'BoxLabel ÇÁ¸°Æ®
                For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                    For j = 1 To Val(I_SET_QT)
                        Call T4_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                        Label_Cnt = Label_Cnt + 1
                        Label_Data(Label_Cnt) = sFormatTx
                    Next j
                Next i
            ElseIf PRT_FORM(1).Value = True Then                               'InnerLabel ÇÁ¸°Æ® ÇÑÀå¿¡ °°ÀÌ Ãâ·Â (1/2¾¿) °°Àº³»¿ë ¹Ýº¹
                For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                    For j = 1 To Val(I_SET_QT)
                        Call T4_SCS_InnerLabel_Print(i, Val(I_TOTAL_CT_NO))
                        Label_Cnt = Label_Cnt + 1
                        Label_Data(Label_Cnt) = sFormatTx
                    Next j
                Next i
            End If
'        Case "20289", "21311", "21316" 'SPIL TW, SPIL SZ  '2013-05-13 by ICS_jwkim & S+G Aiden Kim , 2015.07.29 S+G Ella Kim(±è»õ·Ò) Ãß°¡ º¯°æ ¿äÃ» ¹Ý¿µ (ÃâÇÏLOT), 2019.12.04 FRC CPL Liam request SPIL DF label
'            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
'                For j = 1 To Val(I_SET_QT)
'                    Call T4_SPIL_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
'                    Label_Cnt = Label_Cnt + 1
'                    Label_Data(Label_Cnt) = sFormatTx
'                Next j
'            Next i
        Case "21669" 'SFA KOREA  '2014-11-26 by S+G kimsi
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call T4_STS_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
        
       Case "20209"    'King Yuan Electronics Co.,LTD.   '2014-10-20 by S+G kimsi
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call TR_KYEC_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
            
        Case "10426", "10005" 'SCK  '2011-12-21 by ICS_jwkim & S+G jhbaek , JSCK 2016.04.01 ¿äÃ»¿¡ µû¶ó Ãß°¡
        
            If Trim(C_LOT_ID) = "" Then
                If MsgBox("ÃâÇÏ LOT ID°¡ ¾ø½À´Ï´Ù. ¿µ¾÷ÆÀ¿¡ ¹®ÀÇ ÇÏ½Ã±â ¹Ù¶ø´Ï´Ù. " & vbCrLf & "°è¼ÓÁøÇàÇÏ½Ã°Ú½À´Ï±î?", vbYesNo) = vbNo Then Exit Sub
            End If
        
            If PRT_FORM(1).Value = True Then   'InnerLabel ÇÁ¸°Æ®
               For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                   For j = 1 To Val(I_SET_QT)
                       Call TR_SCK_innerLabel_Print(i, Val(I_TOTAL_CT_NO))
                       Label_Cnt = Label_Cnt + 1
                       Label_Data(Label_Cnt) = sFormatTx
                   Next j
               Next i
            Else
               For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                    For j = 1 To Val(I_SET_QT)
                        Call T4_SCK_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                        Label_Cnt = Label_Cnt + 1
                        Label_Data(Label_Cnt) = sFormatTx
                    Next j
                Next i
            End If
                       
        Case "20690" 'Renesas JPN  '2013-05-13 by ICS_jwkim & S+G Aiden Kim
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call T4_Renesas_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
            
        Case "20684"    'ST-Micro(Malta)   '2011-12-21 by ICS_jwkim & S+G jhbaek
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call T4_ST_MALTA_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
            
        Case "20015", "20163"   'ASEK, ASET   '2011-12-26 by ICS_jwkim & S+G jhbaek
            If Trim(C_LOT_ID) = "" Then
                If MsgBox("RT No°¡ ¾ø½À´Ï´Ù. °è¼ÓÁøÇàÇÏ½Ã°Ú½À´Ï±î?", vbYesNo) = vbNo Then Exit Sub
            End If
                
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call T4_ASEK_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
            
        Case "20779", "20276", "22169", "21643" 'ASECL  '2014-01-22 by S+G kimsi, 'ASE MATL CL (20276) 2020-02-17 by FRC IT Jim Chen & CPL Liam Bae, 'ASE CHUNG-LI(22169), ASE CHUNG-LI.(21643) by 2022.09.08 CPL oskwon
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call TR_ASECL_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
            
        Case "20562"    'TITL 2017-03-07 by srkim
        
            If PRT_FORM(0).Value = True Then                                    'BoxLabel ÇÁ¸°Æ®
                For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                    For j = 1 To Val(I_SET_QT)
                        Call T4_TITL_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                        Label_Cnt = Label_Cnt + 1
                        Label_Data(Label_Cnt) = sFormatTx
                    Next j
                Next i
            ElseIf PRT_FORM(1).Value = True Then                               'InnerLabel ÇÁ¸°Æ® ÇÑÀå¿¡ °°ÀÌ Ãâ·Â (1/2¾¿) °°Àº³»¿ë ¹Ýº¹
                For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                    For j = 1 To Val(I_SET_QT)
                        Call T4_TITL_InnerLabel_Print(i, Val(I_TOTAL_CT_NO))
                        Label_Cnt = Label_Cnt + 1
                        Label_Data(Label_Cnt) = sFormatTx
                    Next j
                Next i
            End If
            
        Case "20910"    '2021.11.25  MICRON (S) CPL hilee
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call TR_MICRON_S_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
            
        Case "21979" And GLO_COMP_CD = "FU"  'MICRON TAIWAN   '2019-11-08 by FRC IT Jim Chen & CPL Liam Bae
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call T4_MICRONTW_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
            
        Case "20860" And GLO_COMP_CD = "FU"  'POWERTECH(T)20860   '2020-05-14 by FRC IT Jim Chen & CPL Liam Bae
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call T4_POWERTECH_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
            Next j
        Next i
            
         Case "20888", "22134" And GLO_COMP_CD = "FU"   'ASKSH 2019-11-08 by FRC Jim Chen & CPL Liam Seo
            If Trim(C_LOT_ID) = "" Then
                If MsgBox("RT No hasn't been registered? Continue?", vbYesNo) = vbNo Then Exit Sub
            End If
            
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call T4_ASEK_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                    Call T4_ASESH_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i

        Case "21347" And GLO_COMP_CD = "FU"  'ASEKS   '2019-11-08 by FRC IT Jim Chen & CPL Liam Bae
            If Trim(C_LOT_ID) = "" Then
                If MsgBox("RT No hasn't been registered? Continue?", vbYesNo) = vbNo Then Exit Sub
            End If
                
            For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                For j = 1 To Val(I_SET_QT)
                    Call T4_ASEKS_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                    Label_Cnt = Label_Cnt + 1
                    Label_Data(Label_Cnt) = sFormatTx
                Next j
            Next i
            
        Case Else   'Default
            Select Case True
                Case PRT_OP(0).Value
                    '±¹³»
                    For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                        For j = 1 To Val(I_SET_QT)
                            Call T4_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                            Label_Cnt = Label_Cnt + 1
                            Label_Data(Label_Cnt) = sFormatTx
                        Next j
                    Next i
                Case PRT_OP(1).Value
                    For i = Val(I_START_CT_NO) To Val(I_END_CT_NO)
                        For j = 1 To Val(I_SET_QT)
                            Call T4_BoxLabel_Print(i, Val(I_TOTAL_CT_NO))
                            Label_Cnt = Label_Cnt + 1
                            Label_Data(Label_Cnt) = sFormatTx
                        Next j
                    Next i
            End Select
         End Select
    End If
    
    D_TOT_LABEL_CNT = Format(Label_Cnt, "###0")
    CMD_PRINT.Enabled = True
End Sub

Private Function MKT_LABEL_SEQ(wwcustomCD As String, customCD As String, LotNo As String, ShipDT As String) As Integer
    Dim sql             As String
    Dim RecordsAffected As Integer
    
    Dim LotSeq          As Integer
    
    sql$ = "select lot_seq from MKT_LABEL_SEQ "
    sql$ = sql$ & " where wwcustom_cd = '" & wwcustomCD & "'"
    sql$ = sql$ & " and   custom_cd = '" & customCD & "' "
    sql$ = sql$ & " and   lot_No = '" & LotNo & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    If SSDATA.RecordCount <= "0" Then
        LotSeq = 1
        sql$ = "insert into MKT_LABEL_SEQ (comp_cd, bsns_cd, WWCUSTOM_CD, CUSTOM_CD, LOT_NO, LOT_SEQ,JOB_SEQ,SHIP_DT,REGIST_DT, EMP_NO,IP_ADDR) "
        sql$ = sql$ & " values ("
        sql$ = sql$ & " '" & GLO_COMP_CD & "', "                 'comp_cd
        sql$ = sql$ & " '" & GLO_BSNS_CD & "', "                   'bsns_cd
        sql$ = sql$ & " '" & wwcustomCD & "',"
        sql$ = sql$ & " '" & customCD & "',"
        sql$ = sql$ & " '" & LotNo & "',"
        sql$ = sql$ & " '" & LotSeq & "',"
        sql$ = sql$ & " 0,"
        sql$ = sql$ & " '" & ShipDT & "',"
        sql$ = sql$ & " sysdate,"
        sql$ = sql$ & " '" & GLO_USER_ID & "',"
        sql$ = sql$ & " '" & GLO_LOCAL_IP & "')"
        
        DB_User.Execute sql$, RecordsAffected
        
        If RecordsAffected = 0 Then
            MsgBox "Box Count error ", vbExclamation, "Error!!"
            
            MKT_LABEL_SEQ = 0
            Exit Function
        End If
    Else
        LotSeq = SSDATA.Fields(0) + 1
            
        sql$ = "update MKT_LABEL_SEQ set "
        sql$ = sql$ & "lot_seq = '" & LotSeq & "' "
        sql$ = sql$ & "where wwcustom_cd = '" & wwcustomCD & "'"
        sql$ = sql$ & "and   custom_cd = '" & customCD & "' "
        sql$ = sql$ & "and   lot_No = '" & LotNo & "'"
        sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
        sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
        DB_User.Execute sql$, RecordsAffected
    
        If RecordsAffected = 0 Then
            MsgBox "Box Count error ", vbExclamation, "Error!!"
            
            MKT_LABEL_SEQ = 0
            Exit Function
        End If
    End If
    SSDATA.Close
                    
    MKT_LABEL_SEQ = LotSeq
End Function

Private Function CHECK_INPUT_DATA(varPartNo As String, varRevNo As String, varLotNo As String) As Boolean
    ' Lot No/Part No/RevÀÌ ¸ðµÎ ÀÔ·ÂµÈ °æ¿ì ÇØ´ç °ªÀÌ ÀÏÄ¡ÇÏ´ÂÁö È®ÀÎ
    ' 3°³ ¸ðµÎ ÀÔ·ÂµÇ°í ÀÏÄ¡ÇÏ¸é, True
    ' 3°³ ¸ðµÎ ÀÔ·ÂµÇ°í, °ªÀÌ ÀÏÄ¡ÇÏÁö ¾ÊÀ»¶§´Â False
    ' 2005. 11. 3 requested ±è¿µÈ£, programed hklee
    Dim sql         As String
    Dim ssTemp      As New ADODB.Recordset
    Dim i           As Integer
    
    On Error GoTo ERROR_RTN
    
    CHECK_INPUT_DATA = True
    If varPartNo = "" Then Exit Function
    If varRevNo = "" Then Exit Function
    If varLotNo = "" Then Exit Function
      
    CHECK_INPUT_DATA = False

    sql$ = " select distinct a.outlot_no, a.iPART_NO, a.prev_no, a.prod_cd, a.prod_gubun " & vbCrLf
    sql$ = sql$ & " from PRD_WORK_11 a " & vbCrLf
    sql$ = sql$ & " where a.outlot_no ='" & Replace(varLotNo, "-", "") & "' " & vbCrLf
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    sql$ = sql$ & " Union " & vbCrLf
    sql$ = sql$ & " select distinct lot_no as outlot_no, ipart_no, prev_no, prod_cd, " & vbCrLf
    sql$ = sql$ & " nvl((select distinct f.prod_gubun from PRD_MAST_1 f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and f.prod_cd = a.prod_cd), ' ') prod_gubun " & vbCrLf
    sql$ = sql$ & " From CIM_MACHI_LOT_INFO a " & vbCrLf
    sql$ = sql$ & " where lot_no = '" & Replace(varLotNo, "-", "") & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf

    Set ssTemp = Nothing
    ssTemp.Open sql$, DB_User

    If ssTemp.RecordCount = 0 Then
        ssTemp.Close
        GoTo ERROR_RTN
    End If

    For i = 0 To ssTemp.RecordCount - 1
        If varPartNo = ssTemp!ipart_no And varRevNo = ssTemp!Prev_No Then
            CHECK_INPUT_DATA = True
            Exit For
        End If

        ssTemp.MoveNext
    Next i
    ssTemp.Close
        
    Exit Function
    
ERROR_RTN:
    CHECK_INPUT_DATA = False
    MsgBox IIf(GLO_KOR_VISIBLE, "Lot#ÀÇ ÀÔ·ÂÀÌ Part No, Rev°ú ¸ÂÁö ¾Ê½À´Ï´Ù." & vbCrLf & "Lot#, Part No, RevÀ» È®ÀÎÇÏ½Ã±â ¹Ù¶ø´Ï´Ù.", _
                                "Lot# is not correct with Part No&Rev." & vbCrLf & "Check Lot#, Part No, Rev.")
End Function

Private Sub CMD_SAVE_GotFocus()
    Call FIELD_VERIFY
End Sub

Private Sub Form_Load()
    Dim sIniFile    As String
    Dim sql         As String

    Screen.MousePointer = 11
    
    Top = 1000 '(Screen.Height - Me.Height) / 3
    Left = 3000 '(Screen.Width - Me.Width) / 2
    Call Gs_Form_Caption(Me)
    Call Form_Control_Search
    
    Call PORT_OPEN

    PRT_OP(1).Value = True
    Call PRT_OP_GotFocus(1)
    
    ' Shipping Date Ç¥½Ã
    SHIP_DATE = Format(Curr_Date, "&&&&-&&-&&")
    
    Call Field_Clear
    C_PO_NO.Clear
    C_INV_NO.Clear
    CT_PRINT_CHK.Value = 1
    
    Timer1.Enabled = False
    Label_Cnt = 0
    D_TOT_LABEL_CNT = Format(Label_Cnt, "#,##0")
    ReDim Label_Data(3000)
    
    '==================================
    ' AMD Shipping Label
    '==================================
    Label1(15).Visible = False
    Label1(16).Visible = False
    I_TOTAL_WEIGHT.Visible = False
    I_PCNT_NO.Visible = False
    I_SET_QT = 1
    CMD_PRINT.Enabled = False
    Label1(22).Visible = False
    C_LOT_ID.Visible = False
    
    'GLO_COMP_CO = IIf(GLO_COMP_CD = "FU", "MADE IN TAIWAN", "MADE IN KOREA")    'Country of Original º¯°æ
    
    Title.Caption = IIf(GLO_KOR_VISIBLE, "BARCODE LABEL Ãâ·Â", "BARCODE LABEL PRINT")
    FramePRT.Caption = IIf(GLO_KOR_VISIBLE, "Ãâ·Â±¸ºÐ", "Print Sort")
    FrameForm.Caption = IIf(GLO_KOR_VISIBLE, "Ãâ·Â¾ç½Ä", "Print Form")
    PRT_OP(0).Caption = IIf(GLO_KOR_VISIBLE, "±¹³»", "Dome..")
    PRT_OP(1).Caption = IIf(GLO_KOR_VISIBLE, "±¹¿Ü", "Fore..")
    CMD_CLEAR.Text = IIf(GLO_KOR_VISIBLE, "ÃÊ±âÈ­", "Initialize")
    CMD_SAVE.Text = IIf(GLO_KOR_VISIBLE, "Label³»¿ë ÀúÀå", "Save Label")
    CMD_PRINT.Text = IIf(GLO_KOR_VISIBLE, "LABEL ³»¿ª ÀÏ°ý Ãâ·Â", "Label Batch Print")
    Label1(17) = IIf(GLO_KOR_VISIBLE, "", "Label Q'ty")
    
    If GLO_DEPT_CD = "10011" Then   'ÇöÀç´Â IT Center¸¸ LanTypeÀ¸·Î ÁøÇà°¡´É (Å×½ºÆ®¶óº§ Ãâ·Â ¿ëµµ)
        ChkLANPRT.Visible = True
        ChkLANPRT.Value = 0
    Else
        ChkLANPRT.Visible = False
        ChkLANPRT.Value = 0
    End If
        
    Screen.MousePointer = 0
End Sub

Private Sub Form_Unload(Cancel As Integer)
    Call PORT_CLOSE
    Call GF_SocketClose(Lantype_Sck)
End Sub

Private Sub I_TOTAL_CT_NO_GotFocus()
    Call FIELD_VERIFY
End Sub

Private Sub C_LOT_NO_GotFocus()
    Call FIELD_VERIFY
End Sub

Private Sub C_LOT_NO_KeyPress(KeyAscii As Integer)
    KeyAscii = Asc(UCase(Chr(KeyAscii)))
End Sub

Private Sub C_LOT_NO_LostFocus()
    Dim sql     As String
        
    ' ÀÔ·ÂÇÑ Lot#¸¦ ÀÌ¿ë Part#, RevÀ» Check ÇÑ´Ù.
    If CHECK_INPUT_DATA(I_PART_NO, I_REV_NO, C_LOT_NO) = False Then
        C_LOT_NO = ""
        MsgBox IIf(GLO_KOR_VISIBLE, "Lot#ÀÇ ÀÔ·ÂÀÌ Part No, Rev°ú ¸ÂÁö ¾Ê½À´Ï´Ù." & vbCrLf & "Lot#, Part No, RevÀ» È®ÀÎÇÏ½Ã±â ¹Ù¶ø´Ï´Ù.", _
                                    "Lot# is not correct with Part No&Rev." & vbCrLf & "Check Lot#, Part No, Rev.")
        Exit Sub
    End If
        
    C_LOT_ID.ListIndex = C_LOT_NO.ListIndex 'LOT-ID ¸ÂÃçÁÖ±â
    C_LOT_ID.Enabled = False
    
    strLotNo = cDll.Gf_UnFormat("M", C_LOT_NO)
    Call ComboLoad_PO_NO
End Sub

Private Sub ComboLoad_PO_NO()
    Dim sql         As String
    Dim ssTemp      As New ADODB.Recordset
    
    ' Customer¸¦ Ship To ±âÁØ¿¡¼­ From±âÁØÀ» º¯°æÇÔ.(2002/10/2)
    ' ¿¹¸¦ µé¾î AMD¿¡¼­ OrderÇÑÈÄ AMKOR·Î Shipping ÇÏ´õ¶óµµ AMD·Î Label Print ÇÑ´Ù. (2003. 7. 23 by hkle, hyjang)
    If CHK_INSMP.Value = 1 Then
        sql$ = " select a.insmp_po_no po_no from MKT_ORD_1 a "
        sql$ = sql$ & " where insmp_custom_cd = '" + Trim(Right(C_CUSTOM_CD, 10)) + "'"
    Else
        sql$ = " select a.po_no from MKT_ORD_1 a "
        sql$ = sql$ & " where custom_cd = '" + Trim(Right(C_CUSTOM_CD, 10)) + "'"
    End If
    sql$ = sql$ & " and   comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and   bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    sql$ = sql$ & " and   order_no in (select b.order_no from MKT_OUT_1 b, MKT_OUT_11 c "
    sql$ = sql$ & "                    where c.outorder_no = b.outorder_no "
    If C_LOT_ID.Visible = True And C_LOT_ID <> "" Then
        If Trim(Right(C_CUSTOM_CD, 10)) = "20289" Or Trim(Right(C_CUSTOM_CD, 10)) = "21311" Then 'SPIL TW (outorder_no)
            sql$ = sql$ & "             and c.outorder_no = '" & C_LOT_ID & "'"
        Else 'custom_line_cd
            sql$ = sql$ & "             and c.custom_line_cd = '" & C_LOT_ID & "'"
        End If
    End If
    sql$ = sql$ & "                    and   b.comp_cd = c.comp_cd and b.bsns_cd = c.bsns_cd "
    sql$ = sql$ & "                    and   c.outlot_no = '" + strLotNo + "' and b.output_dt = '" & Format(SHIP_DATE, "yyyymmdd") & "') "
            
    Set ssTemp = Nothing
    ssTemp.Open sql$, DB_User
    
    With C_PO_NO
        .Clear
        If ssTemp.RecordCount = 0 Then
            ssTemp.Close
            .ListIndex = -1
        Else
            Do Until ssTemp.EOF
                .AddItem Trim(ssTemp!po_no)
                ssTemp.MoveNext
            Loop
            ssTemp.Close
            .ListIndex = 0
        End If
    End With
    
End Sub

Private Sub I_PART_NO_LostFocus()
    Dim sql         As String
    
    ' ÀÔ·ÂÇÑ Part#¸¦ ÀÌ¿ë Lot#, RevÀ» Check ÇÑ´Ù.
    I_PART_NO = Trim(I_PART_NO)
    If I_PART_NO = "" Then Exit Sub
    
    sql$ = "select * from PRD_MAST_1_VIEW "
    sql$ = sql$ + " where ipart_no = '" + I_PART_NO + "' "
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User

    If SSDATA.RecordCount = 0 Then
        SSDATA.Close
        Msg = GLO_MSGLINE(6)
        MsgBox IIf(GLO_KOR_VISIBLE, "µî·ÏµÈ ÄÚµå°¡ ¾Æ´Õ´Ï´Ù. ´Ù½Ã È®ÀÎÇÏ½Ê½Ã¿ä", "It is not registered code. Check it again.")
        Field_Check_SW = False
        Exit Sub
    End If
    SSDATA.Close
    
    If CHECK_INPUT_DATA(I_PART_NO, I_REV_NO, C_LOT_NO) = False Then
        I_PART_NO = ""
        MsgBox IIf(GLO_KOR_VISIBLE, "Lot#ÀÇ ÀÔ·ÂÀÌ Part No, Rev°ú ¸ÂÁö ¾Ê½À´Ï´Ù." & vbCrLf & "Lot#, Part No, RevÀ» È®ÀÎÇÏ½Ã±â ¹Ù¶ø´Ï´Ù.", _
                                    "Lot# is not correct with Part No&Rev." & vbCrLf & "Check Lot#, Part No, Rev.")
        Exit Sub
    End If
End Sub

Private Sub I_REV_NO_GotFocus()
    Call FIELD_VERIFY
End Sub

Private Sub I_REV_NO_KeyPress(KeyAscii As Integer)
    KeyAscii = Asc(UCase(Chr(KeyAscii)))
End Sub

Private Sub I_TOTAL_WEIGHT_LostFocus()
    I_TOTAL_WEIGHT = Trim(I_TOTAL_WEIGHT)
End Sub

Private Sub PRT_FORM_Click(Index As Integer)
    If Index = 1 Then   'Inner Label ¼±ÅÃ½Ã
        Label1(24).Visible = True
        I_BUNDLE_QT.Visible = True
        I_BUNDLE_QT.BackColor = &HC0FFFF
        I_BUNDLE_QT.Enabled = True
        I_BUNDLE_QT.Text = "2"  '±âº» Bundle ¼ö·® (¿µ¾÷¿äÃ»»çÇ×)
        If (Trim(Right(C_CUSTOM_CD, 5)) = "10426" Or Trim(Right(C_CUSTOM_CD, 5)) = "10005") And Trim(Right(D_PROD_KB, 10)) = "TR" Then I_SET_QT = "3" 'SCK TrayÀÇ °æ¿ì ¼ÂÆ®¼ö·®À» ±âº» 3À¸·Î ÁöÁ¤ DS_YHKIM ¿äÃ» »çÇ×
    Else
        Label1(24).Visible = False
        I_BUNDLE_QT.Visible = False
        I_BUNDLE_QT.Text = "0"
    End If
End Sub

Private Sub PRT_OP_Click(Index As Integer)
    Call PRT_OP_GotFocus(Index)
End Sub

Private Sub PRT_OP_GotFocus(Index As Integer)
    Dim sql         As String
    Dim ssTemp      As New ADODB.Recordset
    
    Call CMD_CLEAR_Click
    
    If Index = 0 Then
        PRT_OP(0).Value = True
        I_SET_QT = 1

        sql$ = "select custom_cd, custom_en  custom_nm, custom_eyn custom_yn "
        sql$ = sql$ & " from MKT_CUST_1 a"
        sql$ = sql$ & " where a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
        sql$ = sql$ & " and   a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        'sql$ = sql$ & " and   cust_sal = '11' "
        sql$ = sql$ & " and   a.nation_kb in (select g.cp_nation_kb from SYS_COMPANY_1 g where g.comp_cd = a.comp_cd and g.bsns_cd = a.bsns_cd)" & vbCrLf
        sql$ = sql$ & " order by custom_yn "
    Else
        PRT_OP(1).Value = True
        I_SET_QT = 1
         
        sql$ = "select custom_cd, custom_en custom_nm, custom_eyn custom_yn "
        sql$ = sql$ & " from MKT_CUST_1 a"
        sql$ = sql$ & " where a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
        sql$ = sql$ & " and   a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        'sql$ = sql$ & " and   cust_sal = '12' "
        sql$ = sql$ & " and   a.nation_kb not in (select g.cp_nation_kb from SYS_COMPANY_1 g where g.comp_cd = a.comp_cd and g.bsns_cd = a.bsns_cd)" & vbCrLf
        sql$ = sql$ & " order by custom_yn "
    End If

    Set ssTemp = Nothing
    ssTemp.Open sql$, DB_User

    With C_CUSTOM_CD
        .Clear
        If ssTemp.RecordCount > 0 Then
            Do Until ssTemp.EOF
                .AddItem Trim(ssTemp!custom_yn) + Space(60 - Len(Trim(ssTemp!custom_yn))) + Trim(ssTemp!custom_nm) + Space(40) + ssTemp!custom_cd
                ssTemp.MoveNext
            Loop
            .ListIndex = 0
        End If
        ssTemp.Close
    End With

End Sub

Private Function LABEL_DB_SAVE()
    Dim sql             As String
    Dim RecordsAffected As Integer
    
    On Error GoTo ERROR_RTN
    
    LABEL_DB_SAVE = True
    
    sql$ = " select * from MAT_LABEL_2 "
    sql$ = sql$ & " where custom_cd = '" & Trim(Right(C_CUSTOM_CD, 5)) & "' "
    sql$ = sql$ & " and   invoice_no = '" & C_INV_NO & "' "
    sql$ = sql$ & " and   outlot_no = '" & C_LOT_NO & "' "
    sql$ = sql$ & " and   po_no = '" & C_PO_NO & "' "
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    
    Set SSCODE = Nothing
    SSCODE.Open sql$, DB_User

    If SSCODE.RecordCount = 0 Then
        sql$ = "Insert into MAT_LABEL_2 (comp_cd, bsns_cd, custom_cd, invoice_no, outlot_no, po_no, item_no, iPART_NO, prev_no, "
        sql$ = sql$ & " item_nm, inbox_qty,  total_kg, pkg_count, print_dt, emp_no)"
        sql$ = sql$ & "  values (" & vbCrLf
        sql$ = sql$ & " '" & GLO_COMP_CD & "', "                 'comp_cd
        sql$ = sql$ & " '" & GLO_BSNS_CD & "', "                   'bsns_cd
        sql$ = sql$ & " '" & Trim(Right(C_CUSTOM_CD, 5)) & "', "
        sql$ = sql$ & " '" & C_INV_NO & "', "
        sql$ = sql$ & " '" & C_LOT_NO & "',"
        sql$ = sql$ & " '" & C_PO_NO & "', "
        sql$ = sql$ & " '" & C_ITEM_NO & "', "
        sql$ = sql$ & " '" & I_PART_NO & "',"
        sql$ = sql$ & " '" & I_REV_NO & "', "
        sql$ = sql$ & " '" & I_DESC_NM & "', "
        sql$ = sql$ & " " & Val(I_BOXUNIT_NB) & ","
        sql$ = sql$ & " " & Val(I_TOTAL_WEIGHT) & ", " & Val(I_PCNT_NO) & ", "
        sql$ = sql$ & " Getdate(), "
        sql$ = sql$ & " '" & GLO_USER_ID & "') "
    
        DB_User.Execute sql$, RecordsAffected
        If RecordsAffected = 0 Then
            GoTo ERROR_RTN
        End If
    
    Else
        sql$ = " update MAT_LABEL_2 set "
        sql$ = sql$ & " inbox_qty = " & Val(I_BOXUNIT_NB) & ", "
        sql$ = sql$ & " total_kg = " & Val(I_TOTAL_WEIGHT) & ", "
        sql$ = sql$ & " pkg_count = " & Val(I_PCNT_NO) & "  "
        sql$ = sql$ & " where custom_cd = '" & Trim(Right(C_CUSTOM_CD, 5)) & "' "
        sql$ = sql$ & " and   invoice_no = '" & C_INV_NO & "' "
        sql$ = sql$ & " and   outlot_no = '" & C_LOT_NO & "' "
        sql$ = sql$ & " and   po_no = '" & C_PO_NO & "' "
        sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
        sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
        DB_User.Execute sql$, RecordsAffected
        If RecordsAffected = 0 Then
            GoTo ERROR_RTN
        End If
    End If
    SSCODE.Close
    
    Exit Function
    
ERROR_RTN:
    LABEL_DB_SAVE = False

End Function

Private Sub PRT_SET_Click(Index As Integer)
    Call PORT_CLOSE
    Select Case Index
    Case 0  'LPT
    Case 1  'Com 1 Port
        Call PORT_OPEN(1)
    Case 2  'Com 3 Port
        Call PORT_OPEN(3)
    End Select
End Sub

Private Sub SHIP_DATE_Change()
    'Call Field_Clear
    Call C_CUSTOM_CD_LostFocus
End Sub

'=============> Label Case
Private Sub T4_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2011. 12. 21
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' ±âº»¶óº§Çü½Ä (STD)
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim charRowAdd(5 To 48)     As Integer
    Dim varDWG_no               As String
    Dim varCUSTDWG_no        As String
    Dim varPrdITEM_no           As String
    
    varLotNo = C_LOT_NO

    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ, Drawing No È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no, nvl(a.cust_dwg_no,' ') as cust_dwg_no," & vbCrLf
    sql$ = sql$ & " (select distinct nvl(item_no, ' ') item_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO) as prd_item_no, " & vbCrLf
    sql$ = sql$ & " (select distinct nvl(dwg_no, ' ') dwg_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO) as dwg_no" & vbCrLf
    sql$ = sql$ & " from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    varDWG_no = ""
    varCUSTDWG_no = ""
    varPrdITEM_no = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
        varDWG_no = SSDATA!dwg_no
        varPrdITEM_no = SSDATA!prd_item_no
        varCUSTDWG_no = SSDATA!cust_dwg_no
    End If
    SSDATA.Close

    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If
    
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:


    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0850" + "0030" + "l" + "0980" + "0007" + vbCr
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
   
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0850"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'CUST'R
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0980"
    sFormatTx = sFormatTx + "CUST'R" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0730"
    sFormatTx = sFormatTx + ": " + Trim(Left(C_CUSTOM_CD, 30)) + vbCr
    
   'CUST'R PO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0240" + "0980"
    sFormatTx = sFormatTx + "CUST'R PO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0240" + "0730"
    sFormatTx = sFormatTx + ": " + C_PO_NO + vbCr

    'CUST'R P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0310" + "0980"
    sFormatTx = sFormatTx + "CUST'R P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0310" + "0730"
    sFormatTx = sFormatTx + ": " + C_ITEM_NO + vbCr
    
    'PEAK P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0380" + "0980"
    sFormatTx = sFormatTx + "PEAK P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "0730"
    sFormatTx = sFormatTx + ": " + varOEMiPART_NO + vbCr ' I_PART_NO + vbCr
    
    'PEAK DWG#, PEAK DESC.
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0450" + "0980"
    sFormatTx = sFormatTx + "PEAK DESC." + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0450" + "0730"
    sFormatTx = sFormatTx + ": " + sText1 + vbCr
    
    'DWG REV#
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0520" + "0980"
    sFormatTx = sFormatTx + "DWG REV#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0520" + "0730"
    sFormatTx = sFormatTx + ": " + varOEMiRev_NO + vbCr
    
    If Trim(Right(C_CUSTOM_CD, 10)) = "20301" Or Trim(Right(C_CUSTOM_CD, 10)) = "21458" Then  'ATTÀÇ °æ¿ì DWG NO# Ãß°¡ by FRC jeenie & Liam / 2019.04.08 add Jim
        'DWG NO#
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0590" + "0980"
        sFormatTx = sFormatTx + "DWG NO#" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0590" + "0730"
        sFormatTx = sFormatTx + ": " + varCUSTDWG_no + vbCr  '2019.08.14 request by Liam  varPrdITEM_no >> varCUSTDWG_no
    
        'SHIP'G LOT NO
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0660" + "0980"
        sFormatTx = sFormatTx + "SHIP'G LOT NO" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0660" + "0730"
        sFormatTx = sFormatTx + ": " + C_PO_NO + "-" + Format(SHIP_DATE, "mmddyy") + vbCr
        
        'QTY
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0730" + "0980"
        sFormatTx = sFormatTx + "QTY" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0730" + "0730"
        sFormatTx = sFormatTx + ": " + varUnitQty + vbCr
        
        'COO
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0840" + "0980"
        sFormatTx = sFormatTx + "COO" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0840" + "0730"
        sFormatTx = sFormatTx + ": " + GLO_COMP_CO + vbCr
    Else
        'SHIP'G LOT NO
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0590" + "0980"
        sFormatTx = sFormatTx + "SHIP'G LOT NO" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0590" + "0730"
        sFormatTx = sFormatTx + ": " + C_PO_NO + "-" + Format(SHIP_DATE, "mmddyy") + vbCr
        
        'QTY
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0660" + "0980"
        sFormatTx = sFormatTx + "QTY" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0660" + "0730"
        sFormatTx = sFormatTx + ": " + varUnitQty + vbCr
        
        If Trim(Right(C_CUSTOM_CD, 10)) = "21022" And varEndwwc_CD = "21355" Then  '2020.07.22 by CPL Orim ENDWWC_CD°¡ KYOCERA ÀÎ°æ¿ì¸¸ END CUST PO¸¦ Ãâ·Â
            sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0730" + "0980"
            sFormatTx = sFormatTx + "KST PO#" + vbCr
            sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0730" + "0730"
            sFormatTx = sFormatTx + ": " + Trim(C_LOT_ID) + vbCr
        End If
                
        If GLO_COMP_CD <> "FU" Then '2018.05.09 Jeenie & Liam ¿äÃ»À¸·Î Ç¥ÁØ¶óº§¿¡¼­ COO Ç×¸ñÀ» Á¦¿ÜÇÑ´Ù.
            sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0840" + "0980"
            sFormatTx = sFormatTx + "COO" + vbCr
            sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0840" + "0730"
            sFormatTx = sFormatTx + ": " + GLO_COMP_CO + vbCr
        End If
    End If
    
    If Trim(Right(C_CUSTOM_CD, 10)) = "22208" Then  'SILICON EXCEED by 2022.08.25 CPL sy.lee
        sFormatTx = sFormatTx + "1X11" + "000" + "0230" + "0140" + "C" + "001" + "0001" + "0070" + vbCr   'Circle ±×¸®±â (¿ø±×¸®±â)
        sFormatTx = sFormatTx + Angle180 + "911" + "S01" + "0250" + "0200" + "P018P013" + "RoHS" + vbCr
    End If

    'C/NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0920" + "0980"
    sFormatTx = sFormatTx + "C/NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0920" + "0730"
    sFormatTx = sFormatTx + ": " & varCartonNo & vbCr
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub TR_KYEC_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2014. 10. 20
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' ±âº»¶óº§Çü½Ä+EXPIRE DATE ÃâÇÏÀÏ·ÎºÎÅÍ 3³â
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    Dim yyyy                    As String
    Dim MM                      As String
    Dim dd                      As String
    
    Dim charRowAdd(5 To 48)     As Integer
    
    varLotNo = C_LOT_NO
        
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    'EXP DATE (Ship ´çÀÏ ³¯Â¥ + 3³â) << ÃâÇÏÀÏ ±âÁØÀ¸·Î »ý¼º¿äÃ» SNG_Kimsi
    varEXPDT = GF_GET_EXPDATE(GLO_COMP_CD, GLO_BSNS_CD, Trim(SHIP_DATE), Trim(Right(C_CUSTOM_CD, 5)), Trim(I_PART_NO), Trim(I_REV_NO), IIf(C_ITEM_NO = "", " ", C_ITEM_NO), Trim(Right(D_PROD_KB, 10)), , , Format(SHIP_DATE, "yyyy-mm-dd"))
    yyyy = Left(varEXPDT, 4)
    MM = Mid(varEXPDT, 6, 2)
    dd = Right(varEXPDT, 2)
    varEXPDT = MM & "/" & dd & "/" & yyyy

    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
        
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If

    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ
    '===========================================================================

    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close

    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If

'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:


    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0850" + "0030" + "l" + "0980" + "0007" + vbCr
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
   
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0850"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'CUST'R
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0980"
    sFormatTx = sFormatTx + "CUST'R" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0730"
    sFormatTx = sFormatTx + ": " + Trim(Left(C_CUSTOM_CD, 30)) + vbCr
    
   'CUST'R PO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0240" + "0980"
    sFormatTx = sFormatTx + "CUST'R PO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0240" + "0730"
    sFormatTx = sFormatTx + ": " + C_PO_NO + vbCr

    'CUST'R P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0310" + "0980"
    sFormatTx = sFormatTx + "CUST'R P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0310" + "0730"
    sFormatTx = sFormatTx + ": " + C_ITEM_NO + vbCr
    
    'PEAK P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0380" + "0980"
    sFormatTx = sFormatTx + "PEAK P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "0730"
    sFormatTx = sFormatTx + ": " + varOEMiPART_NO + vbCr ' I_PART_NO + vbCr
    
    'PEAK DWG#
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0450" + "0980"
    sFormatTx = sFormatTx + "PEAK DWG#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0450" + "0730"
    sFormatTx = sFormatTx + ": " + sText1 + vbCr
    
    'DWG REV#
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0520" + "0980"
    sFormatTx = sFormatTx + "DWG REV#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0520" + "0730"
    sFormatTx = sFormatTx + ": " + varOEMiRev_NO + vbCr
    
    'SHIP'G LOT NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0590" + "0980"
    sFormatTx = sFormatTx + "SHIP'G LOT NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0590" + "0730"
    sFormatTx = sFormatTx + ": " + C_PO_NO + "-" + Format(SHIP_DATE, "mmddyy") + vbCr
    
    'EXPIRE DATE (MM/DD/YYYY)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0660" + "0980"
    sFormatTx = sFormatTx + "EXPIRE DATE" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0660" + "0730"
    sFormatTx = sFormatTx + ": " + varEXPDT + vbCr
    
    'QTY
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0730" + "0980"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0730" + "0730"
    sFormatTx = sFormatTx + ": " + varUnitQty + vbCr
    
    '¿©¹é
    
    'COO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0840" + "0980"
    sFormatTx = sFormatTx + "COO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0840" + "0730"
    sFormatTx = sFormatTx + ": " + GLO_COMP_CO + vbCr
    
    'C/NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0920" + "0980"
    sFormatTx = sFormatTx + "C/NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0920" + "0730"
    sFormatTx = sFormatTx + ": " & varCartonNo & vbCr
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub TR_NANYA_InnerLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2014.04.24 / INNERLABEL
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim varSizeNm               As String   'Size
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    Dim varMatrNM             As String
    Dim yyyy                    As String
    Dim MM                      As String
    Dim dd                      As String
    
    Dim charRowAdd(5 To 48)     As Integer
    
    varLotNo = C_LOT_NO
            
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    varEXPDT = GF_GET_EXPDATE(GLO_COMP_CD, GLO_BSNS_CD, varMFGDT, Trim(Right(C_CUSTOM_CD, 5)), Trim(I_PART_NO), Trim(I_REV_NO), IIf(C_ITEM_NO = "", " ", C_ITEM_NO), Trim(Right(D_PROD_KB, 10)), , , Format(SHIP_DATE, "yyyy-mm-dd"))
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    If varUnitQty Mod Val(I_BUNDLE_QT) <> 0 Or Trim(I_BUNDLE_QT) = 0 Or Trim(I_BUNDLE_QT) = "" Then
        MsgBox "Bundle ¼ö·®À» ÀçÈ®ÀÎÇÏ¼¼¿ä.", vbExclamation
        I_BUNDLE_QT.SetFocus
        Exit Sub
    Else
        varUnitQty = IIf(PRT_FORM(1).Value = True, varUnitQty \ Val(I_BUNDLE_QT), varUnitQty)   'I_BOX_UNIT_QT¸¦ Bundle ¼ö·®¸¸Å­ ³ª´«´Ù. (Á¤¼ö·Î Ç¥½Ã)
    End If
        
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    
    '============Material Force PP13 into MPPO Jim Chen 2018/10/05 Request by PEAK KH Claire
    varMatrNM = IIf(GLO_COMP_CD = "FU" And Trim(I_METERIAL_NM) = "PP13", "MPPO", I_METERIAL_NM)
    
    '---------------------------------------------------------------------------
    ' Size Á¤º¸¸¦ °¡Á®¿È
    '---------------------------------------------------------------------------
    sql$ = "select distinct nvl(psize_nm, ' ') psize_nm from PRD_MAST_2 " & vbCr
    sql$ = sql$ + " where iPART_NO = '" & I_PART_NO & "' " & vbCr
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf

    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varSizeNm = Trim(SSDATA!PSIZE_NM)
    SSDATA.Close
    '---------------------------------------------------------------------------

    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close

    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If

'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:


    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0850" + "0030" + "l" + "0980" + "0007" + vbCr
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
   
    '2D BARCODE(QR CODE)   'aW a=3Àº 180µµÈ¸Àü  ffff ³ôÀ»¼ö·Ï ¾Æ·¡ gggg ³ôÀ»¼ö·Ï ¿ÞÂÊÀ¸·Î
    sFormatTx = sFormatTx & "3W1D44000052003502MA," & "PEAK" & "," & Trim(C_ITEM_NO) & "," & varSizeNm & "," & varMatrNM & "," & Left(Replace(varMFGDT, "-", ""), 6) & "," & Left(Replace(varEXPDT, "-", ""), 6) & "," & varLotNo & "," & IIf(GLO_COMP_CD = "FU", sText1, varOEMiPART_NO) & "," & varUnitQty & Chr$(13)
   
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0920"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'Supplier Name
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0980"
    sFormatTx = sFormatTx + "Supplier Name" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0730"
    sFormatTx = sFormatTx + ": " + "PEAK" + vbCr
    
   'Part No
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0240" + "0980"
    sFormatTx = sFormatTx + "Part No" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0240" + "0730"
    sFormatTx = sFormatTx + ": " + Trim(C_ITEM_NO) + vbCr

    'Size
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0310" + "0980"
    sFormatTx = sFormatTx + "Size" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0310" + "0730"
    sFormatTx = sFormatTx + ": " + varSizeNm + vbCr
           
    'Material
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0380" + "0980"
    sFormatTx = sFormatTx + "Material" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "0730"
    sFormatTx = sFormatTx + ": " + varMatrNM + vbCr  '
    
    'MFG Date (YYYYMM)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0450" + "0980"
    sFormatTx = sFormatTx + "MFG Date" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0450" + "0730"
    sFormatTx = sFormatTx + ": " + Left(Replace(varMFGDT, "-", ""), 6) + vbCr
    
    'EXP Date (YYYYMM)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0520" + "0980"
    sFormatTx = sFormatTx + "EXP Date" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0520" + "0730"
    sFormatTx = sFormatTx + ": " + Left(Replace(varEXPDT, "-", ""), 6) + vbCr
    
    'SLI No
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0590" + "0980"
    sFormatTx = sFormatTx + "SLI No" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0590" + "0730"
    sFormatTx = sFormatTx + ": " + varLotNo + vbCr
    
    'Quantity
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0660" + "0980"
    sFormatTx = sFormatTx + "Quantity" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0660" + "0730"
    sFormatTx = sFormatTx + ": " + varUnitQty + vbCr
       
    If GLO_COMP_CD = "FU" Then ' By CPL Liam's request 2019.08.13
        'DESC   sText1 = I_DESC_NM
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0730" + "0980"
        sFormatTx = sFormatTx + "Item" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0730" + "0730"
        sFormatTx = sFormatTx + ": " + sText1 + vbCr
     Else
        'P/N
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0730" + "0980"
        sFormatTx = sFormatTx + "P/N" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0730" + "0730"
        sFormatTx = sFormatTx + ": " + varOEMiPART_NO + vbCr
    End If
'    If CT_PRINT_CHK.Value = 1 Then 'NANYA C/T # Print Function requested by FRC CPL Liam    '2019.04.11
'        'C/NO
'        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0920" + "0980"
'        sFormatTx = sFormatTx + "C/NO" + vbCr
'        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0920" + "0730"
'        sFormatTx = sFormatTx + ": " & varCartonNo & vbCr
'    End If

    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub TR_NANYA_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2014.04.24 / BOXLABEL
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim varSizeNm               As String   'Size
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    Dim varMatrNM             As String
    Dim yyyy                    As String
    Dim MM                      As String
    Dim dd                      As String
    
    Dim charRowAdd(5 To 48)     As Integer
    
    varLotNo = C_LOT_NO
    
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    varEXPDT = GF_GET_EXPDATE(GLO_COMP_CD, GLO_BSNS_CD, varMFGDT, Trim(Right(C_CUSTOM_CD, 5)), Trim(I_PART_NO), Trim(I_REV_NO), IIf(C_ITEM_NO = "", " ", C_ITEM_NO), Trim(Right(D_PROD_KB, 10)), , , Format(SHIP_DATE, "yyyy-mm-dd"))
    
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
        
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    
    '============Material Force PP13 into MPPO Jim Chen 2018/10/05 Request by PEAK KH Claire
    varMatrNM = IIf(GLO_COMP_CD = "FU" And Trim(I_METERIAL_NM) = "PP13", "MPPO", I_METERIAL_NM)
    
    '---------------------------------------------------------------------------
    ' Size Á¤º¸¸¦ °¡Á®¿È
    '---------------------------------------------------------------------------
    sql$ = "select distinct nvl(psize_nm, ' ') psize_nm from PRD_MAST_2 " & vbCr
    sql$ = sql$ + " where iPART_NO = '" & I_PART_NO & "' " & vbCr
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf

    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varSizeNm = Trim(SSDATA!PSIZE_NM)
    SSDATA.Close
    '---------------------------------------------------------------------------

    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close

    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If

'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:


    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0850" + "0030" + "l" + "0980" + "0007" + vbCr
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
   
    '2D BARCODE(QR CODE)   'aW a=3Àº 180µµÈ¸Àü  ffff ³ôÀ»¼ö·Ï ¾Æ·¡ gggg ³ôÀ»¼ö·Ï ¿ÞÂÊÀ¸·Î
    sFormatTx = sFormatTx & "3W1D44000052003502MA," & "PEAK" & "," & Trim(C_ITEM_NO) & "," & varSizeNm & "," & varMatrNM & "," & Left(Replace(varMFGDT, "-", ""), 6) & "," & Left(Replace(varEXPDT, "-", ""), 6) & "," & varLotNo & "," & IIf(GLO_COMP_CD = "FU", sText1, varOEMiPART_NO) & "," & varUnitQty & Chr$(13)
   
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0920"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'Supplier Name
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0980"
    sFormatTx = sFormatTx + "Supplier Name" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0730"
    sFormatTx = sFormatTx + ": " + "PEAK" + vbCr
    
   'Part No
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0240" + "0980"
    sFormatTx = sFormatTx + "Part No" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0240" + "0730"
    sFormatTx = sFormatTx + ": " + Trim(C_ITEM_NO) + vbCr

    'Size
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0310" + "0980"
    sFormatTx = sFormatTx + "Size" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0310" + "0730"
    sFormatTx = sFormatTx + ": " + varSizeNm + vbCr
           
    'Material
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0380" + "0980"
    sFormatTx = sFormatTx + "Material" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "0730"
    sFormatTx = sFormatTx + ": " + varMatrNM + vbCr  '
    
    'MFG Date (YYYYMM)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0450" + "0980"
    sFormatTx = sFormatTx + "MFG Date" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0450" + "0730"
    sFormatTx = sFormatTx + ": " + Left(Replace(varMFGDT, "-", ""), 6) + vbCr
    
    'EXP Date (YYYYMM)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0520" + "0980"
    sFormatTx = sFormatTx + "EXP Date" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0520" + "0730"
    sFormatTx = sFormatTx + ": " + Left(Replace(varEXPDT, "-", ""), 6) + vbCr
    
    'SLI No
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0590" + "0980"
    sFormatTx = sFormatTx + "SLI No" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0590" + "0730"
    sFormatTx = sFormatTx + ": " + varLotNo + vbCr
    
    'Quantity
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0660" + "0980"
    sFormatTx = sFormatTx + "Quantity" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0660" + "0730"
    sFormatTx = sFormatTx + ": " + varUnitQty + vbCr
       
    If GLO_COMP_CD = "FU" Then ' By CPL Liam's request 2019.03.27
        'DESC   sText1 = I_DESC_NM
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0730" + "0980"
        sFormatTx = sFormatTx + "Item" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0730" + "0730"
        sFormatTx = sFormatTx + ": " + sText1 + vbCr
     Else
        'P/N
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0730" + "0980"
        sFormatTx = sFormatTx + "P/N" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0730" + "0730"
        sFormatTx = sFormatTx + ": " + varOEMiPART_NO + vbCr
    End If
       
    'C/NO
    If CT_PRINT_CHK.Value = 1 Then 'NANYA C/T # Print Function requested by FRC CPL Liam '2019.04.11
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0920" + "0980"
        sFormatTx = sFormatTx + "C/NO" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0920" + "0730"
        sFormatTx = sFormatTx + ": " & varCartonNo & vbCr
    End If
    sFormatTx = sFormatTx + "E" + vbCr
    
End Sub

Private Sub T4_ST_MALTA_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2011. 12. 21
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' ¾÷  Ã¼ : ST-Micro(Malta)
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim charRowAdd(5 To 48)     As Integer
    
    varLotNo = C_LOT_NO

    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    
    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close

    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion ratea
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:


    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0850" + "0030" + "l" + "0980" + "0007" + vbCr
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
   
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0850"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'CUST'R
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0980"
    sFormatTx = sFormatTx + "CUST'R" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0730"
    sFormatTx = sFormatTx + ": " + Trim(Left(C_CUSTOM_CD, 30)) + vbCr
    
   'CUST'R PO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0240" + "0980"
    sFormatTx = sFormatTx + "CUST'R PO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0240" + "0730"
    sFormatTx = sFormatTx + ": " + "CONSIGNMENT" + vbCr 'C_PO_NO + vbCr

    'CUST'R P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0310" + "0980"
    sFormatTx = sFormatTx + "CUST'R P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0310" + "0730"
    sFormatTx = sFormatTx + ": " + C_ITEM_NO + vbCr
    
    'PEAK P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0380" + "0980"
    sFormatTx = sFormatTx + "PEAK P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "0730"
    sFormatTx = sFormatTx + ": " + varOEMiPART_NO + vbCr ' I_PART_NO + vbCr
    
    'PEAK DWG#
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0450" + "0980"
    sFormatTx = sFormatTx + "PEAK DWG#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0450" + "0730"
    sFormatTx = sFormatTx + ": " + sText1 + vbCr
    
    'DWG REV#
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0520" + "0980"
    sFormatTx = sFormatTx + "DWG REV#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0520" + "0730"
    sFormatTx = sFormatTx + ": " + varOEMiRev_NO + vbCr
    
    'SHIP'G LOT NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0590" + "0980"
    sFormatTx = sFormatTx + "SHIP'G LOT NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0590" + "0730"
    sFormatTx = sFormatTx + ": " + "CONSIGNMENT" + "-" + Format(SHIP_DATE, "mmddyy") + vbCr
    
    '¿©¹é
    
    'COO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0840" + "0980"
    sFormatTx = sFormatTx + "COO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0840" + "0730"
    sFormatTx = sFormatTx + ": " + GLO_COMP_CO + vbCr
    
    'C/NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0920" + "0980"
    sFormatTx = sFormatTx + "C/NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0920" + "0730"
    sFormatTx = sFormatTx + ": " & varCartonNo & vbCr
    
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub T4_ASEK_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2013. 05. 07
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' SCK¿ë 2D BarCode (QR CODE)
    ' ¾÷  Ã¼ : SCK
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMMold_no           As String
    Dim varOEMiRev_NO           As String
    Dim yyyy                    As String
    Dim MM                      As String
    Dim dd                      As String
    
    Dim charRowAdd(5 To 48)     As Integer
    
    varLotNo = C_LOT_NO
    
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    varEXPDT = GF_GET_EXPDATE(GLO_COMP_CD, GLO_BSNS_CD, Trim(varMFGDT), Trim(Right(C_CUSTOM_CD, 5)), Trim(I_PART_NO), Trim(I_REV_NO), IIf(C_ITEM_NO = "", " ", C_ITEM_NO), Trim(Right(D_PROD_KB, 10)), , , Format(SHIP_DATE, "yyyy-mm-dd"))
        
    'EXPIRED DATE duration change from 5 years to 3 years By Jim Chen 2018.09.19 Requested by CPL Liam
    'varEXPDT = Replace(DateAdd("yyyy", IIf(GLO_COMP_CD = "FU", 3, 5), varMFGDT), "-", "")
    'varEXPDT = Replace(DateAdd("yyyy", 5, varMFGDT), "-", "")   '2018.10.24 FRC ¿äÃ»À¸·Î 5³â ÅëÀÏ
    varMFGDT = Replace(varMFGDT, "-", "")
    varEXPDT = Replace(varEXPDT, "-", "")
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    varLotNo = Replace(C_LOT_NO, "-", "")
    
    '===========================================================================
    ' Mold No
    '===========================================================================
    sql$ = "select nvl(a.SMP_MOLD_NO,' ') as SMP_MOLD_NO from PRD_SMP_1 a " & vbCrLf
    sql$ = sql$ & " where a.mold_no in (select distinct mold_no from PRD_MAST_1 f " & vbCrLf
    sql$ = sql$ & "                     where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and f.mold_desc = '" & Trim(varMoldNo) & "' and f.prev_no = a.rev_no and f.ipart_no = a.ipart_no and f.prod_cd = a.prod_cd)" & vbCrLf
    sql$ = sql$ & " and a.rev_no = '" & I_REV_NO & "' and a.ipart_no = '" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf

    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    If SSDATA.RecordCount > 0 Then
        varOEMMold_no = SSDATA!SMP_MOLD_NO
    End If
    SSDATA.Close
    
 'Assembly P-Bin Management and system will no write any main part information in Prd_work_31. Thus we need to get main part in Prd_BOM_1
    'FRC Jim Chen 2020/02/06
    If GLO_COMP_CD = "FU" Then
        If UCase(varMoldNo) = "ASSEMBLY" Then     'FRCUNIONÀº Add varOEMMold_no by jim
             sql$ = " select distinct a.prod_cd, a.mold_no, a.mold_desc " & vbCrLf
             sql$ = sql$ & " from PRD_MAST_1_VIEW a" & vbCrLf
             sql$ = sql$ & " where a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
             sql$ = sql$ & " and a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
             sql$ = sql$ & " and a.mold_no = (SELECT DISTINCT MASTER_MOLD_NO from PRD_WORK_1 where LOT_NO  ='" & Trim(C_LOT_NO) & "')" & vbCrLf
         
             Set SSDATA = Nothing
             SSDATA.Open sql$, DB_User
             
             If SSDATA.RecordCount = 0 Then
                 varOEMMold_no = ""
             Else
                 varOEMMold_no = str(Int(Right(Trim(SSDATA!mold_desc), 2)))
             End If
             SSDATA.Close
        ElseIf UCase(varMoldNo) = "" Then
            sql$ = " select distinct a.prod_cd, a.mold_no, a.mold_desc " & vbCrLf
            sql$ = sql$ & " from PRD_MAST_1_VIEW a" & vbCrLf
            sql$ = sql$ & " where a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
            sql$ = sql$ & " and a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
            sql$ = sql$ & " and a.prod_cd = (select child_cd from PRD_BOM_1 where parent_cd =(select distinct P_PROD_CD from prd_work_31 where LOT_NO ='" & Trim(C_LOT_NO) & "')" & vbCrLf
            sql$ = sql$ & "and child_cd like 'TR%')" & vbCrLf
    
             Set SSDATA = Nothing
             SSDATA.Open sql$, DB_User
             
             If SSDATA.RecordCount = 0 Then
                 varOEMMold_no = ""
             Else
                 varOEMMold_no = str(Int(Right(Trim(SSDATA!mold_desc), 2)))
             End If
             SSDATA.Close
        Else
             varOEMMold_no = str(Int(Right(Trim(varMoldNo), 2)))
        End If
    End If
        
    If (Trim(Right(C_CUSTOM_CD, 10)) = "20015" Or Trim(Right(C_CUSTOM_CD, 10)) = "20163") And isAgentPeak = True Then 'AgentPeak(±âÁ¸S+G)ÀÇ °æ¿ì ASE KHH ±ÝÇü ¹øÈ£ °íÁ¤
        varOEMMold_no = "S1"
    End If
    
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    
    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close
    
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:
    
    Dim varRate     As String
    varRate = "52"

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    
    ' °¡·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0010" + "l" + "0980" + "0004" + vbCr
    
    sFormatTx = sFormatTx + "1X11" + "000" + "0190" + "0010" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0010" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0430" + "0010" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0550" + "0010" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0670" + "0010" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0800" + "0010" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0880" + "0265" + "l" + "0980" + "0004" + vbCr

    '¼¼·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0010" + "0735" + "l" + "0004" + "0940" + vbCr
    'MOLD ¼¼·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0320" + "l" + "0004" + "0120" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0190" + "l" + "0004" + "0120" + vbCr
    'RT ¼¼·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0430" + "0510" + "l" + "0004" + "0120" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0430" + "0440" + "l" + "0004" + "0120" + vbCr
    'C/NO ¼¼·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0670" + "0400" + "l" + "0004" + "0130" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0670" + "0265" + "l" + "0004" + "0130" + vbCr
            
    'GRCode ¼¼·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0800" + "0265" + "l" + "0004" + "0150" + vbCr
                        
   'SUPPLIER
    sFormatTx = sFormatTx + Angle180 + "911" + "005" + "0080" + "1000"
    sFormatTx = sFormatTx + "SUPPLIER" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0710"
    sFormatTx = sFormatTx + "PEAK" + vbCr
        
   'MAT'L NAME  (°íÁ¤¹®±¸)
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "1000"
    sFormatTx = sFormatTx + "MAT'L NAME" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0710"
    sFormatTx = sFormatTx + "TRAY" + vbCr
    
   'CUST'R P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0260" + "1000"
    sFormatTx = sFormatTx + "P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0265" + "0710"   'Code 128 SubSET B
       sFormatTx = sFormatTx & "B" & C_ITEM_NO + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0305" + "0710"
    sFormatTx = sFormatTx + C_ITEM_NO + vbCr

    'LOT NO
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "1000"
    sFormatTx = sFormatTx + "LOT NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0385" + "0710"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & varLotNo & vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0425" + "0710"
    sFormatTx = sFormatTx & varLotNo & vbCr
    
    'Mold No
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "0317"
    sFormatTx = sFormatTx + "MOLD" + vbCr
    If GLO_COMP_CD = "FU" Then 'FRCUNIONÀº MOLD NO ¹ÙÄÚµå¸¦ Á¦¿ÜÇÑ´Ù. remove Mold Barcode by jim
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0425" + "0170"
        sFormatTx = sFormatTx & IIf(CHK_INSMP.Value = 1, Right(Trim(varOEMMold_no), 2), Right(Trim(varMoldNo), 2)) & vbCr
    Else
        sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0385" + "0170"   'Code 128 SubSET B
        sFormatTx = sFormatTx & "B" & Right(Trim(varOEMMold_no), 2) & vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0425" + "0170"
        sFormatTx = sFormatTx & Right(Trim(varOEMMold_no), 2) & vbCr
    End If
    
    'QTY
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0500" + "1000"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0505" + "0710"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & varUnitQty + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0545" + "0710"
    sFormatTx = sFormatTx + varUnitQty + vbCr
    
    'RT
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0500" + "0500"
    sFormatTx = sFormatTx + "RT" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0505" + "0420"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & Trim(C_LOT_ID) + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0545" + "0420"
    sFormatTx = sFormatTx + Trim(C_LOT_ID) + vbCr
    
    'EXP DATE
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0620" + "1000"
    sFormatTx = sFormatTx + "EXP DATE" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0625" + "0710"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & varEXPDT + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0665" + "0710"
    sFormatTx = sFormatTx + varEXPDT + vbCr
    
    'DOM    (YYYYMMdd) 'LOT »ý¼ºÀÏÀÚ
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0740" + "1000"
    sFormatTx = sFormatTx + "DOM" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0745" + "0710"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & varMFGDT + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0785" + "0710"
    sFormatTx = sFormatTx + varMFGDT + vbCr
    
    'C/T
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0740" + "0390"
    sFormatTx = sFormatTx + "C/NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0745" + "0245"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & varCartonNo & vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0785" + "0245"
    sFormatTx = sFormatTx & varCartonNo & vbCr
    
    'CUSTOMER  (Use fixed)
    sText1 = IIf(Trim(Right(C_CUSTOM_CD, 10)) = 20015, "ASEK", Trim(Left(C_CUSTOM_CD, 30)))  'ASE KHH (Use fixed)
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0860" + "1000"
    sFormatTx = sFormatTx + "CUSTOMER" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0860" + "0710"
    sFormatTx = sFormatTx & sText1 & vbCr   'trim(Left(C_CUSTOM_CD, 30))
    
    'PEAK P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0935" + "1000"
    sFormatTx = sFormatTx + "PEAK P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0935" + "0710"
    sFormatTx = sFormatTx & varOEMiPART_NO & vbCr 'I_PART_NO & vbCr
    
    '2D QR Code
    '2D BARCODE(QR CODE)   'aW a=3Àº 180µµÈ¸Àü  ffff ³ôÀ»¼ö·Ï ¾Æ·¡ gggg ³ôÀ»¼ö·Ï ¿ÞÂÊÀ¸·Î
    'QRÄÚµå´Â ¼ýÀÚ ÃÖ´ë 7089ÀÚ, ¹®ÀÚ(ASCII) ÃÖ´ë 4296ÀÚ, ÀÌÁø8ºñÆ® ÃÖ´ë 2953¹ÙÀÌÆ®, ÇÑÀÚµî ¾Æ½Ã¾Æ ¹®ÀÚ ÃÖ´ë 1817ÀÚ¸¦ ´ãÀ» ¼ö ÀÖ´Ù.
    sFormatTx = sFormatTx & "3W1D33000095002302MA," & C_ITEM_NO & ";" & Trim(C_LOT_ID) & ";" & varLotNo & ";" & varUnitQty & ";" & varEXPDT & ";" & varMFGDT & Chr$(13)
    
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub T4_ASECL_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2013. 05. 07
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' SCK¿ë 2D BarCode (QR CODE)
    ' ¾÷  Ã¼ : SCK
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMMold_no           As String
    Dim varOEMiRev_NO           As String
    Dim yyyy                    As String
    Dim MM                      As String
    Dim dd                      As String
    
    Dim charRowAdd(5 To 48)     As Integer
    
    varLotNo = C_LOT_NO
    
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    varEXPDT = GF_GET_EXPDATE(GLO_COMP_CD, GLO_BSNS_CD, Trim(varMFGDT), Trim(Right(C_CUSTOM_CD, 5)), Trim(I_PART_NO), Trim(I_REV_NO), IIf(C_ITEM_NO = "", " ", C_ITEM_NO), Trim(Right(D_PROD_KB, 10)), , , Format(SHIP_DATE, "yyyy-mm-dd"))
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    '===========================================================================
    ' Drawing No È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.SMP_MOLD_NO,' ') as SMP_MOLD_NO from PRD_SMP_1 a " & vbCrLf
    sql$ = sql$ & " where a.mold_no in (select distinct mold_no from PRD_MAST_1 f " & vbCrLf
    sql$ = sql$ & "                     where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and f.mold_desc = '" & Trim(varMoldNo) & "' and f.prev_no = a.rev_no and f.ipart_no = a.ipart_no and f.prod_cd = a.prod_cd)" & vbCrLf
    sql$ = sql$ & " and a.rev_no = '" & I_REV_NO & "' and a.ipart_no = '" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    If SSDATA.RecordCount > 0 Then
        varOEMMold_no = SSDATA!SMP_MOLD_NO
    End If
    SSDATA.Close
    
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    
    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close

'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:
    
    Dim varRate     As String
    varRate = "52"

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    If GLO_COMP_CD = "FU" Then  ''ASECL (20276) 2020-02-17 by FRC IT Jim Chen & CPL Liam Bae
       '2D BARCODE(Data Matrix)
        'a W b[b] c d eee ffff gggg hhh i jjj kkk ll¡¦l1 | W1 d 4 4 000 0010 0010This is the data portion
     
        ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
        '3W1C66000 0400 0980 0029 2000044044
        sFormatTx = sFormatTx & "3W1c66000" + "0400" + "0980" + "2000" + "044" + "044" & C_LOT_ID & "|" & C_ITEM_NO & "|" & C_LOT_NO & "|" & varUnitQty & "|" & Replace(Trim(varMFGDT), "-", "/") & "|" & varCartonNo & vbCr
            
       'RT NO
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0500" + "0980"
        sFormatTx = sFormatTx + "Batch NO:" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0500" + "0500"
        sFormatTx = sFormatTx + Trim(C_LOT_ID) + vbCr
        
       'CUST'R P/N
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0580" + "0980"
        sFormatTx = sFormatTx + "Part NO:" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0580" + "0500"
        sFormatTx = sFormatTx + C_ITEM_NO + vbCr
    
        'LOT NO
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0660" + "0980"
        sFormatTx = sFormatTx + "Vender Lot:" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0660" + "0500"
        sFormatTx = sFormatTx & C_LOT_NO & vbCr
        
        'QTY
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0740" + "0980"
        sFormatTx = sFormatTx + "QTY:" + vbCr
        sFormatTx = sFormatTx & "B" & varUnitQty + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0740" + "0500"
        sFormatTx = sFormatTx & varUnitQty + vbCr
        
        'MFG DATE
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0820" + "0980"
        sFormatTx = sFormatTx + "Manufacture Date:" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0820" + "0500"
        sFormatTx = sFormatTx + Replace(Trim(varMFGDT), "-", "/") + vbCr
               
        'C/T (Box No)
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0900" + "0980"
        sFormatTx = sFormatTx + "Box NO:" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0900" + "0500"
        sFormatTx = sFormatTx & varCartonNo & vbCr
    Else
        ' °¡·ÎÁÙ
        sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0004" + vbCr
        sFormatTx = sFormatTx + "1X11" + "000" + "0190" + "0030" + "l" + "0980" + "0004" + vbCr
        sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0030" + "l" + "0980" + "0004" + vbCr
        sFormatTx = sFormatTx + "1X11" + "000" + "0430" + "0030" + "l" + "0980" + "0004" + vbCr
        sFormatTx = sFormatTx + "1X11" + "000" + "0550" + "0030" + "l" + "0980" + "0004" + vbCr
        sFormatTx = sFormatTx + "1X11" + "000" + "0670" + "0030" + "l" + "0980" + "0004" + vbCr
        '¼¼·ÎÁÙ
        sFormatTx = sFormatTx + "1X11" + "000" + "0010" + "0715" + "l" + "0004" + "0940" + vbCr
        'QTY ¼¼·ÎÁÙ
        sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0380" + "l" + "0004" + "0120" + vbCr
        sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0245" + "l" + "0004" + "0120" + vbCr
                   
       'SUPPLIER
        sFormatTx = sFormatTx + Angle180 + "911" + "005" + "0080" + "0980"
        sFormatTx = sFormatTx + "SUPPLIER" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0690"
        sFormatTx = sFormatTx + "PEAK" + vbCr
            
       'MAT'L NAME  (°íÁ¤¹®±¸)
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0980"
        sFormatTx = sFormatTx + "MAT'L NAME" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0690"
        sFormatTx = sFormatTx + "TRAY" + vbCr
        
       'CUST'R P/N
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0260" + "0980"
        sFormatTx = sFormatTx + "CUST'R P/N" + vbCr
        sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0265" + "0690"   'Code 128 SubSET B
           sFormatTx = sFormatTx & "B" & C_ITEM_NO + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0305" + "0690"
        sFormatTx = sFormatTx + C_ITEM_NO + vbCr
    
        'LOT NO
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "0980"
        sFormatTx = sFormatTx + "LOT NO" + vbCr
        sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0385" + "0690"   'Code 128 SubSET B
        sFormatTx = sFormatTx & "B" & Format(SHIP_DATE, "mmddyy") & vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0425" + "0690"
        sFormatTx = sFormatTx & Format(SHIP_DATE, "mmddyy") & vbCr
        
        'QTY
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "0370"
        sFormatTx = sFormatTx + "QTY" + vbCr
        sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0385" + "0225"   'Code 128 SubSET B
        sFormatTx = sFormatTx & "B" & varUnitQty + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0425" + "0225"
        sFormatTx = sFormatTx & varUnitQty + vbCr
        
        'MFG DATE
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0500" + "0980"
        sFormatTx = sFormatTx + "MFG DATE" + vbCr
        sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0505" + "0690"   'Code 128 SubSET B
        sFormatTx = sFormatTx & "B" & Format(SHIP_DATE, "yyyy/mm/dd") + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0545" + "0690"
        sFormatTx = sFormatTx + Format(SHIP_DATE, "yyyy/mm/dd") + vbCr
           
        'PEAK P/N
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0620" + "0980"
        sFormatTx = sFormatTx + "PEAK P/N" + vbCr
        sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0625" + "0690"   'Code 128 SubSET B
        sFormatTx = sFormatTx & "B" & varOEMiPART_NO + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0665" + "0690"
        sFormatTx = sFormatTx + varOEMiPART_NO + vbCr
                 
        'CUSTOMER  (Use fixed)
        sText1 = IIf(Trim(Right(C_CUSTOM_CD, 10)) = 20779, "ASE-CL", Trim(Left(C_CUSTOM_CD, 30))) 'ASE CL (Use fixed)
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0860" + "0980"
        sFormatTx = sFormatTx + "CUSTOMER" + vbCr
        sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0800" + "0690"   'Code 128 SubSET B
        sFormatTx = sFormatTx & "B" & sText1 & vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0860" + "0690"
        sFormatTx = sFormatTx & sText1 & vbCr
    End If
    
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub T4_MICRONTW_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2020. 02. 06
    ' DEVELOPER : FRC JIM CHEN
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim charRowAdd(5 To 48)     As Integer
    Dim varDWG_no               As String
    Dim varPrdITEM_no           As String
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    
    Dim varMoldStamp            As String
    Dim varOEMMold_no           As String

    varLotNo = C_LOT_NO
        
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot ???ûÌ? øÎÓÙé³
    varEXPDT = Replace(DateAdd("yyyy", 5, varMFGDT), "-", "")
    varMFGDT = Replace(varMFGDT, "-", "/")

    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
        
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    '===========================================================================
    ' SMP Ë¹ì³ ?íê, Drawing No ?íê
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no, " & vbCrLf
    sql$ = sql$ & " (select distinct nvl(item_no, ' ') item_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO) as prd_item_no, " & vbCrLf
    sql$ = sql$ & " (select distinct nvl(dwg_no, ' ') dwg_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO) as dwg_no" & vbCrLf
    sql$ = sql$ & " from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    varDWG_no = ""
    varPrdITEM_no = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
        varDWG_no = SSDATA!dwg_no
        varPrdITEM_no = SSDATA!prd_item_no
    End If
    SSDATA.Close

    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If
    
    ' MOLD STAMP
    '===========================================================================
    sql$ = " select distinct a.prod_cd, b.prod_gubun, a.mold_no, a.mold_desc, " & vbCrLf
    sql$ = sql$ & " nvl((select mold_stamp from prd_mold_1 f where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and f.mold_no =  b.mold_no), ' ') mold_stamp " & vbCrLf
    sql$ = sql$ & " from PRD_MAST_1_VIEW a, PRD_WORK_11 b " & vbCrLf
    sql$ = sql$ & " where a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    sql$ = sql$ & " and a.prod_cd = b.prod_cd "
    sql$ = sql$ & " and a.comp_cd = b.comp_cd and a.bsns_cd = b.bsns_cd " & vbCrLf
    If varMoldNo = "ASSEMBLY" Then   'Assembly à£?äò ?÷ý Main à£?äò LOTï¡ Öàäú??.
        sql$ = sql$ & " and   b.outlot_no in (select distinct outlot_no from prd_work_31 where lot_no= '" & Replace(Trim(C_LOT_NO), "-", "") & "' and main_kb ='1' ) " & vbCrLf
    Else
        sql$ = sql$ & " and   b.outlot_no = '" & Replace(Trim(C_LOT_NO), "-", "") & "' " & vbCrLf
    End If
    
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
   
    If SSDATA.RecordCount = 0 Then
        varMoldStamp = ""
    Else
        varMoldStamp = Trim(SSDATA!mold_stamp)
    End If
    SSDATA.Close
    
    Set SSDATA = Nothing

    'Assembly P-Bin Management and system will no write any main part information in Prd_work_31. Thus we need to get main part in Prd_BOM_1
    'FRC Jim Chen 2020/02/06
   If varMoldNo = "ASSEMBLY" Then
        sql$ = " select distinct a.prod_cd, a.mold_no, a.mold_desc " & vbCrLf
        sql$ = sql$ & " from PRD_MAST_1_VIEW a" & vbCrLf
        sql$ = sql$ & " where a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
        sql$ = sql$ & " and a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        sql$ = sql$ & " and a.prod_cd = (select child_cd from PRD_BOM_1 where parent_cd =(select distinct P_PROD_CD from prd_work_31 where LOT_NO ='" & Trim(C_LOT_NO) & "')" & vbCrLf
        sql$ = sql$ & "and child_cd like 'TR%')" & vbCrLf
    
        Set SSDATA = Nothing
        SSDATA.Open sql$, DB_User
        
        If SSDATA.RecordCount = 0 Then
            varOEMMold_no = ""
        Else
            varOEMMold_no = str(Int(Right(Trim(SSDATA!mold_desc), 2)))
        End If
        SSDATA.Close
   End If

'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ?åÕ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    Dim varRate     As String
    varRate = "52"
    
    ' Barcode ü½ ?üä    -- reserved --   -Row-    -Col-   -line-  -ØÐüæ + à¢Ïï-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0850" + "0030" + "l" + "0980" + "0007" + vbCr
    ' Barcode ?êÛ           -Îó?àí- -type-  --à¢Ïï--   -Êíüæ-   -row-    -col-          * à¢Ïï : á·ÌÖ à¢Ïï + ïÚÌÖ à¢Ïï
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0850"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'CUST'R
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0160" + "0980"
    sFormatTx = sFormatTx + "CUSTOMER" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0160" + "0730"
    sFormatTx = sFormatTx + ": " + Trim(Left(C_CUSTOM_CD, 30)) + vbCr
    
   'CUST'R PO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0220" + "0980"
    sFormatTx = sFormatTx + "CUST'R PO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0220" + "0730"
    sFormatTx = sFormatTx + ": " + C_PO_NO + vbCr

    'CUST'R P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0280" + "0980"
    sFormatTx = sFormatTx + "CUST'R P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0280" + "0730"
    sFormatTx = sFormatTx + ":" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "050" + "0280" + "0700"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & C_ITEM_NO + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0340" + "0700"
    sFormatTx = sFormatTx + C_ITEM_NO + vbCr
    
    'PEAK P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0400" + "0980"
    sFormatTx = sFormatTx + "PEAK P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0400" + "0730"
    sFormatTx = sFormatTx + ": " + varOEMiPART_NO + vbCr ' I_PART_NO + vbCr
    
    'PEAK DWG#
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0460" + "0980"
    sFormatTx = sFormatTx + "PEAK DWG#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0460" + "0730"
    sFormatTx = sFormatTx + ": " + sText1 + vbCr

    'QTY
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0520" + "0980"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0520" + "0730"
    sFormatTx = sFormatTx + ": " + varUnitQty + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "050" + "0520" + "0450"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & varUnitQty + vbCr
               
    'SHIP'G LOT NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0580" + "0980"
    sFormatTx = sFormatTx + "BATCH NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0580" + "0730"
    sFormatTx = sFormatTx + ": " + varLotNo + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "050" + "0640" + "0710"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & varLotNo + vbCr
    
    'EXP DATE
    sText1 = "12/31/9999"   'Fixed Date
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0720" + "0980"
    sFormatTx = sFormatTx + "EXP DATE" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0720" + "0730"
    sFormatTx = sFormatTx + ": " + sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "050" + "0720" + "0450"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" + sText1 + vbCr
        
    'Mold NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0780" + "0980"
    sFormatTx = sFormatTx + "MOLD NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0780" + "0730"
    sFormatTx = sFormatTx + ": " + IIf(Trim(varMoldStamp) = "", Trim(varOEMMold_no), Trim(varMoldStamp)) + vbCr
                
    'COO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0840" + "0980"
    sFormatTx = sFormatTx + "COO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0840" + "0730"
    sFormatTx = sFormatTx + ": " + "MADE IN TAIWAN" + vbCr
    
    'C/NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0920" + "0980"
    sFormatTx = sFormatTx + "C/NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0920" + "0730"
    sFormatTx = sFormatTx + ": " & varCartonNo & vbCr
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub TR_MICRON_S_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2021.11.25 by jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim yyyy                    As String
    Dim MM                      As String
    Dim dd                      As String
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    Dim varPO                   As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim charRowAdd(5 To 48)     As Integer
    Dim varDWG_no               As String
    Dim varCUSTDWG_no        As String
    Dim varPrdITEM_no           As String
    Dim varInvNo                As String
    Dim varITEMNo               As String   'Item_no
    Dim varIPartNo              As String   'IPart_no
    Dim strExpiration           As String
    Dim varPrdDesc              As String
    
    varLotNo = C_LOT_NO
    varPO = C_PO_NO
    varITEMNo = C_ITEM_NO
    varIPartNo = I_PART_NO
    varInvNo = C_INV_NO

    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    varEXPDT = GF_GET_EXPDATE(GLO_COMP_CD, GLO_BSNS_CD, varMFGDT, Trim(Right(C_CUSTOM_CD, 5)), Trim(I_PART_NO), Trim(I_REV_NO), IIf(C_ITEM_NO = "", " ", C_ITEM_NO), Trim(Right(D_PROD_KB, 10)), , , Format(SHIP_DATE, "yyyy-mm-dd"))
    
    varEXPDT = Replace(varEXPDT, "-", "")
    varMFGDT = Replace(varMFGDT, "-", "")
    
    yyyy = Left(varEXPDT, 4)
    MM = Mid(varEXPDT, 5, 2)
    dd = Right(varEXPDT, 2)
    
    strExpiration = Format((MM & dd & yyyy), "@@-@@-@@@@")
    
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    
    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ, Drawing No È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no, nvl(a.cust_dwg_no,' ') as cust_dwg_no," & vbCrLf
    sql$ = sql$ & " (select distinct nvl(item_no, ' ') item_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO) as prd_item_no, " & vbCrLf
    sql$ = sql$ & " (select distinct nvl(dwg_no, ' ') dwg_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO) as dwg_no" & vbCrLf
    sql$ = sql$ & " from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    varDWG_no = ""
    varCUSTDWG_no = ""
    varPrdITEM_no = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
        varDWG_no = SSDATA!dwg_no
        varPrdITEM_no = SSDATA!prd_item_no
        varCUSTDWG_no = SSDATA!cust_dwg_no
    End If
    SSDATA.Close

    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If
    varPrdDesc = sText1
    
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:

    Dim varRate     As String

    varRate = "52"

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0900" + "0030" + "l" + "0980" + "0007" + vbCr
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
    '1W1c 3 3 000 0100 0100 200 0 000 000 DATAMATRIX °í°´¿äÃ»¿¡ µû¸¥ 2D Barcode Type ¼öÁ¤ 2020.08.14
    sFormatTx = sFormatTx & "3W1c44000" + "0550" + "0230" + "2000" + "000" + "000" & "P" & varITEMNo & "|" & "1P" & "|" & "1T" & varLotNo & "|" & "7Q" & Trim(varUnitQty) & "|" & "S" & CStr(varCartonNo) & "|" & "21PMICRON" & "|" & "2D" & Trim(strExpiration) & "|" & "4L" & Trim(D_NATION_CD) & Chr$(13)
   
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0850"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'CUST'R
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0980"
    sFormatTx = sFormatTx + "CUST'R" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0770"
    sFormatTx = sFormatTx + ":  " + Trim(Left(C_CUSTOM_CD, 30)) + vbCr
    
    ' PO#
    sText1 = "K" & varPO
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0240" + "0980"
    sFormatTx = sFormatTx + "PO#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0240" + "0770"
    sFormatTx = sFormatTx + ": " + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0240" + "0730"
    sFormatTx = sFormatTx + "B" + sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0280" + "0730"
    sFormatTx = sFormatTx + sText1 + vbCr

    'Invoice NO
    sText1 = "11K" & varInvNo
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0340" + "0980"
    sFormatTx = sFormatTx + "PKG Slip" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0340" + "0770"
    sFormatTx = sFormatTx + ": " + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0340" + "0730"
    sFormatTx = sFormatTx + "B" + sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0380" + "0730"
    sFormatTx = sFormatTx + sText1 + vbCr
    
    'Micron P/N
    sText1 = "P" & varITEMNo
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0440" + "0980"
    sFormatTx = sFormatTx + "P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0440" + "0770"
    sFormatTx = sFormatTx + ": " + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0440" + "0730"
    sFormatTx = sFormatTx + "B" + sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0480" + "0730"
    sFormatTx = sFormatTx + sText1 + vbCr
    
    'Origin
    sText1 = "4L" & Trim(D_NATION_CD)
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0540" + "0980"
    sFormatTx = sFormatTx + "Origin" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0540" + "0770"
    sFormatTx = sFormatTx + ": " + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0540" + "0730"
    sFormatTx = sFormatTx + "B" + sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0580" + "0730"
    sFormatTx = sFormatTx + sText1 + vbCr
    
    'LOT
    sText1 = "Z" & varLotNo & "+" & Right(Trim(varEXPDT), 6)
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0640" + "0980"
    sFormatTx = sFormatTx + "LOT#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0640" + "0770"
    sFormatTx = sFormatTx + ": " + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0640" + "0730"
    sFormatTx = sFormatTx + "B" + sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0680" + "0730"
    sFormatTx = sFormatTx + sText1 + vbCr
    
    'QTY#
    sText1 = "7Q" & Trim(varUnitQty)
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0740" + "0980"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0740" + "0770"
    sFormatTx = sFormatTx + ": " + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0740" + "0730"
    sFormatTx = sFormatTx + "B" + sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0780" + "0730"
    sFormatTx = sFormatTx + sText1 + vbCr
    
   'PEAK P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0830" + "0980"
    sFormatTx = sFormatTx + "PEAK P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0830" + "0770"
    sFormatTx = sFormatTx + ":  " + varOEMiPART_NO + vbCr
    
   'PEAK DWG#
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0880" + "0980"
    sFormatTx = sFormatTx + "PEAK DWG#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0880" + "0770"
    sFormatTx = sFormatTx + ":  " + varPrdDesc + vbCr
   
    'C/NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0950" + "0980"
    sFormatTx = sFormatTx + "C/NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0950" + "0770"
    sFormatTx = sFormatTx + ":  " & varCartonNo & vbCr
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub T4_POWERTECH_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2020. 05. 14
    ' DEVELOPER : FRC JIM CHEN
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim charRowAdd(5 To 48)     As Integer
    Dim varDWG_no               As String
    Dim varPrdITEM_no           As String
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    
    Dim varMoldStamp            As String
    Dim varOEMMold_no           As String

    varLotNo = C_LOT_NO
        
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot ???ûÌ? øÎÓÙé³
    varEXPDT = Replace(DateAdd("yyyy", 5, varMFGDT), "-", "")
    varMFGDT = Replace(varMFGDT, "-", "/")

    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
        
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    '===========================================================================
    ' SMP Ë¹ì³ ?íê, Drawing No ?íê
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no, " & vbCrLf
    sql$ = sql$ & " (select distinct nvl(item_no, ' ') item_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO) as prd_item_no, " & vbCrLf
    sql$ = sql$ & " (select distinct nvl(dwg_no, ' ') dwg_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO) as dwg_no" & vbCrLf
    sql$ = sql$ & " from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    varDWG_no = ""
    varPrdITEM_no = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
        varDWG_no = SSDATA!dwg_no
        varPrdITEM_no = SSDATA!prd_item_no
    End If
    SSDATA.Close

    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If
    
    ' MOLD STAMP
    '===========================================================================
    sql$ = " select distinct a.prod_cd, b.prod_gubun, a.mold_no, a.mold_desc, " & vbCrLf
    sql$ = sql$ & " nvl((select mold_stamp from prd_mold_1 f where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and f.mold_no =  b.mold_no), ' ') mold_stamp " & vbCrLf
    sql$ = sql$ & " from PRD_MAST_1_VIEW a, PRD_WORK_11 b " & vbCrLf
    sql$ = sql$ & " where a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    sql$ = sql$ & " and a.prod_cd = b.prod_cd "
    sql$ = sql$ & " and a.comp_cd = b.comp_cd and a.bsns_cd = b.bsns_cd " & vbCrLf
    If varMoldNo = "ASSEMBLY" Then   'Assembly à£?äò ?÷ý Main à£?äò LOTï¡ Öàäú??.
        sql$ = sql$ & " and   b.outlot_no in (select distinct outlot_no from prd_work_31 where lot_no= '" & Replace(Trim(C_LOT_NO), "-", "") & "' and main_kb ='1' ) " & vbCrLf
    Else
        sql$ = sql$ & " and   b.outlot_no = '" & Replace(Trim(C_LOT_NO), "-", "") & "' " & vbCrLf
    End If
    
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
   
    If SSDATA.RecordCount = 0 Then
        varMoldStamp = ""
    Else
        varMoldStamp = Trim(SSDATA!mold_stamp)
    End If
    SSDATA.Close
    
    Set SSDATA = Nothing

    'Assembly P-Bin Management and system will no write any main part information in Prd_work_31. Thus we need to get main part in Prd_BOM_1
    'FRC Jim Chen 2020/02/06
   If varMoldNo = "ASSEMBLY" Then
        sql$ = " select distinct a.prod_cd, a.mold_no, a.mold_desc " & vbCrLf
        sql$ = sql$ & " from PRD_MAST_1_VIEW a" & vbCrLf
        sql$ = sql$ & " where a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
        sql$ = sql$ & " and a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        sql$ = sql$ & " and a.prod_cd = (select child_cd from PRD_BOM_1 where parent_cd =(select distinct P_PROD_CD from prd_work_31 where LOT_NO ='" & Trim(C_LOT_NO) & "')" & vbCrLf
        sql$ = sql$ & "and child_cd like 'TR%')" & vbCrLf
    
        Set SSDATA = Nothing
        SSDATA.Open sql$, DB_User
        
        If SSDATA.RecordCount = 0 Then
            varOEMMold_no = ""
        Else
            varOEMMold_no = str(Int(Right(Trim(SSDATA!mold_desc), 2)))
        End If
        SSDATA.Close
   End If

'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ?åÕ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    Dim varRate     As String
    varRate = "52"
    
    ' Barcode ü½ ?üä    -- reserved --   -Row-    -Col-   -line-  -ØÐüæ + à¢Ïï-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0850" + "0030" + "l" + "0980" + "0007" + vbCr
    ' Barcode ?êÛ           -Îó?àí- -type-  --à¢Ïï--   -Êíüæ-   -row-    -col-          * à¢Ïï : á·ÌÖ à¢Ïï + ïÚÌÖ à¢Ïï
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0850"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'CUST'R
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0160" + "0980"
    sFormatTx = sFormatTx + "CUSTOMER" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0160" + "0730"
    sFormatTx = sFormatTx + ": " + Trim(Left(C_CUSTOM_CD, 30)) + vbCr
    
   'CUST'R PO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0220" + "0980"
    sFormatTx = sFormatTx + "CUST'R PO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0220" + "0730"
    sFormatTx = sFormatTx + ": " + C_PO_NO + vbCr

    'CUST'R P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0280" + "0980"
    sFormatTx = sFormatTx + "CUST'R P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0280" + "0730"
    sFormatTx = sFormatTx + ":" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "050" + "0280" + "0700"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & C_ITEM_NO + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0340" + "0700"
    sFormatTx = sFormatTx + C_ITEM_NO + vbCr
    
    'PEAK P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0400" + "0980"
    sFormatTx = sFormatTx + "PEAK P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0400" + "0730"
    sFormatTx = sFormatTx + ": " + varOEMiPART_NO + vbCr ' I_PART_NO + vbCr
    
    'PEAK DWG#
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0460" + "0980"
    sFormatTx = sFormatTx + "PEAK DWG#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0460" + "0730"
    sFormatTx = sFormatTx + ": " + sText1 + vbCr

    'QTY
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0520" + "0980"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0520" + "0730"
    sFormatTx = sFormatTx + ": " + varUnitQty + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "050" + "0520" + "0450"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & varUnitQty + vbCr
               
    'SHIP'G LOT NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0580" + "0980"
    sFormatTx = sFormatTx + "BATCH NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0580" + "0730"
    sFormatTx = sFormatTx + ": " + varLotNo + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "050" + "0640" + "0710"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & varLotNo + vbCr
    
    'EXP DATE
    sText1 = "12/31/9999"   'Fixed Date
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0720" + "0980"
    sFormatTx = sFormatTx + "EXP DATE" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0720" + "0730"
    sFormatTx = sFormatTx + ": " + sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "050" + "0720" + "0450"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" + sText1 + vbCr
        
    'Mold NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0780" + "0980"
    sFormatTx = sFormatTx + "MOLD NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0780" + "0730"
    sFormatTx = sFormatTx + ": " + IIf(Trim(varMoldStamp) = "", Trim(varOEMMold_no), Trim(varMoldStamp)) + vbCr
                
    'COO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0840" + "0980"
    sFormatTx = sFormatTx + "COO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0840" + "0730"
    sFormatTx = sFormatTx + ": " + "MADE IN TAIWAN" + vbCr
    
    'C/NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0920" + "0980"
    sFormatTx = sFormatTx + "C/NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0920" + "0730"
    sFormatTx = sFormatTx + ": " & varCartonNo & vbCr
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub T4_TITL_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2017. 03. 07
    ' TITL¿ë
    ' ¾÷  Ã¼ : TITL
    ' °³¹ßÀÚ : sjsung
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim charRowAdd(5 To 48)     As Integer
    
    varLotNo = C_LOT_NO

    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If

    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close

    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If
    
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add

    Dim varRate     As String
    varRate = "52"

    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:


    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0850" + "0030" + "l" + "0980" + "0007" + vbCr
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
   
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0850"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'CUST'R
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0980"
    sFormatTx = sFormatTx + "CUST'R" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0730"
    sFormatTx = sFormatTx + ": " + Trim(Left(C_CUSTOM_CD, 30)) + vbCr
        
   'PEAK P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0240" + "0980"
    sFormatTx = sFormatTx + "PEAK P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0240" + "0730"
    sFormatTx = sFormatTx + ": " + varOEMiPART_NO + vbCr

    'PEAK DWG#
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0310" + "0980"
    sFormatTx = sFormatTx + "PEAK DWG#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0310" + "0730"
    sFormatTx = sFormatTx + ": " + sText1 + vbCr
        
    'CUST'R PO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0380" + "0980"
    sFormatTx = sFormatTx + "CUST'R PO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "0730"
    sFormatTx = sFormatTx + ": " + C_PO_NO + vbCr ' I_PART_NO + vbCr
    
    'CUST'R P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0450" + "0980"
    sFormatTx = sFormatTx + "CUST'R P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0450" + "0730"
    sFormatTx = sFormatTx + ": " + C_ITEM_NO + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0520" + "0980"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & C_ITEM_NO & vbCr
    
    'SHIP'G LOT NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0590" + "0980"
    sFormatTx = sFormatTx + "SHIP'G LOT NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0590" + "0730"
    sFormatTx = sFormatTx + ": " + C_PO_NO + "-" + Format(SHIP_DATE, "mmddyy") + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0660" + "0980"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & C_PO_NO + "-" + Format(SHIP_DATE, "mmddyy") & vbCr
    
    'QTY
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0720" + "0980"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0720" + "0730"
    sFormatTx = sFormatTx + ": " + varUnitQty + vbCr
    '¿©¹é
            
    'C/NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0920" + "0980"
    sFormatTx = sFormatTx + "C/NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0920" + "0730"
    sFormatTx = sFormatTx + ": " & varCartonNo & vbCr
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub T4_TITL_InnerLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2017-03-08
    ' ¾÷  Ã¼ : SCS InnerLabel
    ' °³¹ßÀÚ : sjsung
    '======================================================================
    Dim sql                As String
    Dim sText               As String
    Dim varDescNm       As String
    Dim varDWG_no       As String
    Dim varLotNo        As String
    Dim varMFGDT        As String
    Dim varOEMiPART_NO  As String
    Dim varOEMiRev_NO   As String
    Dim sTemp_nm        As String
    Dim sMsg                As String
    Dim varUnitQty      As String
        
    '-------------------------------------------------------------
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    If varUnitQty Mod Val(I_BUNDLE_QT) <> 0 Or Trim(I_BUNDLE_QT) = 0 Or Trim(I_BUNDLE_QT) = "" Then
        MsgBox "Bundle ¼ö·®À» ÀçÈ®ÀÎÇÏ¼¼¿ä.", vbExclamation
        I_BUNDLE_QT.SetFocus
        Exit Sub
    Else
        varUnitQty = IIf(PRT_FORM(1).Value = True, varUnitQty \ Val(I_BUNDLE_QT), varUnitQty)   'I_BOX_UNIT_QT¸¦ Bundle ¼ö·®¸¸Å­ ³ª´«´Ù. (Á¤¼ö·Î Ç¥½Ã)
    End If
    
    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close
    '-------------------------------------------------------------
    
    '============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"

    Dim varRate     As String
    varRate = "52"

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr

    '                      -Ãâ·Â°¢     --- Font ---    -Row-    -Col-
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0090" + "0980"
    sFormatTx = sFormatTx + "TI Part number : " & IIf(C_ITEM_NO = "", " ", C_ITEM_NO) & vbCr   'sText1
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0160" + "0980"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & IIf(C_ITEM_NO = "", " ", C_ITEM_NO) & vbCr
        
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0240" + "0980"
    sFormatTx = sFormatTx + "Supplier Lot No : LN" & C_LOT_NO & vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0310" + "0980"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "BLN" & C_LOT_NO & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0390" + "0980"
    sFormatTx = sFormatTx + "Expiration date : " & DateAdd("yyyy", 3, Format(SHIP_DATE, "YYYY-MM-DD")) & vbCr 'ÃâÇÏÀÏ·Î ºÎÅÍ 3³â
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0460" + "0980"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & DateAdd("yyyy", 3, Format(SHIP_DATE, "YYYY-MM-DD")) & vbCr
                
    'ºÐ¸®¼± ----------------------------------------------------------------------- (À§/¾Æ·¡ µ¿ÀÏÇÑ ³»¿ë Ãâ·Â)
    sFormatTx = sFormatTx + "1X11" + "000" + "0480" + "0030" + "l" + "0980" + "0002" + vbCr
    
     '                      -Ãâ·Â°¢     --- Font ---    -Row-    -Col-
    
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0590" + "0980"
    sFormatTx = sFormatTx + "TI Part number : " & IIf(C_ITEM_NO = "", " ", C_ITEM_NO) & vbCr   'sText1
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0660" + "0980"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & IIf(C_ITEM_NO = "", " ", C_ITEM_NO) & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0740" + "0980"
    sFormatTx = sFormatTx + "Supplier Lot No : LN" & C_LOT_NO & vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0810" + "0980"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "BLN" & C_LOT_NO & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0890" + "0980"
    sFormatTx = sFormatTx + "Expiration date : " & DateAdd("yyyy", 3, Format(SHIP_DATE, "YYYY-MM-DD")) & vbCr 'ÃâÇÏÀÏ·Î ºÎÅÍ 3³â
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0960" + "0980"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & DateAdd("yyyy", 3, Format(SHIP_DATE, "YYYY-MM-DD")) & vbCr
        
    sFormatTx = sFormatTx + "E" + vbCr
End Sub
Private Sub T4_STS_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2011. 12. 21
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' SCK¿ë 2D BarCode (QR CODE)
    ' ¾÷  Ã¼ : SCK
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    Dim varDWG_no               As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim yyyy                    As String
    Dim MM                      As String
    Dim dd                      As String
    
    Dim charRowAdd(5 To 48)     As Integer
    
    varLotNo = C_LOT_NO
    
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    varEXPDT = GF_GET_EXPDATE(GLO_COMP_CD, GLO_BSNS_CD, varMFGDT, Trim(Right(C_CUSTOM_CD, 5)), Trim(I_PART_NO), Trim(I_REV_NO), IIf(C_ITEM_NO = "", " ", C_ITEM_NO), Trim(Right(D_PROD_KB, 10)), , , Format(SHIP_DATE, "yyyy-mm-dd"))
    
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
        
    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no, " & vbCrLf
    sql$ = sql$ & " nvl((select distinct dwg_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO ),' ') as dwg_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    varDWG_no = ""
    If SSDATA.RecordCount > 0 Then
        varDWG_no = SSDATA!dwg_no
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close
 
    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If
 
 
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:
    
    Dim varRate     As String
    varRate = "52"

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' ¿ÜºÎ Box ±×¸®±â           -- reserved --   -Row-    -Col-   -box- -¼öÆò±æÀÌ+¼öÁ÷±æÀÌ- -- line Æø --
    ' sFormatTx = sFormatTx + "1X11" + "000" + "0000" + "0030" + "b" + "0980" + "0950" + "0004" + "0004" + vbCr
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    
     ' °¡·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0004" + vbCr
    
    sFormatTx = sFormatTx + "1X11" + "000" + "0190" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0430" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0550" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0670" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0800" + "0030" + "l" + "0980" + "0004" + vbCr
    'sFormatTx = sFormatTx + "1X11" + "000" + "0880" + "0030" + "l" + "0980" + "0004" + vbCr

    '¼¼·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0010" + "0760" + "l" + "0004" + "0920" + vbCr
        
    'QTY ¼¼·ÎÁÙ
    'sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0380" + "l" + "0004" + "0120" + vbCr
    'sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0245" + "l" + "0004" + "0120" + vbCr
               
   'SUPPLIER
    sFormatTx = sFormatTx + Angle180 + "911" + "005" + "0080" + "0980"
    sFormatTx = sFormatTx + "Supplier" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0740"
    sFormatTx = sFormatTx + "PEAK" + vbCr
        
   'Customer
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0980"
    sFormatTx = sFormatTx + "Customer" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0740"
    sFormatTx = sFormatTx + Trim(Left(C_CUSTOM_CD, 30)) + vbCr
   
   'DESC
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0260" + "0980"
    sFormatTx = sFormatTx + "DESC" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0260" + "0740"
    sFormatTx = sFormatTx + sText1 + vbCr

    'LOT NO
    sText1 = C_PO_NO & "-" & Format(SHIP_DATE, "mmddyy") & "-" & Format(CStr(varCartonNo), "00#")
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "0980"
    sFormatTx = sFormatTx + "LOT NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0385" + "0740"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & sText1 & vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0425" + "0740"
    sFormatTx = sFormatTx & sText1 & vbCr
    
    'ITEM CODE
    sText1 = C_ITEM_NO
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0500" + "0980"
    sFormatTx = sFormatTx + "Item Code" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0505" + "0740"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0545" + "0740"
    sFormatTx = sFormatTx & sText1 + vbCr
    
    'QTY
    sText1 = varUnitQty
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0620" + "0980"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0625" + "0740"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0665" + "0740"
    sFormatTx = sFormatTx + sText1 + "PCS" + vbCr
    
    'SHIPDATE
    sText1 = Trim(SHIP_DATE)
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0740" + "0980"
    sFormatTx = sFormatTx + "Ship Date" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0745" + "0740"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0785" + "0740"
    sFormatTx = sFormatTx + sText1 + vbCr
       
    'MFG_DATE
    sText1 = varMFGDT
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0870" + "0980"
    sFormatTx = sFormatTx + "MFG Date" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0875" + "0740"   'Code 128 SubSET B
    sFormatTx = sFormatTx & "B" & sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0915" + "0740"
    sFormatTx = sFormatTx + sText1 + vbCr
   
        
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub T4_SPIL_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2013. 05. 07
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' SCK¿ë 2D BarCode (QR CODE)
    ' ¾÷  Ã¼ : SPIL TW
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varMoldSeq              As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    Dim varDWG_no               As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim strLOT_ID               As String
    
    Dim yyyy                    As String
    Dim MM                      As String
    Dim dd                      As String
    
    Dim charRowAdd(5 To 48)     As Integer
    
    varLotNo = C_LOT_NO
    varMoldSeq = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2)
    
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@@@@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    'varMFGDT = Left(varMFGDT, 6) & "01" '20170918 »ý»ê¿ù 01·Î °íÁ¤ Ç¥½Ã ihson , CPL hilee 2020.11.24 ½ÇÁ¦ »ý»êÀÏÀÚ¸¦ Ç¥½ÃÇÔ (¸ðµç SPIL SITE °øÅëÀû¿ë)
    If GLO_COMP_CD <> "FU" Then varMFGDT = Left(varMFGDT, 6) & "01" ' CPL hilee 2021.01.11 Àç¿äÃ»À¸·Î PEAK ¶óº§Àº ´Ù½Ã 01ÀÏÀÚ·Î °íÁ¤¿äÃ»
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
        
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
      ' ÇØ´ç¿ùÀÇ ÃâÇÏ È½¼ö¸¦ È®ÀÎ
    ' Display Shipping Date for the C_LOT_NO for Delivery Order for the Lot No
    
    sql$ = "select ipart_no , prev_no,   'P' || '" & Right(Format(SHIP_DATE, "yyyymmdd"), 5) & "' || trim(to_char(ROWNUM, '00')) as LOT_ID"
    sql$ = sql$ & " from ( select distinct ipart_no, prev_no from MKT_OUT_11 a where a.comp_cd = 'SG' and a.bsns_cd = '11' and a.outorder_no ='" & Trim(C_LOT_ID) & "'"
    sql$ = sql$ & ")"
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
            
    strLOT_ID = ""
    If SSDATA.RecordCount > 0 Then
        Do Until SSDATA.EOF
            If Trim(SSDATA!ipart_no) = Trim(I_PART_NO) And Trim(SSDATA!Prev_No) = Trim(I_REV_NO) Then strLOT_ID = Trim(SSDATA!LOT_ID)
            SSDATA.MoveNext
        Loop
    End If
    SSDATA.Close
    If Trim(strLOT_ID) = "" Then strLOT_ID = "P" & Right(Format(SHIP_DATE, "yyyymmdd"), 5) & "01"

    '===========================================================================
    ' Drawing No È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no,  nvl(a.smp_rev_no,' ') as smp_rev_no, " & vbCrLf
    sql$ = sql$ & " nvl((select distinct dwg_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO ),' ') as dwg_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    varDWG_no = ""
    If SSDATA.RecordCount > 0 Then
        varDWG_no = SSDATA!dwg_no
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close
 
    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If
 
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:
    
    Dim varRate     As String
    varRate = "52"

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' ¿ÜºÎ Box ±×¸®±â           -- reserved --   -Row-    -Col-   -box- -¼öÆò±æÀÌ+¼öÁ÷±æÀÌ- -- line Æø --
    sFormatTx = sFormatTx + "1X11" + "000" + "0000" + "0030" + "b" + "0980" + "0950" + "0004" + "0004" + vbCr
    '2D BARCODE(QR CODE)    'aW a=3Àº 180µµÈ¸Àü  ffff ³ôÀ»¼ö·Ï ¾Æ·¡ gggg ³ôÀ»¼ö·Ï ¿ÞÂÊÀ¸·Î, b,c = Module Size
    'sFormatTx = sFormatTx & "3W1D33000030502302MA," & C_ITEM_NO & ";" & Trim(Replace(varLOTNo, "-", "")) & ";" & varUnitQty & ";" & varMFGDT & Chr$(13)  'FRC '2D QR Code Request by FRC CPL Liam 2020-06-05
    sFormatTx = sFormatTx & "3W1D55000063002202MA," & C_ITEM_NO & ";" & Trim(Replace(varLotNo, "-", "")) & ";" & varUnitQty & ";" & varMFGDT & Chr$(13)
    
    ' °¡·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0004" + vbCr
    
    sFormatTx = sFormatTx + "1X11" + "000" + "0190" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0430" + "0030" + "l" + "0980" + "0004" + vbCr
    'sFormatTx = sFormatTx + "1X11" + "000" + "0550" + "0030" + "l" + "0980" + "0004" + vbCr    test
    sFormatTx = sFormatTx + "1X11" + "000" + "0550" + "0245" + "l" + "0765" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0670" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0740" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0810" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0880" + "0030" + "l" + "0980" + "0004" + vbCr
    
    '¼¼·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0430" + "0245" + "l" + "0004" + "0380" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0760" + "l" + "0004" + "0850" + vbCr
        
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "005" + "0080" + "0980"
    sFormatTx = sFormatTx + "" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "005" + "0080" + "0770"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" + vbCr
        
   'CUSTOMER
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0980"
    sFormatTx = sFormatTx + "CUSTOMER" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0740"
    sFormatTx = sFormatTx + Trim(Left(C_CUSTOM_CD, 30)) + vbCr
        
    'CUST'R P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0260" + "0980"
    sFormatTx = sFormatTx + "CUST'R P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0265" + "0740"  'Code 128
    sFormatTx = sFormatTx & "B" & C_ITEM_NO + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0305" + "0740"
    sFormatTx = sFormatTx + C_ITEM_NO + vbCr

    'LOT NO (P+YMMDDXX) : XX = ÃâÇÏÈ½¼ö -> 20170918 ½ÇÁ¦ LOT Ç¥½Ã ihson
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0380" + "0980"
    sFormatTx = sFormatTx + "LOT NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0385" + "0740"  'Code 128
    sFormatTx = sFormatTx & "B" & Replace(varLotNo, "-", "") & vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0425" + "0740"
    sFormatTx = sFormatTx + Replace(varLotNo, "-", "") + vbCr
            
    'MFG DATE
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0500" + "0980"
    sFormatTx = sFormatTx + "MFG DATE" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0505" + "0740"  'Code 128
    sFormatTx = sFormatTx & "B" & varMFGDT + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0545" + "0740"
    sFormatTx = sFormatTx + varMFGDT + vbCr

    'QTY
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0620" + "0980"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0625" + "0740"  'Code 128
    sFormatTx = sFormatTx & "B" & varUnitQty + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0665" + "0740"
    sFormatTx = sFormatTx + varUnitQty + vbCr
                          
    'PEAK DWG
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0720" + "0980"
    sFormatTx = sFormatTx + "PEAK DWG" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0720" + "0740"
    sFormatTx = sFormatTx & I_DESC_NM & vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0720" + "0230"
    sFormatTx = sFormatTx & "REV# : " & Trim(varOEMiRev_NO) & vbCr
    
    'CUST'R PO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0790" + "0980"
    sFormatTx = sFormatTx + "CUST'R PO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0790" + "0740"
    sFormatTx = sFormatTx & C_PO_NO & vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0790" + "0230"
    'sFormatTx = sFormatTx & "MOLD# : " & IIf(GLO_COMP_CD = "FU", "", "S") & Right(varMoldSeq, 1) & vbCr 'FRC´Â S¸¦ Á¦°ÅÇÑ´Ù. 2019.11.12 by Liam
    sFormatTx = sFormatTx & "MOLD# : " & IIf(GLO_COMP_CD = "FU", Right(varMoldSeq, 2), "S" & Right(varMoldSeq, 1)) & vbCr  'FRC´Â S¸¦ Á¦°ÅÇÑ´Ù. 2019.11.12 by Liam

    'PEAK P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0860" + "0980"
    sFormatTx = sFormatTx + "PEAK P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0860" + "0740"
    sFormatTx = sFormatTx & varOEMiPART_NO & vbCr 'I_PART_NO & vbCr
    
    'C/NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0935" + "0980"
    sFormatTx = sFormatTx + "C/NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0935" + "0740"
    sFormatTx = sFormatTx & varCartonNo & vbCr 'I_PART_NO & vbCr
    
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub T4_SCC_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2015. 07. 29
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' ¾÷  Ã¼ : SCC
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varMoldSeq              As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    Dim varDescNm               As String
    Dim varOEMiRev_NO           As String
    Dim varOEMiPART_NO          As String
    
    Dim yyyy                    As String
    Dim MM                      As String
    Dim dd                      As String
    
    Dim charRowAdd(5 To 48)     As Integer
    
    varLotNo = C_LOT_NO
    varMoldSeq = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2)
    
    'varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLOTNo), "@@@@@@@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    varMFGDT = Format(SHIP_DATE, "yyyy-mm-dd")   'ÃâÇÏÀÏÀ» Á¦Á¶ÀÏ·Î ÇÑ´Ù.
    varEXPDT = GF_GET_EXPDATE(GLO_COMP_CD, GLO_BSNS_CD, varMFGDT, Trim(Right(C_CUSTOM_CD, 5)), Trim(I_PART_NO), Trim(I_REV_NO), IIf(C_ITEM_NO = "", " ", C_ITEM_NO), Trim(Right(D_PROD_KB, 10)), , , Format(SHIP_DATE, "yyyy-mm-dd"))
    varMFGDT = Replace(varMFGDT, "-", "")
    varEXPDT = Replace(varEXPDT, "-", "")
    
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
        
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
        
    '===========================================================================
    ' Drawing No È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no, " & vbCrLf
    sql$ = sql$ & " nvl((select distinct pdesc_nm from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO ),' ') as pdesc_nm " & vbCrLf
    sql$ = sql$ & " from MKT_CUST_2 a " & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    varDescNm = ""
    If SSDATA.RecordCount > 0 Then
        varDescNm = SSDATA!pdesc_nm
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close
 
    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If

'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:
    
    Dim varRate     As String
    varRate = "52"

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' ¿ÜºÎ Box ±×¸®±â           -- reserved --   -Row-    -Col-   -box- -¼öÆò±æÀÌ+¼öÁ÷±æÀÌ- -- line Æø --
    sFormatTx = sFormatTx + "1X11" + "000" + "0000" + "0030" + "b" + "0980" + "0950" + "0004" + "0004" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    ' °¡·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0004" + vbCr
    
    sFormatTx = sFormatTx + "1X11" + "000" + "0190" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0430" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0550" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0670" + "0030" + "l" + "0980" + "0004" + vbCr
    
   ' sFormatTx = sFormatTx + "1X11" + "000" + "0740" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0790" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0870" + "0030" + "l" + "0980" + "0004" + vbCr

    '¼¼·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0350" + "l" + "0004" + "0120" + vbCr 'QTY1
    sFormatTx = sFormatTx + "1X11" + "000" + "0310" + "0260" + "l" + "0004" + "0120" + vbCr 'QTY2
    sFormatTx = sFormatTx + "1X11" + "000" + "0790" + "0245" + "l" + "0004" + "0080" + vbCr 'REV
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0760" + "l" + "0004" + "0850" + vbCr
        
   'Title / CUSTOMER
    sFormatTx = sFormatTx + Angle180 + "911" + "005" + "0080" + "0870"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL  (" & Trim(Left(C_CUSTOM_CD, 30)) & ")" + vbCr            '
        
    'DESC
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0980"
    sFormatTx = sFormatTx + "DESC" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0740"
    sFormatTx = sFormatTx + varDescNm + vbCr
        
    'CUST'R P/N
    sText1 = C_ITEM_NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0265" + "0980"
    sFormatTx = sFormatTx + "CUST'R P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0265" + "0740"  'Code 128
    sFormatTx = sFormatTx & "B" & sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0305" + "0740"
    sFormatTx = sFormatTx + sText1 + vbCr
    
    'DPL ¿ø±×¸®±â Rotation,Multiplier(1X11)--Fill Pattern(fff)--Row center point(rrrr)--Column center point(cccc)--Circle ID (C)--Fixed Value(001 0001)--Radius circle(rrrr)
                 '1 X 11 000 0100 0100 C 001 0001 0025<CR>
    sText1 = IIf(Trim(I_METERIAL_NM) = "PES", "GP/E", "GP")
    sFormatTx = sFormatTx + "1X11" + "000" + "0253" + "0140" + "C" + "001" + "0001" + "0052" + vbCr   'Circle ±×¸®±â (¿ø±×¸®±â)
    sFormatTx = sFormatTx + Angle180 + "911" + "S01" + "0275" + "0180" + IIf(sText1 = "GP", "P020P015", "P018P010") + sText1 + vbCr 'GP, GP/E ÆùÆ®Å©±âÁ¶Á¤
    'sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0250" + "0220" + sText1 + vbCr

    'LOTNO
    sText1 = Format(SHIP_DATE, "yyyymmdd")
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0385" + "0980"
    sFormatTx = sFormatTx + "LOT NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0385" + "0740"  'Code 128
    sFormatTx = sFormatTx & "B" & sText1 & vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0425" + "0740" + sText1 + vbCr

    'QTY
    sText1 = varUnitQty
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0385" + "0340"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0385" + "0245" 'Code 128
    sFormatTx = sFormatTx & "B" & sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0425" + "0245" + sText1 + vbCr
    
    'CUST'R PO
    sText1 = C_PO_NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0505" + "0980"
    sFormatTx = sFormatTx + "CUST'R PO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0505" + "0740"  'Code 128
    sFormatTx = sFormatTx & "B" & sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0545" + "0740" + sText1 + vbCr

    'MFG DATE       'Ship Date¸¦ ÁöÁ¤ by ihson 2019.03.22
    sText1 = Trim(Format(varMFGDT, "@@@@.@@.@@"))
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0625" + "0980"
    sFormatTx = sFormatTx + "MFG Date" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0625" + "0740"  'Code 128
    sFormatTx = sFormatTx & "B" & sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0665" + "0740" + sText1 + vbCr

    'Exp Date       'Expire Date =  Ship Date¸¦ ÁöÁ¤ +3³â(MKT_CUST_2), by ihson 2019.03.22
    sText1 = Trim(Format(varEXPDT, "@@@@.@@.@@"))
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0745" + "0980"
    sFormatTx = sFormatTx + "EXP Date" + vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "070" + "0745" + "0740"  'Code 128
    sFormatTx = sFormatTx & "B" & sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0785" + "0740" + sText1 + vbCr
                          
    'PEAK DWG
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0850" + "0980"
    sFormatTx = sFormatTx + "PEAK DWG" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0850" + "0740"
    sFormatTx = sFormatTx & I_DESC_NM & vbCr 'I_PART_NO & vbCr
    'REV
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0850" + "0230"
    sFormatTx = sFormatTx & "REV# : " & Trim(varOEMiRev_NO) & vbCr
    
    'COO / FRC(C/NO)
    If GLO_COMP_CD = "FU" Then  'FRC removes COO for C/NO because of Chinese Customs Diplomatic issue
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0930" + "0980"
        sFormatTx = sFormatTx + "C/NO" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0930" + "0740"
        sFormatTx = sFormatTx + ": " & varCartonNo & "/" & I_END_CT_NO & vbCr
    Else
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0930" + "0980"
        sFormatTx = sFormatTx + "COO" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0930" + "0740"
        sFormatTx = sFormatTx & "MADE IN KOREA" & vbCr 'I_PART_NO & vbCr
    End If
    
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub T4_SCC_InnerLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2015.07.29
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' ¾÷  Ã¼ : SCC
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                As String
    Dim sText               As String
    Dim varDescNm       As String
    Dim varDWG_no       As String
    Dim varOEMiPART_NO  As String
    Dim varOEMiRev_NO   As String
    Dim sTemp_nm        As String
    Dim sMsg                As String
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    
    'varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLOTNo), "@@@@@@@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    varMFGDT = Format(SHIP_DATE, "yyyy-mm-dd")   'ÃâÇÏÀÏÀ» Á¦Á¶ÀÏ·Î ÇÑ´Ù.
    varEXPDT = GF_GET_EXPDATE(GLO_COMP_CD, GLO_BSNS_CD, varMFGDT, Trim(Right(C_CUSTOM_CD, 5)), Trim(I_PART_NO), Trim(I_REV_NO), IIf(C_ITEM_NO = "", " ", C_ITEM_NO), Trim(Right(D_PROD_KB, 10)), , , Format(SHIP_DATE, "yyyy-mm-dd"))
    varMFGDT = Replace(varMFGDT, "-", "")
    varEXPDT = Replace(varEXPDT, "-", "")
    '-------------------------------------------------------------
    ' Drawing No/ SMP Part No È®ÀÎ / Description Á¤º¸¸¦ °¡Á®¿È (Package & Size & Thinkness)
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no, " & vbCrLf
    sql$ = sql$ & " nvl((select distinct dwg_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO ),' ') as dwg_no, " & vbCrLf
    sql$ = sql$ & " nvl((select distinct trim((select mcode_nm from SYS_CODPD_03 where comp_cd = f.comp_cd and bsns_cd = f.bsns_cd and mcode_cd = f.ptype_kb and mcode_class = f.prod_gubun ) ||' '|| psize_nm ||' '|| pthick_nm) " & vbCrLf
    sql$ = sql$ & "                                                                             from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO ),' ') as desc_nm " & vbCrLf
    sql$ = sql$ & " from MKT_CUST_2 a where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    varDWG_no = ""
    varDescNm = ""
    If SSDATA.RecordCount > 0 Then
        varDWG_no = SSDATA!dwg_no
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
        varDescNm = Trim(SSDATA!desc_nm)
    End If
    SSDATA.Close
    '-------------------------------------------------------------
    ' ¿Âµµ È®ÀÎ MKT_CUST_2_Desc_tx4 (°í°´º° Ãß°¡ Á¤º¸ÄÃ·³)
    sql$ = "select distinct a.cdesc_tx4 from MKT_CUST_2 a " & vbCrLf
    sql$ = sql$ + " where a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ + " and   a.custom_cd = '" & Trim(Right(C_CUSTOM_CD, 10)) & "' " & vbCrLf
    sql$ = sql$ + " and   a.item_no = '" + IIf(C_ITEM_NO = "", " ", C_ITEM_NO) + "' "
    sql$ = sql$ & " and a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    If SSDATA.RecordCount = 0 Then
        sMsg = "°Å·¡Ã³º° ITEM Á¤º¸¿¡ Temperature°¡ ¹Ìµî·Ï µÇ¾î ÀÖ½À´Ï´Ù. " & vbCrLf
        sMsg = sMsg & "¿µ¾÷´ã´çÀÚ¿¡°Ô ¾Æ·¡ Á¦Ç° Á¤º¸¸¦ ÀçÈ®ÀÎÇÏ½Ã±â ¹Ù¶ø´Ï´Ù." & vbCrLf
        sMsg = sMsg & "Part No: " & I_PART_NO & ",  Rev: " & I_REV_NO & vbCrLf
        sMsg = sMsg & vbCrLf & "Temperature ¾øÀÌ Ãâ·ÂÀ» °è¼Ó ÁøÇàÇÏ½Ã°Ú½À´Ï±î?"
        If MsgBox(sMsg, vbYesNo + vbQuestion, "SCC Label Print") = vbNo Then Exit Sub
        sTemp_nm = " "
    Else
        sTemp_nm = Trim(SSDATA!cdesc_tx4)
    End If
    SSDATA.Close
    '============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"

    Dim varRate     As String
    varRate = "52"

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr

    '                      -Ãâ·Â°¢     --- Font ---    -Row-    -Col-
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0060" + "0980"
    sFormatTx = sFormatTx + "Vendor: PEAK(KOREA)" & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0100" + "0980"
    sFormatTx = sFormatTx + "Part No : " & I_DESC_NM & vbCr 'sText1
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0140" + "0980"
    sFormatTx = sFormatTx + "Package&Size&Thickness: " & varDescNm & "MM" & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0180" + "0980"
    sFormatTx = sFormatTx + "Temperature : " & sTemp_nm & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0220" + "0980"
    sFormatTx = sFormatTx + "Drawing No : " & I_DESC_NM & vbCr
        
    'Material Code
    sText = C_ITEM_NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0270" + "0980"
    sFormatTx = sFormatTx + "Material Code : " & sText & vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0325" + "0980"
    sFormatTx = sFormatTx & "B" & sText & vbCr
    
    'Lot No
    sText = Format(SHIP_DATE, "yyyymmdd")
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0270" + "0450"
    sFormatTx = sFormatTx + "Lot No : " & sText & vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0325" + "0450"
    sFormatTx = sFormatTx & "B" & sText & vbCr
                           
    'Manufacture Date =  Ship Date¸¦ ÁöÁ¤ 2015.09.14 S+G Ãß°¡ ¿äÃ» °Ç
    sText = Trim(Format(varMFGDT, "@@@@.@@.@@"))  ' Format(varMfgDt, "@@@@-@@-@@")
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0375" + "0980"
    sFormatTx = sFormatTx + "Manufacture Date : " & sText & vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0425" + "0980"
    sFormatTx = sFormatTx & "B" & sText & vbCr
    
    'Expire Date =  Ship Date¸¦ ÁöÁ¤ +3³â(MKT_CUST_2)    by ihson 2019.03.22
    sText = Trim(Format(varEXPDT, "@@@@.@@.@@"))
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0375" + "0450"
    sFormatTx = sFormatTx + "Expire Date : " & sText & vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0425" + "0450"
    sFormatTx = sFormatTx & "B" & sText & vbCr
    
    'ºÐ¸®¼± ----------------------------------------------------------------------- (À§/¾Æ·¡ µ¿ÀÏÇÑ ³»¿ë Ãâ·Â)
    sFormatTx = sFormatTx + "1X11" + "000" + "0480" + "0030" + "l" + "0980" + "0002" + vbCr
    
     '                      -Ãâ·Â°¢     --- Font ---    -Row-    -Col-
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0560" + "0980" '60
    sFormatTx = sFormatTx + "Vendor: PEAK(KOREA)" & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0600" + "0980"
    sFormatTx = sFormatTx + "Part No : " & I_DESC_NM & vbCr 'sText1
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0640" + "0980"
    sFormatTx = sFormatTx + "Package&Size&Thickness: " & varDescNm & "MM" & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0680" + "0980"
    sFormatTx = sFormatTx + "Temperature : " & sTemp_nm & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0720" + "0980"
    sFormatTx = sFormatTx + "Drawing No : " & I_DESC_NM & vbCr
        
    'Material Code
    sText = C_ITEM_NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0770" + "0980"
    sFormatTx = sFormatTx + "Material Code : " & sText & vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0825" + "0980"
    sFormatTx = sFormatTx & "B" & sText & vbCr
    
    'Lot No
    sText = Format(SHIP_DATE, "yyyymmdd")
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0770" + "0450"
    sFormatTx = sFormatTx + "Lot No : " & sText & vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0825" + "0450"
    sFormatTx = sFormatTx & "B" & sText & vbCr
                                                      
    'Manufacture Date =  Ship Date¸¦ ÁöÁ¤ 2015.09.14 S+G Ãß°¡ ¿äÃ» °Ç
    sText = Trim(Format(varMFGDT, "@@@@.@@.@@"))
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0875" + "0980"
    sFormatTx = sFormatTx + "Manufacture Date : " & sText & vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0925" + "0980"
    sFormatTx = sFormatTx & "B" & sText & vbCr
    
    'Expire Date =  Ship Date¸¦ ÁöÁ¤ +3³â(MKT_CUST_2)    by ihson 2019.03.22
    sText = Trim(Format(varEXPDT, "@@@@.@@.@@"))
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0875" + "0450"
    sFormatTx = sFormatTx + "Expire Date : " & sText & vbCr
    sFormatTx = sFormatTx + Angle180 + "e" + varRate + "054" + "0925" + "0450"
    sFormatTx = sFormatTx & "B" & sText & vbCr
        
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub T4_SCS_InnerLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2017-03-08
    ' ¾÷  Ã¼ : SCS InnerLabel
    ' °³¹ßÀÚ : sjsung
    '======================================================================
    Dim sql                As String
    Dim sText               As String
    Dim varDescNm       As String
    Dim varDWG_no       As String
    Dim varLotNo        As String
    Dim varMFGDT        As String
    Dim varOEMiPART_NO  As String
    Dim varOEMiRev_NO   As String
    Dim sTemp_nm        As String
    Dim sMsg                As String
    Dim varUnitQty      As String
        
    '-------------------------------------------------------------
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    If varUnitQty Mod Val(I_BUNDLE_QT) <> 0 Or Trim(I_BUNDLE_QT) = 0 Or Trim(I_BUNDLE_QT) = "" Then
        MsgBox "Bundle ¼ö·®À» ÀçÈ®ÀÎÇÏ¼¼¿ä.", vbExclamation
        I_BUNDLE_QT.SetFocus
        Exit Sub
    Else
        varUnitQty = IIf(PRT_FORM(1).Value = True, varUnitQty \ Val(I_BUNDLE_QT), varUnitQty)   'I_BOX_UNIT_QT¸¦ Bundle ¼ö·®¸¸Å­ ³ª´«´Ù. (Á¤¼ö·Î Ç¥½Ã)
    End If
    '-------------------------------------------------------------
    
    '============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"

    Dim varRate     As String
    varRate = "52"

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr

    '                      -Ãâ·Â°¢     --- Font ---    -Row-    -Col-
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0100" + "0980"
    sFormatTx = sFormatTx + "Scs Partnumber : " & IIf(C_ITEM_NO = "", " ", C_ITEM_NO) & vbCr  'sText1
        
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0250" + "0980"
    sFormatTx = sFormatTx + "Peak Description : " & I_DESC_NM & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0400" + "0980"
    sFormatTx = sFormatTx + "Qty Per Bundle : " & varUnitQty & "PCS" + vbCr
                
    'ºÐ¸®¼± ----------------------------------------------------------------------- (À§/¾Æ·¡ µ¿ÀÏÇÑ ³»¿ë Ãâ·Â)
    sFormatTx = sFormatTx + "1X11" + "000" + "0480" + "0030" + "l" + "0980" + "0002" + vbCr
    
     '                      -Ãâ·Â°¢     --- Font ---    -Row-    -Col-
    
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0600" + "0980"
    sFormatTx = sFormatTx + "Scs Partnumber : " & IIf(C_ITEM_NO = "", " ", C_ITEM_NO) & vbCr  'sText1
    
    
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0750" + "0980"
    sFormatTx = sFormatTx + "Peak Description : " & I_DESC_NM & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0900" + "0980"
    sFormatTx = sFormatTx + "Qty Per Bundle : " & varUnitQty & "PCS" + vbCr
        
    sFormatTx = sFormatTx + "E" + vbCr
End Sub
Private Sub T4_SCK_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2011. 12. 21
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' SCK¿ë 2D BarCode (QR CODE)
    ' ¾÷  Ã¼ : SCK
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varMFGDT                As String
    Dim varEXPDT                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim varCustomNM             As String
    
    Dim charRowAdd(5 To 48)     As Integer
    
    varLotNo = C_LOT_NO
    
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    varEXPDT = GF_GET_EXPDATE(GLO_COMP_CD, GLO_BSNS_CD, varMFGDT, Trim(Right(C_CUSTOM_CD, 5)), Trim(I_PART_NO), Trim(I_REV_NO), IIf(C_ITEM_NO = "", " ", C_ITEM_NO), Trim(Right(D_PROD_KB, 10)), , , Format(SHIP_DATE, "yyyy-mm-dd"))
    
'    Select Case Trim(C_ITEM_NO)
'    Case "R019-2279C", "R019-1527C", "R019-2433C", "R019-2137C"
'        varEXPDT = DateAdd("yyyy", 1, varMFGDT)      'Ãß°¡¿äÃ»¿¡ µû¶ó Part# : R019-2279C,R019-1527C,R019-2433C,R019-2137C ÀÎ °æ¿ì´Â À¯È¿ÀÏÀÚ¸¦ 1³âÀ¸·Î ÇÑ´Ù.
'    Case Else
'        varEXPDT = DateAdd("yyyy", 5, varMFGDT)      'Exp.Date = Lot »ý¼ºÀÏÀÚ + 2³â (³¯Â¥ ÇüÅÂ¸¦ @@@@-@@-@@·Î Á¤ÀÇ ÇØ¾ß 2³âÀ» ´õÇÒ ¼ö ÀÖÀ½ )
'    End Select
    
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
        
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If


    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close
        
    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If
        
    '===========================================================================
    '°í°´Á¤º¸ °¡Á®¿À±â
    '===========================================================================
    sql$ = "select CUSTOM_CD, WWCUSTOM_CD, custom_en CUSTOM_NM, CUSTOM_YN, ADDRE_TX from MKT_CUST_1 " & vbCrLf
    sql$ = sql$ & " where custom_cd = '" & Trim(Right(C_CUSTOM_CD, 10)) & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User

    If SSDATA.RecordCount > 0 Then
        varCustomNM = Trim(SSDATA!custom_nm)    'Custom_NM
    Else
        varCustomNM = Trim(Left(C_CUSTOM_CD, 30))     'Custom_YN
    End If
    SSDATA.Close

'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:


    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0850" + "0030" + "l" + "0980" + "0007" + vbCr
       
    '¿©¹é
    'QRÄÚµå´Â ¼ýÀÚ ÃÖ´ë 7089ÀÚ, ¹®ÀÚ(ASCII) ÃÖ´ë 4296ÀÚ, ÀÌÁø8ºñÆ® ÃÖ´ë 2953¹ÙÀÌÆ®, ÇÑÀÚµî ¾Æ½Ã¾Æ ¹®ÀÚ ÃÖ´ë 1817ÀÚ¸¦ ´ãÀ» ¼ö ÀÖ´Ù.
    '2D BARCODE(QR CODE)   'aW a=3Àº 180µµÈ¸Àü  ffff ³ôÀ»¼ö·Ï ¾Æ·¡ gggg ³ôÀ»¼ö·Ï ¿ÞÂÊÀ¸·Î
    'a W1 b c d eee ffff gggg hh¡¦h 1 W1 d 4 4 000 0010 0010This is the data portion
    '                               3 W1 D 4 4 000 0320 0200 2MA,
    sFormatTx = sFormatTx & "3W1D55000065002702MA," & C_ITEM_NO & "/" & C_LOT_ID & "/" & varUnitQty & "/" & C_PO_NO & "/" & varMFGDT & Chr$(13)
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0850"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'CUSTOMER
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0985"
    sFormatTx = sFormatTx + "CUSTOMER" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0730"
    sFormatTx = sFormatTx + ": " + varCustomNM + vbCr
    
   'PEAK P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0240" + "0985"
    sFormatTx = sFormatTx + "PEAK P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0240" + "0730"
    sFormatTx = sFormatTx + ": " + varOEMiPART_NO + vbCr ' I_PART_NO + vbCr

    'CUST'R P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0315" + "0985"
    sFormatTx = sFormatTx + "CUST'R P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "005" + "0315" + "0730"
    sFormatTx = sFormatTx + ": " + C_ITEM_NO + vbCr
    
    'REV (2015.12.31 S+G ±è¹ÌÁø ¿äÃ»À¸·Î Ãß°¡ ÁøÇà)
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0315" + "0260"
    sFormatTx = sFormatTx + "Rev. " + varOEMiRev_NO + vbCr
    
    'SHIP'G LOT NO
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0390" + "0985"
    sFormatTx = sFormatTx + "SHIP'G LOT#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "005" + "0390" + "0730"
    sFormatTx = sFormatTx + ": " + C_LOT_ID + vbCr
    
    'QTY
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0460" + "0985"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0460" + "0730"
    sFormatTx = sFormatTx + ": " + varUnitQty + vbCr
    
    'P/O NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0530" + "0985"
    sFormatTx = sFormatTx + "P/O NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0530" + "0730"
    sFormatTx = sFormatTx + ": " + C_PO_NO + vbCr
    
    'MFG DATE (ÃâÇÏÀÏ ÇÏ·çÀü ÅëÀÏ) 'QA ¼ºÀû¼­¿Í Mfg Date Á¤º¸°¡ Æ²¾îÁö´Â °æ¿ì ¹ß»ý  'Format(SHIP_DATE, "@@@@-@@-@@"))
    'varMfgDt LOG»ý¼ºÀÏÀÚ ±âÁØÀ¸·Î º¯°æ 2012-08-13 Sng Àü´ë¿­, ¹éÁöÈÆ ¿äÃ»»çÇ×
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0600" + "0985"
    sFormatTx = sFormatTx + "MFG DATE" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0600" + "0730"
    sFormatTx = sFormatTx + ": " + varMFGDT + vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0670" + "0985"
    sFormatTx = sFormatTx + "EXP DATE" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0670" + "0730"
    sFormatTx = sFormatTx + ": " + varEXPDT + vbCr
    
    'COO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0740" + "0985"
    sFormatTx = sFormatTx + "COO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0740" + "0730"
    sFormatTx = sFormatTx + ": " + GLO_COMP_CO + vbCr


' ------------------------------------------------------------------------------------------------------
' 2013.01.11 SNG_Evan_baek SCK¿äÃ»À¸·Î CUST'R P/N , SHIP'G LOT NO Font 2¹èÈ®´ë ÇÔ (»ùÇÃÈ®ÀÎÈÄ ÀÌÀü¾ç½ÄÀ¸·Î Àç¿äÃ»ÇÔ, º¸·ùÃ³¸®)
' ------------------------------------------------------------------------------------------------------
'    'CUST'R P/N
'    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0350" + "0990"
'    sFormatTx = sFormatTx + "CUST'R P/N" + vbCr
'    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0350" + "0605"
'    sFormatTx = sFormatTx + ": " + C_ITEM_NO + vbCr
'
'    'SHIP'G LOT NO
'    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0440" + "0990"
'    sFormatTx = sFormatTx + "SHIP'G LOT#" + vbCr
'    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0440" + "0605"
'    sFormatTx = sFormatTx + ": " + C_PO_NO + "-" + Format(SHIP_DATE, "mmddyy") + vbCr
'
'    'QTY
'    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0520" + "0985"
'    sFormatTx = sFormatTx + "QTY" + vbCr
'    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0520" + "0730"
'    sFormatTx = sFormatTx + ": " + varUnitQty + vbCr
'
'    'P/O NO
'    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0590" + "0985"
'    sFormatTx = sFormatTx + "P/O NO" + vbCr
'    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0590" + "0730"
'    sFormatTx = sFormatTx + ": " + C_PO_NO + vbCr
'
'    'MFG DATE (ÃâÇÏÀÏ ÇÏ·çÀü ÅëÀÏ) 'QA ¼ºÀû¼­¿Í Mfg Date Á¤º¸°¡ Æ²¾îÁö´Â °æ¿ì ¹ß»ý
'    'varMfgDt LOG»ý¼ºÀÏÀÚ ±âÁØÀ¸·Î º¯°æ 2012-08-13 Sng Àü´ë¿­, ¹éÁöÈÆ ¿äÃ»»çÇ×
'    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0660" + "0985"
'    sFormatTx = sFormatTx + "MFG DATE" + vbCr
'    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0660" + "0730"
'    sFormatTx = sFormatTx + ": " + varMfgDt + vbCr
'
'    '¿©¹é
'    'QRÄÚµå´Â ¼ýÀÚ ÃÖ´ë 7089ÀÚ, ¹®ÀÚ(ASCII) ÃÖ´ë 4296ÀÚ, ÀÌÁø8ºñÆ® ÃÖ´ë 2953¹ÙÀÌÆ®, ÇÑÀÚµî ¾Æ½Ã¾Æ ¹®ÀÚ ÃÖ´ë 1817ÀÚ¸¦ ´ãÀ» ¼ö ÀÖ´Ù.
'    '2D BARCODE(QR CODE)   'aW a=3Àº 180µµÈ¸Àü  ffff ³ôÀ»¼ö·Ï ¾Æ·¡ gggg ³ôÀ»¼ö·Ï ¿ÞÂÊÀ¸·Î
'    'a W1 b c d eee ffff gggg hh¡¦h 1 W1 d 4 4 000 0010 0010This is the data portion
'    '                               3 W1 D 4 4 000 0320 0200 2MA,
'    sFormatTx = sFormatTx & "3W1D55000072002602MA," & C_ITEM_NO & "/" & C_PO_NO + "-" + Format(SHIP_DATE, "mmddyy") & "/" & varUnitQty & "/" & C_PO_NO & "/" & varMfgDt & Chr$(13)
'
'    'COO
'    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0730" + "0985"
'    sFormatTx = sFormatTx + "COO" + vbCr
'    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0730" + "0730"
'    sFormatTx = sFormatTx + ": " + GLO_COMP_CO  + vbCr
' ------------------------------------------------------------------------------------------------------

    'C/NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0920" + "0985"
    sFormatTx = sFormatTx + "C/NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0920" + "0730"
    sFormatTx = sFormatTx + ": " & varCartonNo & "/" & I_END_CT_NO & vbCr
    
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub TR_SCK_innerLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2013.11.08
    ' SCK CoverTape InnerLabel
    ' ¼öÁ¤ÀÚ :  by jwkim
    '======================================================================
    Dim sText1                  As String
    Dim sText2                  As String
    
    Dim charRowAdd(5 To 48)     As Integer
    
    Dim yyyy                    As String
    Dim MM                      As String
    Dim dd                      As String
    
    Dim varCustomName           As String
    Dim varPO                   As String
    Dim varLotNo                As String   'Lot#
    Dim varPrdDesc              As String
    Dim varDrawingNo            As String
    Dim varSPECNo               As String
    Dim varITEMNo               As String   'Item_no
    Dim varIPartNo              As String   'IPart_no
    Dim varMFGDT                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
        
    Dim sql                     As String
        
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), C_LOT_NO), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    
    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close
        
    '===========================================================================
    '°í°´Á¤º¸ °¡Á®¿À±â
    '===========================================================================
    sql$ = "select CUSTOM_CD, WWCUSTOM_CD, CUSTOM_EN , CUSTOM_YN, ADDRE_TX from MKT_CUST_1 " & vbCrLf
    sql$ = sql$ & " where custom_cd = '" & Trim(Right(C_CUSTOM_CD, 10)) & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User

    If SSDATA.RecordCount > 0 Then
        varCustomName = Trim(SSDATA!custom_en)     'Custom_NM
    Else
        varCustomName = Trim(Left(C_CUSTOM_CD, 30))     'Custom_YN
    End If
    SSDATA.Close
    
    varPO = C_PO_NO
    varLotNo = C_LOT_NO
    'varPrdDesc = GF_TrucateCR(I_DESC_NM) & " " & I_METERIAL_NM
    varITEMNo = C_ITEM_NO
    varIPartNo = varOEMiPART_NO
     
    ' Angle Á¤ÀÇ
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"

    ' Horizontal expansion rate Á¤ÀÇ
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

    ' Vertical expansion rate Á¤ÀÇ
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

    ' Font 9 ÀÏ¶§ Size Á¤ÀÇ
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

    ' Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:
        
    'ÃÊ±â Á¤ÀÇ°ª
    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
'=========================================================================================================
'    1       234     567     8901     2345     6
'Angle180 + "911" + "003" + "0065" + "0950" + "Description " + vbCr
'1              : Ãâ·Â°¢ Á¶Àý        1 = 0:  2 = 90:   3 = 180:    4 = 270
'2              : Font °áÁ¤          0 ~ 8 : System Font     9 : Smooth Font
'3              : FontÀÇ °¡·ÎºñÀ²    1 ~ 9, A ~ O  (1 ~ 24 ±îÁö ÀÇ¹Ì 1~9, 10~24)
'4              : FontÀÇ ¼¼·ÎºñÀ²    1 ~ 9, A ~ O  (1 ~ 24 ±îÁö ÀÇ¹Ì 1~9, 10~24)
'5, 6, 7        : Font°¡ Smooth ÀÏ¶§ °ª °áÁ¤(2¹øÂ° ÀÚ¸®°¡ 9ÀÏ¶§)  001(6 Pt) ~ 010(48 Pt)
'8, 9, 10, 11   : Row ÀÇ À§Ä¡ 0000~9999  ´ÜÀ§ : 0.01 inch/step
'12, 13, 14, 15 : Col ÀÇ À§Ä¡ 0000~0416  ´ÜÀ§ : 0.01 inch/step
'16             : ¹®ÀÚ ÀÔ·Â
    
    Dim varRate     As String
    varRate = "52"
     
    sText1 = C_ITEM_NO
    sFormatTx = sFormatTx & Angle180 & "911" & "004" & "0070" & "0560" & "SAP Code : " & sText1 & vbCr
    sFormatTx = sFormatTx & Angle180 & "E" & varRate & "080" & "0180" & "0560"   '1D Barcode Type "CODE 128"·Î º¯°æ
    sFormatTx = sFormatTx + "B" + sText1 & vbCr 'Code 128 SubSET B
    
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub T4_ATK_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2011. 12. 21
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' OEM P/N »ç¿ë, Address Ãâ·Â½Ã ¹®ÀÚ¿­ ±æÀÌ¿¡ µû¶ó ROW Á¶Àý
    ' ¾÷  Ã¼ : ATK
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim varCustomCd             As String
    Dim varPdescNm              As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    
    Dim subSpace                As String
    
    Dim charRowAdd(5 To 48)     As Integer
    varLotNo = C_LOT_NO

    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    
    '===========================================================================
    ' Drawing No È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no , " & vbCrLf
    sql$ = sql$ & " (select distinct pdesc_nm from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.ipart_no=f.ipart_no ) as pdesc_nm "
    sql$ = sql$ & " from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    varPdescNm = ""
    If SSDATA.RecordCount > 0 Then
        varPdescNm = SSDATA!pdesc_nm
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close
                
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:


    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0005" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0800" + "0030" + "l" + "0980" + "0004" + vbCr
    
    'Áß°£ °¡·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0230" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0300" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0370" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0440" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0510" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0580" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0650" + "0030" + "l" + "0980" + "0004" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0720" + "0030" + "l" + "0980" + "0004" + vbCr
        
    'Áß°£ ¼¼·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0370" + "0320" + "l" + "0004" + "0075" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0510" + "0320" + "l" + "0004" + "0075" + vbCr
    
    '¼¼·ÎÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "1005" + "l" + "0005" + "0700" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0005" + "0700" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0720" + "l" + "0004" + "0700" + vbCr
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
   
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0850"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'ATK Batch No (°ø¹é)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0980"
    sFormatTx = sFormatTx + "ATK Batch No" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0700"
    sFormatTx = sFormatTx + vbCr
    
   'Item No(Sid No)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0280" + "0980"
    sFormatTx = sFormatTx + "Item No(Sid No)" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0280" + "0700"
    sFormatTx = sFormatTx + C_ITEM_NO + vbCr

    'Description
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0350" + "0980"
    sFormatTx = sFormatTx + "Description" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0350" + "0700"
    sFormatTx = sFormatTx + varPdescNm + vbCr
    
    'Carton No/Qty
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0420" + "0980"
    sFormatTx = sFormatTx + "Carton No / Qty" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0420" + "0700"
    sFormatTx = sFormatTx & varCartonNo & "/" & varTotalCartonNo & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0420" + "0310"
    sFormatTx = sFormatTx + varUnitQty + " PCS" + vbCr
    
    'Drawing No / Rev No
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0495" + "0980"
    sFormatTx = sFormatTx + "Drawing No" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0495" + "0700"
    sFormatTx = sFormatTx + I_DESC_NM + vbCr

    'PO No
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0565" + "0980"
    sFormatTx = sFormatTx + "PO NO / Rev" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0565" + "0700"
    sFormatTx = sFormatTx + C_PO_NO & "-" & "000" & vbCr   '000 °íÁ¤°ª »ç¿ë (S+G ±è¼¼ÀÏ »ç¿ø¿äÃ» °Ç 2013.12.12)
    'sFormatTx = sFormatTx + C_PO_NO & "-" & Format(varOEMiRev_NO, "00#") & vbCr  'I_PART_NO
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0560" + "0310"
    sFormatTx = sFormatTx + Trim(varOEMiRev_NO) + vbCr ' Format(varOEMiRev_NO, "00#") + vbCr
    
    'Peak P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0640" + "0980"
    sFormatTx = sFormatTx + "Peak P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0640" + "0700"
    sFormatTx = sFormatTx + varOEMiPART_NO + vbCr  '
    
    'Supplier Lot No
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0710" + "0980"
    sFormatTx = sFormatTx + "Supplier Lot No" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0710" + "0700"
    sFormatTx = sFormatTx & C_PO_NO & "-" & "000" & "-" & Format(SHIP_DATE, "mmddyy") & vbCr    '000 °íÁ¤°ª »ç¿ë (S+G ±è¼¼ÀÏ »ç¿ø¿äÃ» °Ç 2013.12.12)
    'sFormatTx = sFormatTx & C_PO_NO & "-" & Format(varOEMiRev_NO, "00#") & "-" & Format(SHIP_DATE, "mmddyy") & vbCr
        
    'Supplier Name
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0780" + "0980"
    sFormatTx = sFormatTx + "Supplier Name" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0780" + "0700"
    sFormatTx = sFormatTx + "PEAK" + vbCr
    
    '¾÷Ã¼º° ÁÖ¼Ò°¡Á®¿À±â
    varCustomCd = Trim(Right(C_CUSTOM_CD, 10))
    'TEST varCustomCD = "100001"
    sql$ = "select custom_cd, CUSTOM_EN  custom_nm, addre_tx from MKT_CUST_1 "
    sql$ = sql$ & " where custom_cd = '" & varCustomCd & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf

    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User

    If SSDATA.RecordCount > 0 Then
        'Address
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0860" + "0980"
        sFormatTx = sFormatTx + "Address" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0860" + "0840"
        sFormatTx = sFormatTx + ":  " & SSDATA!custom_nm & vbCr
        If Len(Trim(SSDATA!addre_tx)) > 46 Then 'ÁÖ¼Ò±æÀÌ¿¡ µû¶ó 3ÁÙ·Î Ç¥½ÃÇÑ´Ù.
            sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0910" + "0980"
            sFormatTx = sFormatTx + " " & Left(SSDATA!addre_tx, 46) & vbCr
            sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0960" + "0980"
            sFormatTx = sFormatTx + " " & Mid(SSDATA!addre_tx, 47, Len(SSDATA!addre_tx)) & vbCr
        Else
            sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0910" + "0980"
            sFormatTx = sFormatTx + " " & SSDATA!addre_tx & vbCr
        End If
    Else
        '¾÷Ã¼Á¤º¸°¡ Á¸ÀçÇÏÁö ¾ÊÀ½ (°ø¹éÀ¸·Î Ç¥½Ã)
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0860" + "0980"
        sFormatTx = sFormatTx + "Address : " + vbCr
    End If
    SSDATA.Close
    
    sFormatTx = sFormatTx + "E" + vbCr
    
End Sub

Private Sub T4_Renesas_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2013. 05. 13
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' ¾÷  Ã¼ : Renesas
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim sMonth                  As String
    Dim varLotNo               As String
    Dim varMoldSeq              As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim varCustomCd             As String
    Dim subSpace                As String
    
    Dim charRowAdd(5 To 48)     As Integer
    varLotNo = C_LOT_NO
    varMoldSeq = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2)

    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = varMoldSeq & I_REV_NO
        Else
            sText2 = sText2 & " " & varMoldSeq & I_REV_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = varMoldSeq & I_REV_NO
    End If
    
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
   
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:


    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0030" + "0030" + "l" + "0980" + "0006" + vbCr
    'sFormatTx = sFormatTx + "1X11" + "000" + "0230" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0930" + "0030" + "l" + "0980" + "0006" + vbCr
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
         
   'ITEM
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0100" + "0980"
    sFormatTx = sFormatTx + "ITEM" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0100" + "0710"
    sFormatTx = sFormatTx + ": " + sText1 + vbCr
    
   'CUSTOMER
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0180" + "0980"
    sFormatTx = sFormatTx + "CUSTOMER" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0180" + "0710"
    sFormatTx = sFormatTx + ": " + Trim(Left(C_CUSTOM_CD, 30)) + vbCr

    Select Case Format(SHIP_DATE, "mm")           'M
        Case "10":  sMonth = "X"
        Case "11":  sMonth = "Y"
        Case "12":  sMonth = "Z"
        Case Else:  sMonth = Format(SHIP_DATE, "mm")
    End Select
    
    'RENESAS LOT#
    sText1 = "G" & Right(Format(SHIP_DATE, "yyyy"), 1) & sMonth & Format(SHIP_DATE, "dd") & Right(varMoldSeq, 1)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0260" + "0980"
    sFormatTx = sFormatTx + "RENESAS LOT#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0260" + "0710"
    sFormatTx = sFormatTx + ": " & sText1 & vbCr
    
    'LOT NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0340" + "0980"
    sFormatTx = sFormatTx + "LOT NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0340" + "0710"
    sFormatTx = sFormatTx + ": " & varLotNo & vbCr
       
    'QTY
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0420" + "0980"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0420" + "0710"
    sFormatTx = sFormatTx + ": " + varUnitQty + " PCS" + vbCr
    
    'PO No
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0500" + "0980"
    sFormatTx = sFormatTx + "PO NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0500" + "0710"
    sFormatTx = sFormatTx + ": " + C_PO_NO & vbCr 'I_PART_NO

    'MOLD NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0580" + "0980"
    sFormatTx = sFormatTx + "MOLD NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0580" + "0710"
    sFormatTx = sFormatTx + ": " & "SG-" & Right(varMoldSeq, 1) & vbCr '
    
    'SUPPLIER
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0660" + "0980"
    sFormatTx = sFormatTx + "SUPPLIER" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0660" + "0710"
    sFormatTx = sFormatTx + ": " & "S+G COMPANY" & vbCr
    
    'MFG COUNTRY
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0740" + "0980"
    sFormatTx = sFormatTx + "MFG COUNTRY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0740" + "0710"
    sFormatTx = sFormatTx + ": " + "MADE IN KOREA" + vbCr
    
    'C/T NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0820" + "0980"
    sFormatTx = sFormatTx + "C/T NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0820" + "0710"
    sFormatTx = sFormatTx + ": " & varCartonNo & "/" & varTotalCartonNo & vbCr
    
    sFormatTx = sFormatTx + "E" + vbCr
    
End Sub

Private Sub T4_ATK_old_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2011. 12. 21
    ' Daewon±âÁØÀ¸·Î Code º¯°æ (S+G : LPT Ãâ·Â)
    ' OEM P/N »ç¿ë, Address Ãâ·Â½Ã ¹®ÀÚ¿­ ±æÀÌ¿¡ µû¶ó ROW Á¶Àý
    ' ¾÷  Ã¼ : ATK
    ' °³¹ßÀÚ : ICS_jwkim
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim varCustomCd             As String
    Dim varDWG_no               As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    
    Dim subSpace                As String
    
    Dim charRowAdd(5 To 48)     As Integer
    varLotNo = C_LOT_NO

    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
        
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    
    '===========================================================================
    ' Drawing No È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no, " & vbCrLf
    sql$ = sql$ & " (select distinct dwg_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO ) as dwg_no from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    varDWG_no = ""
    If SSDATA.RecordCount > 0 Then
        varDWG_no = SSDATA!dwg_no
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
    End If
    SSDATA.Close
    
    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If
    
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:


    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    'sFormatTx = sFormatTx + "1X11" + "000" + "0230" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0800" + "0030" + "l" + "0980" + "0007" + vbCr
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
   
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0850"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'ATK Batch No (°ø¹é)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0980"
    sFormatTx = sFormatTx + "ATK Batch No" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0730"
    sFormatTx = sFormatTx + ": " + vbCr
    
   'Item No(Sid No)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0280" + "0980"
    sFormatTx = sFormatTx + "Item No(Sid No)" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0280" + "0730"
    sFormatTx = sFormatTx + ": " + C_ITEM_NO + vbCr

    'Description
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0350" + "0980"
    sFormatTx = sFormatTx + "Description" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0350" + "0730"
    sFormatTx = sFormatTx + ": " + sText1 + vbCr
    
    'Carton No/Qty
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0420" + "0980"
    sFormatTx = sFormatTx + "Carton No" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0420" + "0730"
    sFormatTx = sFormatTx + ": " & varCartonNo & "/" & varTotalCartonNo & vbCr
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0420" + "0320"
    sFormatTx = sFormatTx + "Qty : " + varUnitQty + " PCS" + vbCr

    'Drawing No / Rev No
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0490" + "0980"
    sFormatTx = sFormatTx + "Drawing No" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0490" + "0730"
    sFormatTx = sFormatTx + ": " + I_DESC_NM + vbCr
    
    'PO No
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0560" + "0980"
    sFormatTx = sFormatTx + "PO NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0560" + "0730"
    sFormatTx = sFormatTx + ": " + C_PO_NO & "-" & Format(varOEMiRev_NO, "00#") & vbCr 'I_PART_NO
    
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0560" + "0320"
    sFormatTx = sFormatTx + "Rev No : " + Format(varOEMiRev_NO, "00#") + vbCr
    
    'Peak P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0640" + "0980"
    sFormatTx = sFormatTx + "Peak P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0640" + "0730"
    sFormatTx = sFormatTx + ": " + varOEMiPART_NO + vbCr '
    
    'Supplier Lot No
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0710" + "0980"
    sFormatTx = sFormatTx + "Supplier Lot No" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0710" + "0730"
    sFormatTx = sFormatTx + ": " & C_PO_NO & "-" & Format(varOEMiRev_NO, "00#") & "-" & Format(SHIP_DATE, "mmddyy") & vbCr
    
    'Supplier Name
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0780" + "0980"
    sFormatTx = sFormatTx + "Supplier Name" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0780" + "0730"
    sFormatTx = sFormatTx + ": " + "PEAK" + vbCr
    
    '¾÷Ã¼º° ÁÖ¼Ò°¡Á®¿À±â
    varCustomCd = Trim(Right(C_CUSTOM_CD, 10))
    'TEST varCustomCD = "100001"
    sql$ = "select custom_cd, CUSTOM_EN  custom_nm, addre_tx from MKT_CUST_1 "
    sql$ = sql$ & " where custom_cd = '" & varCustomCd & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf

    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User

    If SSDATA.RecordCount > 0 Then
        'Address
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0860" + "0980"
        sFormatTx = sFormatTx + "Address" + vbCr
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0860" + "0840"
        sFormatTx = sFormatTx + ":  " & SSDATA!custom_nm & vbCr
        If Len(Trim(SSDATA!addre_tx)) > 46 Then 'ÁÖ¼Ò±æÀÌ¿¡ µû¶ó 3ÁÙ·Î Ç¥½ÃÇÑ´Ù.
            sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0910" + "0980"
            sFormatTx = sFormatTx + " " & Left(SSDATA!addre_tx, 46) & vbCr
            sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0960" + "0980"
            sFormatTx = sFormatTx + " " & Mid(SSDATA!addre_tx, 47, Len(SSDATA!addre_tx)) & vbCr
        Else
            sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0910" + "0980"
            sFormatTx = sFormatTx + " " & SSDATA!addre_tx & vbCr
        End If
    Else
        '¾÷Ã¼Á¤º¸°¡ Á¸ÀçÇÏÁö ¾ÊÀ½ (°ø¹éÀ¸·Î Ç¥½Ã)
        sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0860" + "0980"
        sFormatTx = sFormatTx + "Address : " + vbCr
    End If
    SSDATA.Close
    
    sFormatTx = sFormatTx + "E" + vbCr
    
End Sub

Private Sub TR_TSMC_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2014.04.07
    ' Tray TSMC BarCode¸¦ ÀÛ¼ºÇÏ±â À§ÇØ ÀÛ¼ºµÈ ·çÆ¾ÀÓ - jwkim
    '======================================================================
    Dim sText1                  As String
    Dim sText2                  As String
    Dim sql                     As String
    Dim charRowAdd(5 To 48)     As Integer
    
    Dim yyyy                    As String
    Dim MM                      As String
    Dim dd                      As String
    
    Dim varCustomName           As String
    Dim varPO                   As String
    Dim varUnitQty              As String   'Quantity
    Dim varMatrBatch            As String   'Lot#
    Dim varPrdDesc              As String
    Dim varDrawingNo            As String
    Dim varSPECNo               As String
    Dim varITEMNo               As String   'Item_no
    Dim varIPartNo              As String   'IPart_no
    Dim varCustSuppCD           As String
    Dim varMFGDT                As String
    Dim varMoldStamp           As String
    Dim varInvoiceNo    As String
    
    varInvoiceNo = C_INV_NO
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), C_LOT_NO), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    
    varCustomName = Trim(Left(C_CUSTOM_CD, 30))
    varPO = C_PO_NO
    If GLO_COMP_CD = "FU" Then
        'varPrdDesc = Trim(Left(C_PROD_KB, 30)) & " " & GF_TrucateCR(I_DESC_NM)    'Á¦Ç°±º + Á¦Ç°¸í
        varPrdDesc = GF_TrucateCR(I_DESC_NM)
    Else
        varPrdDesc = GF_TrucateCR(I_DESC_NM) & " " & I_METERIAL_NM & "-" & I_COLOR_NM
    End If
    varITEMNo = C_ITEM_NO
    varIPartNo = I_PART_NO
    
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    ' MOLD STAMP
    '===========================================================================
    sql$ = " select distinct a.prod_cd, b.prod_gubun, a.mold_no, a.mold_desc, " & vbCrLf
    sql$ = sql$ & " nvl((select mold_stamp from prd_mold_1 where comp_cd = '" & GLO_COMP_CD & "' and bsns_cd = '" & GLO_BSNS_CD & "' and mold_no = nvl((select distinct c.mold_no from PRD_WORK_11 c where c.prod_cd = b.prod_cd  and c.outlot_no = '" & Replace(Trim(C_LOT_NO), "-", "") & "'), ' ')),' ') mold_stamp "
    sql$ = sql$ & " from PRD_MAST_1_VIEW a, PRD_WORK_11 b " & vbCrLf
    sql$ = sql$ & " where a.ipart_no = '" & varIPartNo & "' " & vbCr
    sql$ = sql$ & " and   b.outlot_no = '" & Replace(Trim(C_LOT_NO), "-", "") & "' " & vbCrLf
    sql$ = sql$ & " and   a.prod_cd = b.prod_cd "
    sql$ = sql$ & " and a.comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and a.bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
    sql$ = sql$ & " and a.comp_cd = b.comp_cd and a.bsns_cd = b.bsns_cd " & vbCrLf
    
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    If SSDATA.RecordCount = 0 Then
        varMoldStamp = ""
    Else
        varMoldStamp = Trim(SSDATA!mold_stamp)
    End If
    SSDATA.Close
    '===========================================================================
    ' Angle Á¤ÀÇ
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"

    ' Horizontal expansion rate Á¤ÀÇ
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

    ' Vertical expansion rate Á¤ÀÇ
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

    ' Font 9 ÀÏ¶§ Size Á¤ÀÇ
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

    ' Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:
    
    'ÃÊ±â Á¤ÀÇ°ª
    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
'=========================================================================================================
'    1       234     567     8901     2345     6
'Angle180 + "911" + "003" + "0065" + "0950" + "Description " + vbCr
'1              : Ãâ·Â°¢ Á¶Àý        1 = 0:  2 = 90:   3 = 180:    4 = 270
'2              : Font °áÁ¤          0 ~ 8 : System Font     9 : Smooth Font
'3              : FontÀÇ °¡·ÎºñÀ²    1 ~ 9, A ~ O  (1 ~ 24 ±îÁö ÀÇ¹Ì 1~9, 10~24)
'4              : FontÀÇ ¼¼·ÎºñÀ²    1 ~ 9, A ~ O  (1 ~ 24 ±îÁö ÀÇ¹Ì 1~9, 10~24)
'5, 6, 7        : Font°¡ Smooth ÀÏ¶§ °ª °áÁ¤(2¹øÂ° ÀÚ¸®°¡ 9ÀÏ¶§)  001(6 Pt) ~ 010(48 Pt)
'8, 9, 10, 11   : Row ÀÇ À§Ä¡ 0000~9999  ´ÜÀ§ : 0.01 inch/step
'12, 13, 14, 15 : Col ÀÇ À§Ä¡ 0000~0416  ´ÜÀ§ : 0.01 inch/step
'16             : ¹®ÀÚ ÀÔ·Â
       
' ¿ÜºÎ Box ±×¸®±â           -- reserved --   -Row-    -Col-   -box- -¼öÆò±æÀÌ+¼öÁ÷±æÀÌ- -- line Æø --
    'sFormatTx = sFormatTx + "1X11" + "000" + "0000" + "0030" + "b" + "0970" + "0570" + "0006" + "0006" + vbCr
    
    sFormatTx = sFormatTx + "1X11" + "000" + "0000" + "0035" + "l" + "0960" + "0006" + vbCr '¸Ç À­ÁÙ
    sFormatTx = sFormatTx + "1X11" + "000" + "0565" + "0035" + "l" + "0960" + "0006" + vbCr '¸Ç ¾Æ·§ÁÙ
' Barcode »ó´ÜÀÇ ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0090" + "0035" + "l" + "0960" + "0006" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0165" + "0035" + "l" + "0960" + "0006" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0005" + "0525" + "l" + "0006" + "0085" + vbCr '¼¼·Î
    
    Dim varRate     As String
    'varRate = IIf(opt_5to2, "52", "42")
    
    varRate = "52"
    '                      -Ãâ·Â°¢     --- Font ---    -Row-    -Col-
    sText1 = "From"
    sFormatTx = sFormatTx + Angle180 + "923" + "001" + "0080" + "0980" + sText1 + vbCr
    sText1 = IIf(GLO_COMP_CD = "FU", "PEAK", GLO_COMP_YNM)   '2018.05.09 jeenie & Liam º¯°æ ¿äÃ» °Ç
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0080" + "0860" + sText1 + vbCr
    
    sText1 = "To"
    sFormatTx = sFormatTx + Angle180 + "923" + "001" + "0080" + "0500" + sText1 + vbCr
    sText1 = varCustomName
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0080" + "0430" + sText1 + vbCr
    
    ' ¹®ÀÚ Ç¥½Ã
' Descriptiion
     sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0150" + "0980" + varPrdDesc + vbCr
    
    ' Barcode Ç¥½Ã         -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
' TSMC P/N #
    sText1 = varITEMNo
    sFormatTx = sFormatTx + Angle180 + "a" + varRate + "054" + "0235" + "0975"
    sFormatTx = sFormatTx + sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "002" + "0270" + "0980" + "TSMC P/N : " + sText1 + vbCr

    ' Barcode Ç¥½Ã         -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²]
    
    If GLO_COMP_CD = "FU" Then 'FRCUNIONÀº Add MOLD STAMP by jim
        'Mold No
        sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0235" + "0400" + "MOLD# : " + IIf(Trim(varMoldStamp) = "", "", Trim(varMoldStamp)) + vbCr
    End If
    
' DW Lot #
    sText1 = IIf(GLO_COMP_CD = "FU", varInvoiceNo, Trim(C_LOT_NO))
    sFormatTx = sFormatTx + Angle180 + "a" + varRate + "054" + "0330" + "0975"
    sFormatTx = sFormatTx + sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "002" + "0365" + "0980" + "LOT NO : " + sText1 + vbCr
    
    ' Barcode Ç¥½Ã         -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
' QTY
    sText1 = Trim(varUnitQty)
    sFormatTx = sFormatTx + Angle180 + "a" + varRate + "054" + "0425" + "0975"
    sFormatTx = sFormatTx + sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "002" + "0460" + "0980" + "QTY : " + sText1 + " PCS" + vbCr
    
    ' Barcode Ç¥½Ã         -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
' DOM (=Mfg Date)
    sText1 = Format(Trim(varMFGDT), "@@@@@@@@")
    sFormatTx = sFormatTx + Angle180 + "a" + varRate + "054" + "0520" + "0975"
    sFormatTx = sFormatTx + sText1 + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "002" + "0555" + "0980" + "DOM : " + sText1 + vbCr
    
    sFormatTx = sFormatTx + "E" + vbCr

End Sub

Private Sub T4_ASEKS_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2019. 11. 08
    ' DEVELOPER : FRC IT Jim Chen
    '======================================================================
    Dim sql                          As String
    Dim sText1                   As String
    Dim sText2                   As String
    Dim varLotNo            As String
    Dim varUnitQty           As String
    Dim varQApass           As String
    Dim subSpace             As String
    Dim varMFGDT           As String
    Dim varEXPDT             As String
    Dim yyyy                      As String
    Dim MM                      As String
    Dim dd                         As String
    
    Dim charRowAdd(5 To 48)     As Integer
        
    'RT
    varLotNo = C_LOT_NO
    
    'MFG DATE
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    varMFGDT = Replace(varMFGDT, "-", "/")
        
    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    varLotNo = Replace(C_LOT_NO, "-", "")
    
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:
    
    Dim varRate     As String
    varRate = "52"

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    'Barcode    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
                            
    'Batch NO (RT)
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0400" + "1000"
    sFormatTx = sFormatTx + "Batch NO:" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0400" + "0610"
    sFormatTx = sFormatTx + Trim(C_LOT_ID) + vbCr
        
    'CUST'R P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0500" + "1000"
    sFormatTx = sFormatTx + "Part NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0500" + "0610"
    sFormatTx = sFormatTx + C_ITEM_NO + vbCr

    'Verdenor LOT NO
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0600" + "1000"
    sFormatTx = sFormatTx + "Vendor Lot" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0600" + "0610"
    sFormatTx = sFormatTx & varLotNo & vbCr

    'QTY
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0700" + "1000"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0700" + "0610"
    sFormatTx = sFormatTx + varUnitQty + vbCr
    
    'DOM(YYYY/MM/dd) 'LOT (MFG Date)
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0800" + "1000"
    sFormatTx = sFormatTx + "Manufacture Date:" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0800" + "0610"
    sFormatTx = sFormatTx + varMFGDT + vbCr
    
    'C/T (Box No)
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0900" + "1000"
    sFormatTx = sFormatTx + "Box NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0900" + "0610"
    sFormatTx = sFormatTx & varCartonNo & vbCr
    
    '2D QR Code
    sFormatTx = sFormatTx & "3W1D660000300100002MA," & Trim(C_LOT_ID) & "|" & C_ITEM_NO & "|" & varLotNo & "|" & varUnitQty & "|" & varMFGDT & Chr$(13)
    
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub TR_ASECL_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)

    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim charRowAdd(5 To 48)     As Integer
    Dim varDWG_no               As String
    Dim varCUSTDWG_no        As String
    Dim varPrdITEM_no           As String
    Dim varMFGDT           As String
    
    varLotNo = C_LOT_NO
    
    'MFG DATE
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    varMFGDT = Replace(varMFGDT, "-", "/")

    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
    
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ, Drawing No È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no, nvl(a.cust_dwg_no,' ') as cust_dwg_no," & vbCrLf
    sql$ = sql$ & " (select distinct nvl(item_no, ' ') item_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO) as prd_item_no, " & vbCrLf
    sql$ = sql$ & " (select distinct nvl(dwg_no, ' ') dwg_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO) as dwg_no" & vbCrLf
    sql$ = sql$ & " from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    varDWG_no = ""
    varCUSTDWG_no = ""
    varPrdITEM_no = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
        varDWG_no = SSDATA!dwg_no
        varPrdITEM_no = SSDATA!prd_item_no
        varCUSTDWG_no = SSDATA!cust_dwg_no
    End If
    SSDATA.Close

    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If
    
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:


    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    'sFormatTx = sFormatTx + "1X11" + "000" + "0850" + "0030" + "l" + "0980" + "0007" + vbCr
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
   
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0850"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
    '-----------------------------------
    'Batch NO (RT)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "1000"
    sFormatTx = sFormatTx + "Batch NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0750"
    sFormatTx = sFormatTx & ": " & Trim(C_LOT_ID) + vbCr
        
    'CUST'R P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0240" + "1000"
    sFormatTx = sFormatTx + "Cust P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0240" + "0750"
    sFormatTx = sFormatTx & ": " & C_ITEM_NO + vbCr

    'Verdenor LOT NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0310" + "1000"
    sFormatTx = sFormatTx + "Vendor Lot" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0310" + "0750"
    sFormatTx = sFormatTx & ": " & Format(SHIP_DATE, "mmddyy") & vbCr       'varLotNo

    'QTY
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0380" + "1000"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "0750"
    sFormatTx = sFormatTx & ": " & varUnitQty + vbCr
    
    'DOM(YYYY/MM/dd) 'LOT (MFG Date)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0450" + "1000"
    sFormatTx = sFormatTx + "MFG Date" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0450" + "0750"
    sFormatTx = sFormatTx & ": " & varMFGDT + vbCr
    
    'C/T (Box No)
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0520" + "1000"
    sFormatTx = sFormatTx + "Box No" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0520" + "0750"
    sFormatTx = sFormatTx & ": " & varCartonNo & vbCr
    
    '2D QR Code
    '2D BARCODE(QR CODE)   'aW a=3Àº 180µµÈ¸Àü  ffff ³ôÀ»¼ö·Ï  ¾Æ·¡ gggg ³ôÀ»¼ö·Ï ¿ÞÂÊÀ¸·Î
    sFormatTx = sFormatTx & "3W1D440000370026002MA," & Trim(C_LOT_ID) & "|" & C_ITEM_NO & "|" & Format(SHIP_DATE, "mmddyy") & "|" & varUnitQty & "|" & varMFGDT & "|" & varCartonNo & Chr$(13)
    
    'Description
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0590" + "1000"
    sFormatTx = sFormatTx + "Description" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0590" + "0750"
    sFormatTx = sFormatTx + ": " + sText1 + vbCr
    
    'LOT No
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0660" + "1000"
    sFormatTx = sFormatTx + "LOT NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0660" + "0750"
    sFormatTx = sFormatTx + ": " + varLotNo + vbCr
    
    'PO No/Rev
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0730" + "1000"
    sFormatTx = sFormatTx + "PO No/Rev" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0730" + "0750"
    sFormatTx = sFormatTx + ": " + C_PO_NO + "/" + I_REV_NO + vbCr
    
    'PEAK P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0800" + "1000"
    sFormatTx = sFormatTx + "PEAK P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0800" + "0750"
    sFormatTx = sFormatTx + ": " + varOEMiPART_NO + vbCr
 
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

Private Sub T4_ASESH_BoxLabel_Print(varCartonNo As Integer, varTotalCartonNo As Integer)
    '======================================================================
    ' 2019. 11. 08
    ' DEVELOPER : FRC JIM CHEN
    '======================================================================
    Dim sql                     As String
    Dim sText1                  As String
    Dim sText2                  As String
    Dim varLotNo               As String
    Dim varUnitQty              As String
    Dim varQApass               As String
    Dim subSpace                As String
    Dim varOEMiPART_NO          As String
    Dim varOEMiRev_NO           As String
    Dim charRowAdd(5 To 48)     As Integer
    Dim varDWG_no               As String
    Dim varPrdITEM_no           As String
    Dim varMFGDT                            As String
    Dim varEXPDT                As String
    
    varLotNo = C_LOT_NO
        
    varMFGDT = Format(GF_CHECK_LotDate(Trim(D_PROD_KB), varLotNo), "@@@@-@@-@@") 'Lot »ý¼ºÀÏÀÚ¸¦ °¡Á®¿È
    varEXPDT = GF_GET_EXPDATE(GLO_COMP_CD, GLO_BSNS_CD, Trim(varMFGDT), Trim(Right(C_CUSTOM_CD, 5)), Trim(I_PART_NO), Trim(I_REV_NO), IIf(C_ITEM_NO = "", " ", C_ITEM_NO), Trim(Right(D_PROD_KB, 10)), , , Format(SHIP_DATE, "yyyy-mm-dd"))
    
    'varEXPDT = Replace(DateAdd("yyyy", 5, varMFGDT), "-", "")
    varMFGDT = Replace(varMFGDT, "-", "/")
    varEXPDT = Replace(varEXPDT, "-", "/")

    'Check last C/T Qty
    If varCartonNo = varTotalCartonNo Then
        varUnitQty = CStr(Val(I_TOTAL_QT) Mod Val(I_BOXUNIT_NB))
        If varUnitQty = "0" Then varUnitQty = I_BOXUNIT_NB
    Else
        varUnitQty = I_BOXUNIT_NB
    End If
        
    If Val(I_START_CT_NO) = Val(I_END_CT_NO) Then
        If Val(Result_QT) > 0 Then I_BOXUNIT_NB = Result_QT
    End If
    '===========================================================================
    ' SMP Á¤º¸ È®ÀÎ, Drawing No È®ÀÎ
    '===========================================================================
    sql$ = "select nvl(a.smp_part_no,' ') as smp_part_no, nvl(a.smp_rev_no,' ') as smp_rev_no, " & vbCrLf
    sql$ = sql$ & " (select distinct nvl(item_no, ' ') item_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO) as prd_item_no, " & vbCrLf
    sql$ = sql$ & " (select distinct nvl(dwg_no, ' ') dwg_no from PRD_MAST_1_VIEW f  where f.comp_cd = a.comp_cd and f.bsns_cd = a.bsns_cd and a.prev_no=f.prev_no and a.iPART_NO=f.iPART_NO) as dwg_no" & vbCrLf
    sql$ = sql$ & " from MKT_CUST_2 a" & vbCrLf
    sql$ = sql$ & " where a.custom_cd ='" & Trim(Right(C_CUSTOM_CD, 10)) & "'" & vbCrLf
    sql$ = sql$ & " and a.prev_no='" & I_REV_NO & "' and a.iPART_NO='" & I_PART_NO & "'"
    sql$ = sql$ & " and comp_cd = '" & GLO_COMP_CD & "' " & vbCrLf
    sql$ = sql$ & " and bsns_cd = '" & GLO_BSNS_CD & "' " & vbCrLf
        
    Set SSDATA = Nothing
    SSDATA.Open sql$, DB_User
    
    varOEMiPART_NO = ""
    varOEMiRev_NO = ""
    varDWG_no = ""
    varPrdITEM_no = ""
    If SSDATA.RecordCount > 0 Then
        varOEMiPART_NO = SSDATA!smp_part_no
        varOEMiRev_NO = SSDATA!smp_rev_no
        varDWG_no = SSDATA!dwg_no
        varPrdITEM_no = SSDATA!prd_item_no
    End If
    SSDATA.Close

    If InStr(I_DESC_NM, vbCrLf) > 0 Then
        sText1 = Trim(Left(I_DESC_NM, InStr(I_DESC_NM, vbCrLf) - 1))
        sText2 = Trim(Right(I_DESC_NM, Len(I_DESC_NM) - Len(sText1) - 2))
        
        If InStr(sText2, "BAKE") > 0 Then
            sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        Else
            sText2 = sText2 & " " & Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
        End If
    Else
        sText1 = I_DESC_NM
        sText2 = Mid(varMoldNo, InStr(varMoldNo, "-") + 1, 2) & varOEMiRev_NO
    End If
'============Angle
    Const Angle0 = "1", Angle90 = "2", Angle180 = "3", Angle270 = "4"
    
'============Horizontal expansion rate
    Const Hori1 = "1", Hori2 = "2", Hori3 = "3", Hori4 = "4"
    Const Hori5 = "5", Hori6 = "6", Hori7 = "7", Hori8 = "8"
    Const Hori9 = "9", Hori10 = "A", Hori11 = "B", Hori12 = "C"
    Const Hori13 = "D", Hori14 = "E", Hori15 = "F", Hori16 = "G"
    Const Hori17 = "H", Hori18 = "I", Hori19 = "J", Hori20 = "K"
    Const Hori21 = "L", Hori22 = "M", Hori23 = "N", Hori24 = "O"

'============Vertical expansion rate
    Const Verti1 = "1", Verti2 = "2", Verti3 = "3", Verti4 = "4"
    Const Verti5 = "5", Verti6 = "6", Verti7 = "7", Verti8 = "8"
    Const Verti9 = "9", Verti10 = "A", Verti11 = "B", Verti12 = "C"
    Const Verti13 = "D", Verti14 = "E", Verti15 = "F", Verti16 = "G"
    Const Verti17 = "H", Verti18 = "I", Verti19 = "J", Verti20 = "K"
    Const Verti21 = "L", Verti22 = "M", Verti23 = "N", Verti24 = "O"

'============Font 9 ÀÏ¶§ Size
    Const Font0 = "000"
    Const Font6 = "001", Font8 = "002", Font10 = "003", Font12 = "004"
    Const Font14 = "005", Font18 = "006", Font24 = "007", Font30 = "008", Font36 = "009", Font48 = "010"

    Const cFont6 = "101", cFont8 = "102", cFont10 = "103", cFont12 = "104"
    Const cFont14 = "105", cFont18 = "106", cFont24 = "107", cFont30 = "108", cFont36 = "109", cFont48 = "110"

'============Row Add
    charRowAdd(5) = 10:    charRowAdd(6) = 18:    charRowAdd(8) = 20:    charRowAdd(10) = 23
    charRowAdd(12) = 25:   charRowAdd(14) = 28:   charRowAdd(18) = 30:   charRowAdd(24) = 35
    charRowAdd(30) = 43:   charRowAdd(36) = 48:   charRowAdd(48) = 78:

    sFormatTx = Chr(2) + "m" + vbCr
    sFormatTx = sFormatTx + Chr(2) + "L" + vbCr
    sFormatTx = sFormatTx + "D11" + vbCr
    
    ' Barcode ÁÙ ±ß±â    -- reserved --   -Row-    -Col-   -line-  -±æÀÌ + µÎ²²-
    sFormatTx = sFormatTx + "1X11" + "000" + "0100" + "0030" + "l" + "0980" + "0007" + vbCr
    sFormatTx = sFormatTx + "1X11" + "000" + "0850" + "0030" + "l" + "0980" + "0007" + vbCr
    
    ' Barcode Ç¥½Ã              -Ãâ·Â°¢- -type-  --µÎ²²--   -³ôÀÌ-   -row-    -col-          * µÎ²² : ±½Àº µÎ²² + ¾ãÀº µÎ²²
   
   'Title
    sFormatTx = sFormatTx + Angle180 + "911" + "006" + "0080" + "0850"
    sFormatTx = sFormatTx + "PEAK SHIPPING LABEL" & vbCr
        
   'CUST'R
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0170" + "0980"
    sFormatTx = sFormatTx + "CUSTOMER" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0170" + "0730"
    sFormatTx = sFormatTx + ": " + Trim(Left(C_CUSTOM_CD, 30)) + vbCr
    
   'CUST'R PO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0240" + "0980"
    sFormatTx = sFormatTx + "CUST'R PO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0240" + "0730"
    sFormatTx = sFormatTx + ": " + C_PO_NO + vbCr

    'CUST'R P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0310" + "0980"
    sFormatTx = sFormatTx + "CUST'R P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0310" + "0730"
    sFormatTx = sFormatTx + ": " + C_ITEM_NO + vbCr
    
    'PEAK P/N
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0380" + "0980"
    sFormatTx = sFormatTx + "PEAK P/N" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0380" + "0730"
    sFormatTx = sFormatTx + ": " + varOEMiPART_NO + vbCr ' I_PART_NO + vbCr
    
    'PEAK DWG#
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0450" + "0980"
    sFormatTx = sFormatTx + "PEAK DWG#" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0450" + "0730"
    sFormatTx = sFormatTx + ": " + sText1 + vbCr

        'QTY
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0520" + "0980"
    sFormatTx = sFormatTx + "QTY" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0520" + "0730"
    sFormatTx = sFormatTx + ": " + varUnitQty + vbCr
        
        'MFG DATE
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0590" + "0980"
    sFormatTx = sFormatTx + "MFG" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0590" + "0730"
    sFormatTx = sFormatTx + ": " + varMFGDT + vbCr
        
        'SHIP'G LOT NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0660" + "0980"
    sFormatTx = sFormatTx + "LOT NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0660" + "0730"
    sFormatTx = sFormatTx + ": " + varLotNo + vbCr
        
        'EXP DATE
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0730" + "0980"
    sFormatTx = sFormatTx + "EXP DATE" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0730" + "0730"
    sFormatTx = sFormatTx + ": " + varEXPDT + vbCr
    
    'C/NO
    sFormatTx = sFormatTx + Angle180 + "911" + "003" + "0920" + "0980"
    sFormatTx = sFormatTx + "C/NO" + vbCr
    sFormatTx = sFormatTx + Angle180 + "911" + "004" + "0920" + "0730"
    sFormatTx = sFormatTx + ": " & varCartonNo & vbCr
    sFormatTx = sFormatTx + "E" + vbCr
End Sub

